const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["static/index.BHQ8Mwq8.js","static/main.Dqpd9PAW.js","static/main.DpYC4jGb.css"])))=>i.map(i=>d[i]);
import{ax as os,ay as vo,az as $o,aA as re,aB as Z0,aC as wf,aD as _f,aE as Vc,aF as No,aG as X0,aH as Mr,aI as Ii,aJ as ew,aK as tw,aL as G,aM as rw,aN as Ac,aO as iw,aP as nw,aQ as sw,aR as nl,aS as ow,aT as aw,aU as cw,aV as sl,aW as uw,aX as hw,aY as lw,aZ as ts,a_ as ol,a$ as fw,b0 as pw,b1 as bf,b2 as qr,b3 as dw,b4 as al,b5 as mn,b6 as Tt,b7 as Vt,b8 as Ei,b9 as cr,ba as gw,bb as wn,bc as Ef,bd as yw,be as vw,bf as mw,bg as If,bh as ww,bi as xf,bj as Pf,bk as bn,bl as Tc,bm as xo,bn as In,bo as _w,bp as Po,bq as bw,br as Ew,bs as Iw,bt as xw,bu as mo,bv as Pw,bw as Sw,bx as pc,by as cl,bz as Ow,bA as Rw,bB as Aw,bC as ul,bD as Tw,bE as Cw,bF as $w,bG as Nw,bH as Dw,bI as Lw,bJ as jw,bK as Yn,bL as Sf,bM as dc,bN as qw,bO as Mw,bP as zw}from"./main.Dqpd9PAW.js";var Gc={exports:{}},En=typeof Reflect=="object"?Reflect:null,hl=En&&typeof En.apply=="function"?En.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},So;En&&typeof En.ownKeys=="function"?So=En.ownKeys:Object.getOwnPropertySymbols?So=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:So=function(t){return Object.getOwnPropertyNames(t)};function Uw(o){console&&console.warn&&console.warn(o)}var Of=Number.isNaN||function(t){return t!==t};function qe(){qe.init.call(this)}Gc.exports=qe;Gc.exports.once=Bw;qe.EventEmitter=qe;qe.prototype._events=void 0;qe.prototype._eventsCount=0;qe.prototype._maxListeners=void 0;var ll=10;function Do(o){if(typeof o!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof o)}Object.defineProperty(qe,"defaultMaxListeners",{enumerable:!0,get:function(){return ll},set:function(o){if(typeof o!="number"||o<0||Of(o))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+o+".");ll=o}});qe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};qe.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Of(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Rf(o){return o._maxListeners===void 0?qe.defaultMaxListeners:o._maxListeners}qe.prototype.getMaxListeners=function(){return Rf(this)};qe.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var s=t==="error",c=this._events;if(c!==void 0)s=s&&c.error===void 0;else if(!s)return!1;if(s){var l;if(r.length>0&&(l=r[0]),l instanceof Error)throw l;var g=new Error("Unhandled error."+(l?" ("+l.message+")":""));throw g.context=l,g}var v=c[t];if(v===void 0)return!1;if(typeof v=="function")hl(v,this,r);else for(var p=v.length,w=Nf(v,p),n=0;n<p;++n)hl(w[n],this,r);return!0};function Af(o,t,r,n){var s,c,l;if(Do(r),c=o._events,c===void 0?(c=o._events=Object.create(null),o._eventsCount=0):(c.newListener!==void 0&&(o.emit("newListener",t,r.listener?r.listener:r),c=o._events),l=c[t]),l===void 0)l=c[t]=r,++o._eventsCount;else if(typeof l=="function"?l=c[t]=n?[r,l]:[l,r]:n?l.unshift(r):l.push(r),s=Rf(o),s>0&&l.length>s&&!l.warned){l.warned=!0;var g=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");g.name="MaxListenersExceededWarning",g.emitter=o,g.type=t,g.count=l.length,Uw(g)}return o}qe.prototype.addListener=function(t,r){return Af(this,t,r,!1)};qe.prototype.on=qe.prototype.addListener;qe.prototype.prependListener=function(t,r){return Af(this,t,r,!0)};function Hw(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Tf(o,t,r){var n={fired:!1,wrapFn:void 0,target:o,type:t,listener:r},s=Hw.bind(n);return s.listener=r,n.wrapFn=s,s}qe.prototype.once=function(t,r){return Do(r),this.on(t,Tf(this,t,r)),this};qe.prototype.prependOnceListener=function(t,r){return Do(r),this.prependListener(t,Tf(this,t,r)),this};qe.prototype.removeListener=function(t,r){var n,s,c,l,g;if(Do(r),s=this._events,s===void 0)return this;if(n=s[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete s[t],s.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(c=-1,l=n.length-1;l>=0;l--)if(n[l]===r||n[l].listener===r){g=n[l].listener,c=l;break}if(c<0)return this;c===0?n.shift():kw(n,c),n.length===1&&(s[t]=n[0]),s.removeListener!==void 0&&this.emit("removeListener",t,g||r)}return this};qe.prototype.off=qe.prototype.removeListener;qe.prototype.removeAllListeners=function(t){var r,n,s;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var c=Object.keys(n),l;for(s=0;s<c.length;++s)l=c[s],l!=="removeListener"&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(s=r.length-1;s>=0;s--)this.removeListener(t,r[s]);return this};function Cf(o,t,r){var n=o._events;if(n===void 0)return[];var s=n[t];return s===void 0?[]:typeof s=="function"?r?[s.listener||s]:[s]:r?Kw(s):Nf(s,s.length)}qe.prototype.listeners=function(t){return Cf(this,t,!0)};qe.prototype.rawListeners=function(t){return Cf(this,t,!1)};qe.listenerCount=function(o,t){return typeof o.listenerCount=="function"?o.listenerCount(t):$f.call(o,t)};qe.prototype.listenerCount=$f;function $f(o){var t=this._events;if(t!==void 0){var r=t[o];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}qe.prototype.eventNames=function(){return this._eventsCount>0?So(this._events):[]};function Nf(o,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=o[n];return r}function kw(o,t){for(;t+1<o.length;t++)o[t]=o[t+1];o.pop()}function Kw(o){for(var t=new Array(o.length),r=0;r<t.length;++r)t[r]=o[r].listener||o[r];return t}function Bw(o,t){return new Promise(function(r,n){function s(l){o.removeListener(t,c),n(l)}function c(){typeof o.removeListener=="function"&&o.removeListener("error",s),r([].slice.call(arguments))}Df(o,t,c,{once:!0}),t!=="error"&&Fw(o,s,{once:!0})})}function Fw(o,t,r){typeof o.on=="function"&&Df(o,"error",t,r)}function Df(o,t,r,n){if(typeof o.on=="function")n.once?o.once(t,r):o.on(t,r);else if(typeof o.addEventListener=="function")o.addEventListener(t,function s(c){n.once&&o.removeEventListener(t,s),r(c)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof o)}var ur=Gc.exports;const Wc=os(ur);function Vw(o){return!o||typeof o.then!="function"?Promise.resolve(o):o}function qt(o,...t){try{return Vw(o(...t))}catch(r){return Promise.reject(r)}}function Gw(o){const t=typeof o;return o===null||t!=="object"&&t!=="function"}function Ww(o){const t=Object.getPrototypeOf(o);return!t||t.isPrototypeOf(Object)}function Oo(o){if(Gw(o))return String(o);if(Ww(o)||Array.isArray(o))return JSON.stringify(o);if(typeof o.toJSON=="function")return Oo(o.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Lf(){if(typeof Buffer>"u")throw new TypeError("[unstorage] Buffer is not supported!")}const Cc="base64:";function Jw(o){if(typeof o=="string")return o;Lf();const t=Buffer.from(o).toString("base64");return Cc+t}function Qw(o){return typeof o!="string"||!o.startsWith(Cc)?o:(Lf(),Buffer.from(o.slice(Cc.length),"base64"))}function ar(o){return o?o.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Yw(...o){return ar(o.join(":"))}function wo(o){return o=ar(o),o?o+":":""}const Zw="memory",Xw=()=>{const o=new Map;return{name:Zw,getInstance:()=>o,hasItem(t){return o.has(t)},getItem(t){return o.get(t)??null},getItemRaw(t){return o.get(t)??null},setItem(t,r){o.set(t,r)},setItemRaw(t,r){o.set(t,r)},removeItem(t){o.delete(t)},getKeys(){return[...o.keys()]},clear(){o.clear()},dispose(){o.clear()}}};function e_(o={}){const t={mounts:{"":o.driver||Xw()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=p=>{for(const w of t.mountpoints)if(p.startsWith(w))return{base:w,relativeKey:p.slice(w.length),driver:t.mounts[w]};return{base:"",relativeKey:p,driver:t.mounts[""]}},n=(p,w)=>t.mountpoints.filter(x=>x.startsWith(p)||w&&p.startsWith(x)).map(x=>({relativeBase:p.length>x.length?p.slice(x.length):void 0,mountpoint:x,driver:t.mounts[x]})),s=(p,w)=>{if(t.watching){w=ar(w);for(const x of t.watchListeners)x(p,w)}},c=async()=>{if(!t.watching){t.watching=!0;for(const p in t.mounts)t.unwatch[p]=await fl(t.mounts[p],s,p)}},l=async()=>{if(t.watching){for(const p in t.unwatch)await t.unwatch[p]();t.unwatch={},t.watching=!1}},g=(p,w,x)=>{const T=new Map,D=A=>{let J=T.get(A.base);return J||(J={driver:A.driver,base:A.base,items:[]},T.set(A.base,J)),J};for(const A of p){const J=typeof A=="string",ee=ar(J?A:A.key),ce=J?void 0:A.value,ae=J||!A.options?w:{...w,...A.options},oe=r(ee);D(oe).items.push({key:ee,value:ce,relativeKey:oe.relativeKey,options:ae})}return Promise.all([...T.values()].map(A=>x(A))).then(A=>A.flat())},v={hasItem(p,w={}){p=ar(p);const{relativeKey:x,driver:T}=r(p);return qt(T.hasItem,x,w)},getItem(p,w={}){p=ar(p);const{relativeKey:x,driver:T}=r(p);return qt(T.getItem,x,w).then(D=>vo(D))},getItems(p,w){return g(p,w,x=>x.driver.getItems?qt(x.driver.getItems,x.items.map(T=>({key:T.relativeKey,options:T.options})),w).then(T=>T.map(D=>({key:Yw(x.base,D.key),value:vo(D.value)}))):Promise.all(x.items.map(T=>qt(x.driver.getItem,T.relativeKey,T.options).then(D=>({key:T.key,value:vo(D)})))))},getItemRaw(p,w={}){p=ar(p);const{relativeKey:x,driver:T}=r(p);return T.getItemRaw?qt(T.getItemRaw,x,w):qt(T.getItem,x,w).then(D=>Qw(D))},async setItem(p,w,x={}){if(w===void 0)return v.removeItem(p);p=ar(p);const{relativeKey:T,driver:D}=r(p);D.setItem&&(await qt(D.setItem,T,Oo(w),x),D.watch||s("update",p))},async setItems(p,w){await g(p,w,async x=>{if(x.driver.setItems)return qt(x.driver.setItems,x.items.map(T=>({key:T.relativeKey,value:Oo(T.value),options:T.options})),w);x.driver.setItem&&await Promise.all(x.items.map(T=>qt(x.driver.setItem,T.relativeKey,Oo(T.value),T.options)))})},async setItemRaw(p,w,x={}){if(w===void 0)return v.removeItem(p,x);p=ar(p);const{relativeKey:T,driver:D}=r(p);if(D.setItemRaw)await qt(D.setItemRaw,T,w,x);else if(D.setItem)await qt(D.setItem,T,Jw(w),x);else return;D.watch||s("update",p)},async removeItem(p,w={}){typeof w=="boolean"&&(w={removeMeta:w}),p=ar(p);const{relativeKey:x,driver:T}=r(p);T.removeItem&&(await qt(T.removeItem,x,w),(w.removeMeta||w.removeMata)&&await qt(T.removeItem,x+"$",w),T.watch||s("remove",p))},async getMeta(p,w={}){typeof w=="boolean"&&(w={nativeOnly:w}),p=ar(p);const{relativeKey:x,driver:T}=r(p),D=Object.create(null);if(T.getMeta&&Object.assign(D,await qt(T.getMeta,x,w)),!w.nativeOnly){const A=await qt(T.getItem,x+"$",w).then(J=>vo(J));A&&typeof A=="object"&&(typeof A.atime=="string"&&(A.atime=new Date(A.atime)),typeof A.mtime=="string"&&(A.mtime=new Date(A.mtime)),Object.assign(D,A))}return D},setMeta(p,w,x={}){return this.setItem(p+"$",w,x)},removeMeta(p,w={}){return this.removeItem(p+"$",w)},async getKeys(p,w={}){p=wo(p);const x=n(p,!0);let T=[];const D=[];for(const A of x){const J=await qt(A.driver.getKeys,A.relativeBase,w);for(const ee of J){const ce=A.mountpoint+ar(ee);T.some(ae=>ce.startsWith(ae))||D.push(ce)}T=[A.mountpoint,...T.filter(ee=>!ee.startsWith(A.mountpoint))]}return p?D.filter(A=>A.startsWith(p)&&A[A.length-1]!=="$"):D.filter(A=>A[A.length-1]!=="$")},async clear(p,w={}){p=wo(p),await Promise.all(n(p,!1).map(async x=>{if(x.driver.clear)return qt(x.driver.clear,x.relativeBase,w);if(x.driver.removeItem){const T=await x.driver.getKeys(x.relativeBase||"",w);return Promise.all(T.map(D=>x.driver.removeItem(D,w)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(p=>pl(p)))},async watch(p){return await c(),t.watchListeners.push(p),async()=>{t.watchListeners=t.watchListeners.filter(w=>w!==p),t.watchListeners.length===0&&await l()}},async unwatch(){t.watchListeners=[],await l()},mount(p,w){if(p=wo(p),p&&t.mounts[p])throw new Error(`already mounted at ${p}`);return p&&(t.mountpoints.push(p),t.mountpoints.sort((x,T)=>T.length-x.length)),t.mounts[p]=w,t.watching&&Promise.resolve(fl(w,s,p)).then(x=>{t.unwatch[p]=x}).catch(console.error),v},async unmount(p,w=!0){p=wo(p),!(!p||!t.mounts[p])&&(t.watching&&p in t.unwatch&&(t.unwatch[p](),delete t.unwatch[p]),w&&await pl(t.mounts[p]),t.mountpoints=t.mountpoints.filter(x=>x!==p),delete t.mounts[p])},getMount(p=""){p=ar(p)+":";const w=r(p);return{driver:w.driver,base:w.base}},getMounts(p="",w={}){return p=ar(p),n(p,w.parents).map(T=>({driver:T.driver,base:T.mountpoint}))},keys:(p,w={})=>v.getKeys(p,w),get:(p,w={})=>v.getItem(p,w),set:(p,w,x={})=>v.setItem(p,w,x),has:(p,w={})=>v.hasItem(p,w),del:(p,w={})=>v.removeItem(p,w),remove:(p,w={})=>v.removeItem(p,w)};return v}function fl(o,t,r){return o.watch?o.watch((n,s)=>t(n,r+s)):()=>{}}async function pl(o){typeof o.dispose=="function"&&await qt(o.dispose)}function Vi(o){return new Promise((t,r)=>{o.oncomplete=o.onsuccess=()=>t(o.result),o.onabort=o.onerror=()=>r(o.error)})}function jf(o,t){const r=indexedDB.open(o);r.onupgradeneeded=()=>r.result.createObjectStore(t);const n=Vi(r);return(s,c)=>n.then(l=>c(l.transaction(t,s).objectStore(t)))}let gc;function as(){return gc||(gc=jf("keyval-store","keyval")),gc}function dl(o,t=as()){return t("readonly",r=>Vi(r.get(o)))}function t_(o,t,r=as()){return r("readwrite",n=>(n.put(t,o),Vi(n.transaction)))}function r_(o,t=as()){return t("readwrite",r=>(r.delete(o),Vi(r.transaction)))}function i_(o=as()){return o("readwrite",t=>(t.clear(),Vi(t.transaction)))}function n_(o,t){return o.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Vi(o.transaction)}function s_(o=as()){return o("readonly",t=>{if(t.getAllKeys)return Vi(t.getAllKeys());const r=[];return n_(t,n=>r.push(n.key)).then(()=>r)})}const o_=o=>JSON.stringify(o,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),a_=o=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=o.replace(t,'$1"$2n"$3');return JSON.parse(r,(n,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function cs(o){if(typeof o!="string")throw new Error(`Cannot safe json parse value of type ${typeof o}`);try{return a_(o)}catch{return o}}function Fi(o){return typeof o=="string"?o:o_(o)||""}const c_="idb-keyval";var u_=(o={})=>{const t=o.base&&o.base.length>0?`${o.base}:`:"",r=s=>t+s;let n;return o.dbName&&o.storeName&&(n=jf(o.dbName,o.storeName)),{name:c_,options:o,async hasItem(s){return!(typeof await dl(r(s),n)>"u")},async getItem(s){return await dl(r(s),n)??null},setItem(s,c){return t_(r(s),c,n)},removeItem(s){return r_(r(s),n)},getKeys(){return s_(n)},clear(){return i_(n)}}};const h_="WALLET_CONNECT_V2_INDEXED_DB",l_="keyvaluestorage";let f_=class{constructor(){this.indexedDb=e_({driver:u_({dbName:h_,storeName:l_})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const r=await this.indexedDb.getItem(t);if(r!==null)return r}async setItem(t,r){await this.indexedDb.setItem(t,Fi(r))}async removeItem(t){await this.indexedDb.removeItem(t)}};var yc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ro={exports:{}};(function(){let o;function t(){}o=t,o.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},o.prototype.setItem=function(r,n){this[r]=String(n)},o.prototype.removeItem=function(r){delete this[r]},o.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},o.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},o.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof yc<"u"&&yc.localStorage?Ro.exports=yc.localStorage:typeof window<"u"&&window.localStorage?Ro.exports=window.localStorage:Ro.exports=new t})();function p_(o){var t;return[o[0],cs((t=o[1])!=null?t:"")]}class d_{constructor(){this.localStorage=Ro.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(p_)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return cs(r)}async setItem(t,r){this.localStorage.setItem(t,Fi(r))}async removeItem(t){this.localStorage.removeItem(t)}}const g_="wc_storage_version",gl=1,y_=async(o,t,r)=>{const n=g_,s=await t.getItem(n);if(s&&s>=gl){r(t);return}const c=await o.getKeys();if(!c.length){r(t);return}const l=[];for(;c.length;){const g=c.shift();if(!g)continue;const v=g.toLowerCase();if(v.includes("wc@")||v.includes("walletconnect")||v.includes("wc_")||v.includes("wallet_connect")){const p=await o.getItem(g);await t.setItem(g,p),l.push(g)}}await t.setItem(n,gl),r(t),v_(o,l)},v_=async(o,t)=>{t.length&&t.forEach(async r=>{await o.removeItem(r)})};let m_=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const t=new d_;this.storage=t;try{const r=new f_;y_(t,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,r){return await this.initialize(),this.storage.setItem(t,r)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)})}};var xn={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var $c=function(o,t){return $c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])},$c(o,t)};function w_(o,t){$c(o,t);function r(){this.constructor=o}o.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Nc=function(){return Nc=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},Nc.apply(this,arguments)};function __(o,t){var r={};for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&t.indexOf(n)<0&&(r[n]=o[n]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(o);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(o,n[s])&&(r[n[s]]=o[n[s]]);return r}function b_(o,t,r,n){var s=arguments.length,c=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,t,r,n);else for(var g=o.length-1;g>=0;g--)(l=o[g])&&(c=(s<3?l(c):s>3?l(t,r,c):l(t,r))||c);return s>3&&c&&Object.defineProperty(t,r,c),c}function E_(o,t){return function(r,n){t(r,n,o)}}function I_(o,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,t)}function x_(o,t,r,n){function s(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function g(w){try{p(n.next(w))}catch(x){l(x)}}function v(w){try{p(n.throw(w))}catch(x){l(x)}}function p(w){w.done?c(w.value):s(w.value).then(g,v)}p((n=n.apply(o,t||[])).next())})}function P_(o,t){var r={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function g(p){return function(w){return v([p,w])}}function v(p){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(c=p[0]&2?s.return:p[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,p[1])).done)return c;switch(s=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return r.label++,{value:p[1],done:!1};case 5:r.label++,s=p[1],p=[0];continue;case 7:p=r.ops.pop(),r.trys.pop();continue;default:if(c=r.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){r=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){r.label=p[1];break}if(p[0]===6&&r.label<c[1]){r.label=c[1],c=p;break}if(c&&r.label<c[2]){r.label=c[2],r.ops.push(p);break}c[2]&&r.ops.pop(),r.trys.pop();continue}p=t.call(o,r)}catch(w){p=[6,w],s=0}finally{n=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function S_(o,t,r,n){n===void 0&&(n=r),o[n]=t[r]}function O_(o,t){for(var r in o)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=o[r])}function Dc(o){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&o[t],n=0;if(r)return r.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&n>=o.length&&(o=void 0),{value:o&&o[n++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function qf(o,t){var r=typeof Symbol=="function"&&o[Symbol.iterator];if(!r)return o;var n=r.call(o),s,c=[],l;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(g){l={error:g}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(l)throw l.error}}return c}function R_(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(qf(arguments[t]));return o}function A_(){for(var o=0,t=0,r=arguments.length;t<r;t++)o+=arguments[t].length;for(var n=Array(o),s=0,t=0;t<r;t++)for(var c=arguments[t],l=0,g=c.length;l<g;l++,s++)n[s]=c[l];return n}function rs(o){return this instanceof rs?(this.v=o,this):new rs(o)}function T_(o,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(o,t||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(T){n[T]&&(s[T]=function(D){return new Promise(function(A,J){c.push([T,D,A,J])>1||g(T,D)})})}function g(T,D){try{v(n[T](D))}catch(A){x(c[0][3],A)}}function v(T){T.value instanceof rs?Promise.resolve(T.value.v).then(p,w):x(c[0][2],T)}function p(T){g("next",T)}function w(T){g("throw",T)}function x(T,D){T(D),c.shift(),c.length&&g(c[0][0],c[0][1])}}function C_(o){var t,r;return t={},n("next"),n("throw",function(s){throw s}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(s,c){t[s]=o[s]?function(l){return(r=!r)?{value:rs(o[s](l)),done:s==="return"}:c?c(l):l}:c}}function $_(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=o[Symbol.asyncIterator],r;return t?t.call(o):(o=typeof Dc=="function"?Dc(o):o[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(c){r[c]=o[c]&&function(l){return new Promise(function(g,v){l=o[c](l),s(g,v,l.done,l.value)})}}function s(c,l,g,v){Promise.resolve(v).then(function(p){c({value:p,done:g})},l)}}function N_(o,t){return Object.defineProperty?Object.defineProperty(o,"raw",{value:t}):o.raw=t,o}function D_(o){if(o&&o.__esModule)return o;var t={};if(o!=null)for(var r in o)Object.hasOwnProperty.call(o,r)&&(t[r]=o[r]);return t.default=o,t}function L_(o){return o&&o.__esModule?o:{default:o}}function j_(o,t){if(!t.has(o))throw new TypeError("attempted to get private field on non-instance");return t.get(o)}function q_(o,t,r){if(!t.has(o))throw new TypeError("attempted to set private field on non-instance");return t.set(o,r),r}const M_=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Nc},__asyncDelegator:C_,__asyncGenerator:T_,__asyncValues:$_,__await:rs,__awaiter:x_,__classPrivateFieldGet:j_,__classPrivateFieldSet:q_,__createBinding:S_,__decorate:b_,__exportStar:O_,__extends:w_,__generator:P_,__importDefault:L_,__importStar:D_,__makeTemplateObject:N_,__metadata:I_,__param:E_,__read:qf,__rest:__,__spread:R_,__spreadArrays:A_,__values:Dc},Symbol.toStringTag,{value:"Module"})),Lo=$o(M_);var Bn={},vc={},Fn={};class Gi{}const z_=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Gi},Symbol.toStringTag,{value:"Module"})),U_=$o(z_);var yl;function H_(){if(yl)return Fn;yl=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.IHeartBeat=void 0;const o=U_;class t extends o.IEvents{constructor(n){super()}}return Fn.IHeartBeat=t,Fn}var vl;function Mf(){return vl||(vl=1,function(o){Object.defineProperty(o,"__esModule",{value:!0}),Lo.__exportStar(H_(),o)}(vc)),vc}var mc={},Ki={},ml;function k_(){if(ml)return Ki;ml=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.HEARTBEAT_EVENTS=Ki.HEARTBEAT_INTERVAL=void 0;const o=re;return Ki.HEARTBEAT_INTERVAL=o.FIVE_SECONDS,Ki.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Ki}var wl;function zf(){return wl||(wl=1,function(o){Object.defineProperty(o,"__esModule",{value:!0}),Lo.__exportStar(k_(),o)}(mc)),mc}var _l;function K_(){if(_l)return Bn;_l=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.HeartBeat=void 0;const o=Lo,t=ur,r=re,n=Mf(),s=zf();class c extends n.IHeartBeat{constructor(g){super(g),this.events=new t.EventEmitter,this.interval=s.HEARTBEAT_INTERVAL,this.interval=(g==null?void 0:g.interval)||s.HEARTBEAT_INTERVAL}static init(g){return o.__awaiter(this,void 0,void 0,function*(){const v=new c(g);return yield v.init(),v})}init(){return o.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(g,v){this.events.on(g,v)}once(g,v){this.events.once(g,v)}off(g,v){this.events.off(g,v)}removeListener(g,v){this.events.removeListener(g,v)}initialize(){return o.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(s.HEARTBEAT_EVENTS.pulse)}}return Bn.HeartBeat=c,Bn}(function(o){Object.defineProperty(o,"__esModule",{value:!0});const t=Lo;t.__exportStar(K_(),o),t.__exportStar(Mf(),o),t.__exportStar(zf(),o)})(xn);function B_(o){try{return JSON.stringify(o)}catch{return'"[Circular]"'}}var F_=V_;function V_(o,t,r){var n=r&&r.stringify||B_,s=1;if(typeof o=="object"&&o!==null){var c=t.length+s;if(c===1)return o;var l=new Array(c);l[0]=n(o);for(var g=1;g<c;g++)l[g]=n(t[g]);return l.join(" ")}if(typeof o!="string")return o;var v=t.length;if(v===0)return o;for(var p="",w=1-s,x=-1,T=o&&o.length||0,D=0;D<T;){if(o.charCodeAt(D)===37&&D+1<T){switch(x=x>-1?x:0,o.charCodeAt(D+1)){case 100:case 102:if(w>=v||t[w]==null)break;x<D&&(p+=o.slice(x,D)),p+=Number(t[w]),x=D+2,D++;break;case 105:if(w>=v||t[w]==null)break;x<D&&(p+=o.slice(x,D)),p+=Math.floor(Number(t[w])),x=D+2,D++;break;case 79:case 111:case 106:if(w>=v||t[w]===void 0)break;x<D&&(p+=o.slice(x,D));var A=typeof t[w];if(A==="string"){p+="'"+t[w]+"'",x=D+2,D++;break}if(A==="function"){p+=t[w].name||"<anonymous>",x=D+2,D++;break}p+=n(t[w]),x=D+2,D++;break;case 115:if(w>=v)break;x<D&&(p+=o.slice(x,D)),p+=String(t[w]),x=D+2,D++;break;case 37:x<D&&(p+=o.slice(x,D)),p+="%",x=D+2,D++,w--;break}++w}++D}return x===-1?o:(x<T&&(p+=o.slice(x)),p)}const bl=F_;var G_=Vr;const is=ib().console||{},W_={mapHttpRequest:_o,mapHttpResponse:_o,wrapRequestSerializer:wc,wrapResponseSerializer:wc,wrapErrorSerializer:wc,req:_o,res:_o,err:X_};function J_(o,t){return Array.isArray(o)?o.filter(function(n){return n!=="!stdSerializers.err"}):o===!0?Object.keys(t):!1}function Vr(o){o=o||{},o.browser=o.browser||{};const t=o.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const r=o.browser.write||is;o.browser.write&&(o.browser.asObject=!0);const n=o.serializers||{},s=J_(o.browser.serialize,n);let c=o.browser.serialize;Array.isArray(o.browser.serialize)&&o.browser.serialize.indexOf("!stdSerializers.err")>-1&&(c=!1);const l=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),o.enabled===!1&&(o.level="silent");const g=o.level||"info",v=Object.create(r);v.log||(v.log=ns),Object.defineProperty(v,"levelVal",{get:w}),Object.defineProperty(v,"level",{get:x,set:T});const p={transmit:t,serialize:s,asObject:o.browser.asObject,levels:l,timestamp:eb(o)};v.levels=Vr.levels,v.level=g,v.setMaxListeners=v.getMaxListeners=v.emit=v.addListener=v.on=v.prependListener=v.once=v.prependOnceListener=v.removeListener=v.removeAllListeners=v.listeners=v.listenerCount=v.eventNames=v.write=v.flush=ns,v.serializers=n,v._serialize=s,v._stdErrSerialize=c,v.child=D,t&&(v._logEvent=Lc());function w(){return this.level==="silent"?1/0:this.levels.values[this.level]}function x(){return this._level}function T(A){if(A!=="silent"&&!this.levels.values[A])throw Error("unknown level "+A);this._level=A,yn(p,v,"error","log"),yn(p,v,"fatal","error"),yn(p,v,"warn","error"),yn(p,v,"info","log"),yn(p,v,"debug","log"),yn(p,v,"trace","log")}function D(A,J){if(!A)throw new Error("missing bindings for child Pino");J=J||{},s&&A.serializers&&(J.serializers=A.serializers);const ee=J.serializers;if(s&&ee){var ce=Object.assign({},n,ee),ae=o.browser.serialize===!0?Object.keys(ce):s;delete A.serializers,jo([A],ae,ce,this._stdErrSerialize)}function oe(te){this._childLevel=(te._childLevel|0)+1,this.error=vn(te,A,"error"),this.fatal=vn(te,A,"fatal"),this.warn=vn(te,A,"warn"),this.info=vn(te,A,"info"),this.debug=vn(te,A,"debug"),this.trace=vn(te,A,"trace"),ce&&(this.serializers=ce,this._serialize=ae),t&&(this._logEvent=Lc([].concat(te._logEvent.bindings,A)))}return oe.prototype=this,new oe(this)}return v}Vr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Vr.stdSerializers=W_;Vr.stdTimeFunctions=Object.assign({},{nullTime:Uf,epochTime:Hf,unixTime:tb,isoTime:rb});function yn(o,t,r,n){const s=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?ns:s[r]?s[r]:is[r]||is[n]||ns,Q_(o,t,r)}function Q_(o,t,r){!o.transmit&&t[r]===ns||(t[r]=function(n){return function(){const c=o.timestamp(),l=new Array(arguments.length),g=Object.getPrototypeOf&&Object.getPrototypeOf(this)===is?is:this;for(var v=0;v<l.length;v++)l[v]=arguments[v];if(o.serialize&&!o.asObject&&jo(l,this._serialize,this.serializers,this._stdErrSerialize),o.asObject?n.call(g,Y_(this,r,l,c)):n.apply(g,l),o.transmit){const p=o.transmit.level||t.level,w=Vr.levels.values[p],x=Vr.levels.values[r];if(x<w)return;Z_(this,{ts:c,methodLevel:r,methodValue:x,transmitLevel:p,transmitValue:Vr.levels.values[o.transmit.level||t.level],send:o.transmit.send,val:t.levelVal},l)}}}(t[r]))}function Y_(o,t,r,n){o._serialize&&jo(r,o._serialize,o.serializers,o._stdErrSerialize);const s=r.slice();let c=s[0];const l={};n&&(l.time=n),l.level=Vr.levels.values[t];let g=(o._childLevel|0)+1;if(g<1&&(g=1),c!==null&&typeof c=="object"){for(;g--&&typeof s[0]=="object";)Object.assign(l,s.shift());c=s.length?bl(s.shift(),s):void 0}else typeof c=="string"&&(c=bl(s.shift(),s));return c!==void 0&&(l.msg=c),l}function jo(o,t,r,n){for(const s in o)if(n&&o[s]instanceof Error)o[s]=Vr.stdSerializers.err(o[s]);else if(typeof o[s]=="object"&&!Array.isArray(o[s]))for(const c in o[s])t&&t.indexOf(c)>-1&&c in r&&(o[s][c]=r[c](o[s][c]))}function vn(o,t,r){return function(){const n=new Array(1+arguments.length);n[0]=t;for(var s=1;s<n.length;s++)n[s]=arguments[s-1];return o[r].apply(this,n)}}function Z_(o,t,r){const n=t.send,s=t.ts,c=t.methodLevel,l=t.methodValue,g=t.val,v=o._logEvent.bindings;jo(r,o._serialize||Object.keys(o.serializers),o.serializers,o._stdErrSerialize===void 0?!0:o._stdErrSerialize),o._logEvent.ts=s,o._logEvent.messages=r.filter(function(p){return v.indexOf(p)===-1}),o._logEvent.level.label=c,o._logEvent.level.value=l,n(c,o._logEvent,g),o._logEvent=Lc(v)}function Lc(o){return{ts:0,messages:[],bindings:o||[],level:{label:"",value:0}}}function X_(o){const t={type:o.constructor.name,msg:o.message,stack:o.stack};for(const r in o)t[r]===void 0&&(t[r]=o[r]);return t}function eb(o){return typeof o.timestamp=="function"?o.timestamp:o.timestamp===!1?Uf:Hf}function _o(){return{}}function wc(o){return o}function ns(){}function Uf(){return!1}function Hf(){return Date.now()}function tb(){return Math.round(Date.now()/1e3)}function rb(){return new Date(Date.now()).toISOString()}function ib(){function o(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return o(self)||o(window)||o(this)||{}}}const qo=os(G_),nb={level:"info"},us="custom_context";var sb=Object.defineProperty,ob=Object.defineProperties,ab=Object.getOwnPropertyDescriptors,El=Object.getOwnPropertySymbols,cb=Object.prototype.hasOwnProperty,ub=Object.prototype.propertyIsEnumerable,Il=(o,t,r)=>t in o?sb(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,hb=(o,t)=>{for(var r in t||(t={}))cb.call(t,r)&&Il(o,r,t[r]);if(El)for(var r of El(t))ub.call(t,r)&&Il(o,r,t[r]);return o},lb=(o,t)=>ob(o,ab(t));function Mo(o){return lb(hb({},o),{level:(o==null?void 0:o.level)||nb.level})}function fb(o,t=us){return o[t]||""}function pb(o,t,r=us){return o[r]=t,o}function hr(o,t=us){let r="";return typeof o.bindings>"u"?r=fb(o,t):r=o.bindings().context||"",r}function db(o,t,r=us){const n=hr(o,r);return n.trim()?`${n}/${t}`:t}function lr(o,t,r=us){const n=db(o,t,r),s=o.child({context:n});return pb(s,n,r)}let gb=class extends Gi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}},yb=class extends Gi{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},vb=class{constructor(t,r){this.logger=t,this.core=r}},mb=class extends Gi{constructor(t,r){super(),this.relayer=t,this.logger=r}},wb=class extends Gi{constructor(t){super()}},_b=class{constructor(t,r,n,s){this.core=t,this.logger=r,this.name=n}},bb=class extends Gi{constructor(t,r){super(),this.relayer=t,this.logger=r}},Eb=class extends Gi{constructor(t,r){super(),this.core=t,this.logger=r}},Ib=class{constructor(t,r){this.projectId=t,this.logger=r}},xb=class{constructor(t,r){this.projectId=t,this.logger=r}},Pb=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},Sb=class{constructor(t){this.client=t}};var Jc={},kf={};(function(o){Object.defineProperty(o,"__esModule",{value:!0});var t=Z0,r=wf;o.DIGEST_LENGTH=64,o.BLOCK_SIZE=128;var n=function(){function g(){this.digestLength=o.DIGEST_LENGTH,this.blockSize=o.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return g.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},g.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},g.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},g.prototype.update=function(v,p){if(p===void 0&&(p=v.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var w=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<o.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=v[w++],p--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(w=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,v,w,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=v[w++],p--;return this},g.prototype.finish=function(v){if(!this._finished){var p=this._bytesHashed,w=this._bufferLength,x=p/536870912|0,T=p<<3,D=p%128<112?128:256;this._buffer[w]=128;for(var A=w+1;A<D-8;A++)this._buffer[A]=0;t.writeUint32BE(x,this._buffer,D-8),t.writeUint32BE(T,this._buffer,D-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,D),this._finished=!0}for(var A=0;A<this.digestLength/8;A++)t.writeUint32BE(this._stateHi[A],v,A*8),t.writeUint32BE(this._stateLo[A],v,A*8+4);return this},g.prototype.digest=function(){var v=new Uint8Array(this.digestLength);return this.finish(v),v},g.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},g.prototype.restoreState=function(v){return this._stateHi.set(v.stateHi),this._stateLo.set(v.stateLo),this._bufferLength=v.bufferLength,v.buffer&&this._buffer.set(v.buffer),this._bytesHashed=v.bytesHashed,this._finished=!1,this},g.prototype.cleanSavedState=function(v){r.wipe(v.stateHi),r.wipe(v.stateLo),v.buffer&&r.wipe(v.buffer),v.bufferLength=0,v.bytesHashed=0},g}();o.SHA512=n;var s=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(g,v,p,w,x,T,D){for(var A=p[0],J=p[1],ee=p[2],ce=p[3],ae=p[4],oe=p[5],te=p[6],he=p[7],pe=w[0],Y=w[1],ve=w[2],_t=w[3],st=w[4],Be=w[5],Mt=w[6],zt=w[7],b,O,Q,le,k,H,K,B;D>=128;){for(var et=0;et<16;et++){var ot=8*et+T;g[et]=t.readUint32BE(x,ot),v[et]=t.readUint32BE(x,ot+4)}for(var et=0;et<80;et++){var Ri=A,Ee=J,Ar=ee,L=ce,N=ae,C=oe,h=te,I=he,Z=pe,ue=Y,me=ve,Oe=_t,Ae=st,Ie=Be,bt=Mt,gt=zt;if(b=he,O=zt,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=(ae>>>14|st<<18)^(ae>>>18|st<<14)^(st>>>9|ae<<23),O=(st>>>14|ae<<18)^(st>>>18|ae<<14)^(ae>>>9|st<<23),k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,b=ae&oe^~ae&te,O=st&Be^~st&Mt,k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,b=s[et*2],O=s[et*2+1],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,b=g[et%16],O=v[et%16],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,Q=K&65535|B<<16,le=k&65535|H<<16,b=Q,O=le,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=(A>>>28|pe<<4)^(pe>>>2|A<<30)^(pe>>>7|A<<25),O=(pe>>>28|A<<4)^(A>>>2|pe<<30)^(A>>>7|pe<<25),k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,b=A&J^A&ee^J&ee,O=pe&Y^pe&ve^Y&ve,k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,I=K&65535|B<<16,gt=k&65535|H<<16,b=L,O=Oe,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=Q,O=le,k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,L=K&65535|B<<16,Oe=k&65535|H<<16,J=Ri,ee=Ee,ce=Ar,ae=L,oe=N,te=C,he=h,A=I,Y=Z,ve=ue,_t=me,st=Oe,Be=Ae,Mt=Ie,zt=bt,pe=gt,et%16===15)for(var ot=0;ot<16;ot++)b=g[ot],O=v[ot],k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=g[(ot+9)%16],O=v[(ot+9)%16],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,Q=g[(ot+1)%16],le=v[(ot+1)%16],b=(Q>>>1|le<<31)^(Q>>>8|le<<24)^Q>>>7,O=(le>>>1|Q<<31)^(le>>>8|Q<<24)^(le>>>7|Q<<25),k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,Q=g[(ot+14)%16],le=v[(ot+14)%16],b=(Q>>>19|le<<13)^(le>>>29|Q<<3)^Q>>>6,O=(le>>>19|Q<<13)^(Q>>>29|le<<3)^(le>>>6|Q<<26),k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,g[ot]=K&65535|B<<16,v[ot]=k&65535|H<<16}b=A,O=pe,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=p[0],O=w[0],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,p[0]=A=K&65535|B<<16,w[0]=pe=k&65535|H<<16,b=J,O=Y,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=p[1],O=w[1],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,p[1]=J=K&65535|B<<16,w[1]=Y=k&65535|H<<16,b=ee,O=ve,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=p[2],O=w[2],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,p[2]=ee=K&65535|B<<16,w[2]=ve=k&65535|H<<16,b=ce,O=_t,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=p[3],O=w[3],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,p[3]=ce=K&65535|B<<16,w[3]=_t=k&65535|H<<16,b=ae,O=st,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=p[4],O=w[4],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,p[4]=ae=K&65535|B<<16,w[4]=st=k&65535|H<<16,b=oe,O=Be,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=p[5],O=w[5],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,p[5]=oe=K&65535|B<<16,w[5]=Be=k&65535|H<<16,b=te,O=Mt,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=p[6],O=w[6],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,p[6]=te=K&65535|B<<16,w[6]=Mt=k&65535|H<<16,b=he,O=zt,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=p[7],O=w[7],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,p[7]=he=K&65535|B<<16,w[7]=zt=k&65535|H<<16,T+=128,D-=128}return T}function l(g){var v=new n;v.update(g);var p=v.digest();return v.clean(),p}o.hash=l})(kf);(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.convertSecretKeyToX25519=o.convertPublicKeyToX25519=o.verify=o.sign=o.extractPublicKeyFromSecretKey=o.generateKeyPair=o.generateKeyPairFromSeed=o.SEED_LENGTH=o.SECRET_KEY_LENGTH=o.PUBLIC_KEY_LENGTH=o.SIGNATURE_LENGTH=void 0;const t=_f,r=kf,n=wf;o.SIGNATURE_LENGTH=64,o.PUBLIC_KEY_LENGTH=32,o.SECRET_KEY_LENGTH=64,o.SEED_LENGTH=32;function s(L){const N=new Float64Array(16);if(L)for(let C=0;C<L.length;C++)N[C]=L[C];return N}const c=new Uint8Array(32);c[0]=9;const l=s(),g=s([1]),v=s([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=s([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),w=s([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),x=s([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),T=s([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function D(L,N){for(let C=0;C<16;C++)L[C]=N[C]|0}function A(L){let N=1;for(let C=0;C<16;C++){let h=L[C]+N+65535;N=Math.floor(h/65536),L[C]=h-N*65536}L[0]+=N-1+37*(N-1)}function J(L,N,C){const h=~(C-1);for(let I=0;I<16;I++){const Z=h&(L[I]^N[I]);L[I]^=Z,N[I]^=Z}}function ee(L,N){const C=s(),h=s();for(let I=0;I<16;I++)h[I]=N[I];A(h),A(h),A(h);for(let I=0;I<2;I++){C[0]=h[0]-65517;for(let ue=1;ue<15;ue++)C[ue]=h[ue]-65535-(C[ue-1]>>16&1),C[ue-1]&=65535;C[15]=h[15]-32767-(C[14]>>16&1);const Z=C[15]>>16&1;C[14]&=65535,J(h,C,1-Z)}for(let I=0;I<16;I++)L[2*I]=h[I]&255,L[2*I+1]=h[I]>>8}function ce(L,N){let C=0;for(let h=0;h<32;h++)C|=L[h]^N[h];return(1&C-1>>>8)-1}function ae(L,N){const C=new Uint8Array(32),h=new Uint8Array(32);return ee(C,L),ee(h,N),ce(C,h)}function oe(L){const N=new Uint8Array(32);return ee(N,L),N[0]&1}function te(L,N){for(let C=0;C<16;C++)L[C]=N[2*C]+(N[2*C+1]<<8);L[15]&=32767}function he(L,N,C){for(let h=0;h<16;h++)L[h]=N[h]+C[h]}function pe(L,N,C){for(let h=0;h<16;h++)L[h]=N[h]-C[h]}function Y(L,N,C){let h,I,Z=0,ue=0,me=0,Oe=0,Ae=0,Ie=0,bt=0,gt=0,tt=0,Ce=0,Fe=0,Ve=0,rt=0,Le=0,Ge=0,Re=0,Me=0,at=0,Ne=0,Et=0,Ct=0,Ut=0,Ht=0,Dt=0,Wt=0,er=0,zr=0,Jt=0,Gr=0,li=0,Ai=0,ct=C[0],Qe=C[1],ut=C[2],ht=C[3],it=C[4],Ye=C[5],It=C[6],xt=C[7],lt=C[8],Pt=C[9],ft=C[10],yt=C[11],pt=C[12],Ke=C[13],St=C[14],Ot=C[15];h=N[0],Z+=h*ct,ue+=h*Qe,me+=h*ut,Oe+=h*ht,Ae+=h*it,Ie+=h*Ye,bt+=h*It,gt+=h*xt,tt+=h*lt,Ce+=h*Pt,Fe+=h*ft,Ve+=h*yt,rt+=h*pt,Le+=h*Ke,Ge+=h*St,Re+=h*Ot,h=N[1],ue+=h*ct,me+=h*Qe,Oe+=h*ut,Ae+=h*ht,Ie+=h*it,bt+=h*Ye,gt+=h*It,tt+=h*xt,Ce+=h*lt,Fe+=h*Pt,Ve+=h*ft,rt+=h*yt,Le+=h*pt,Ge+=h*Ke,Re+=h*St,Me+=h*Ot,h=N[2],me+=h*ct,Oe+=h*Qe,Ae+=h*ut,Ie+=h*ht,bt+=h*it,gt+=h*Ye,tt+=h*It,Ce+=h*xt,Fe+=h*lt,Ve+=h*Pt,rt+=h*ft,Le+=h*yt,Ge+=h*pt,Re+=h*Ke,Me+=h*St,at+=h*Ot,h=N[3],Oe+=h*ct,Ae+=h*Qe,Ie+=h*ut,bt+=h*ht,gt+=h*it,tt+=h*Ye,Ce+=h*It,Fe+=h*xt,Ve+=h*lt,rt+=h*Pt,Le+=h*ft,Ge+=h*yt,Re+=h*pt,Me+=h*Ke,at+=h*St,Ne+=h*Ot,h=N[4],Ae+=h*ct,Ie+=h*Qe,bt+=h*ut,gt+=h*ht,tt+=h*it,Ce+=h*Ye,Fe+=h*It,Ve+=h*xt,rt+=h*lt,Le+=h*Pt,Ge+=h*ft,Re+=h*yt,Me+=h*pt,at+=h*Ke,Ne+=h*St,Et+=h*Ot,h=N[5],Ie+=h*ct,bt+=h*Qe,gt+=h*ut,tt+=h*ht,Ce+=h*it,Fe+=h*Ye,Ve+=h*It,rt+=h*xt,Le+=h*lt,Ge+=h*Pt,Re+=h*ft,Me+=h*yt,at+=h*pt,Ne+=h*Ke,Et+=h*St,Ct+=h*Ot,h=N[6],bt+=h*ct,gt+=h*Qe,tt+=h*ut,Ce+=h*ht,Fe+=h*it,Ve+=h*Ye,rt+=h*It,Le+=h*xt,Ge+=h*lt,Re+=h*Pt,Me+=h*ft,at+=h*yt,Ne+=h*pt,Et+=h*Ke,Ct+=h*St,Ut+=h*Ot,h=N[7],gt+=h*ct,tt+=h*Qe,Ce+=h*ut,Fe+=h*ht,Ve+=h*it,rt+=h*Ye,Le+=h*It,Ge+=h*xt,Re+=h*lt,Me+=h*Pt,at+=h*ft,Ne+=h*yt,Et+=h*pt,Ct+=h*Ke,Ut+=h*St,Ht+=h*Ot,h=N[8],tt+=h*ct,Ce+=h*Qe,Fe+=h*ut,Ve+=h*ht,rt+=h*it,Le+=h*Ye,Ge+=h*It,Re+=h*xt,Me+=h*lt,at+=h*Pt,Ne+=h*ft,Et+=h*yt,Ct+=h*pt,Ut+=h*Ke,Ht+=h*St,Dt+=h*Ot,h=N[9],Ce+=h*ct,Fe+=h*Qe,Ve+=h*ut,rt+=h*ht,Le+=h*it,Ge+=h*Ye,Re+=h*It,Me+=h*xt,at+=h*lt,Ne+=h*Pt,Et+=h*ft,Ct+=h*yt,Ut+=h*pt,Ht+=h*Ke,Dt+=h*St,Wt+=h*Ot,h=N[10],Fe+=h*ct,Ve+=h*Qe,rt+=h*ut,Le+=h*ht,Ge+=h*it,Re+=h*Ye,Me+=h*It,at+=h*xt,Ne+=h*lt,Et+=h*Pt,Ct+=h*ft,Ut+=h*yt,Ht+=h*pt,Dt+=h*Ke,Wt+=h*St,er+=h*Ot,h=N[11],Ve+=h*ct,rt+=h*Qe,Le+=h*ut,Ge+=h*ht,Re+=h*it,Me+=h*Ye,at+=h*It,Ne+=h*xt,Et+=h*lt,Ct+=h*Pt,Ut+=h*ft,Ht+=h*yt,Dt+=h*pt,Wt+=h*Ke,er+=h*St,zr+=h*Ot,h=N[12],rt+=h*ct,Le+=h*Qe,Ge+=h*ut,Re+=h*ht,Me+=h*it,at+=h*Ye,Ne+=h*It,Et+=h*xt,Ct+=h*lt,Ut+=h*Pt,Ht+=h*ft,Dt+=h*yt,Wt+=h*pt,er+=h*Ke,zr+=h*St,Jt+=h*Ot,h=N[13],Le+=h*ct,Ge+=h*Qe,Re+=h*ut,Me+=h*ht,at+=h*it,Ne+=h*Ye,Et+=h*It,Ct+=h*xt,Ut+=h*lt,Ht+=h*Pt,Dt+=h*ft,Wt+=h*yt,er+=h*pt,zr+=h*Ke,Jt+=h*St,Gr+=h*Ot,h=N[14],Ge+=h*ct,Re+=h*Qe,Me+=h*ut,at+=h*ht,Ne+=h*it,Et+=h*Ye,Ct+=h*It,Ut+=h*xt,Ht+=h*lt,Dt+=h*Pt,Wt+=h*ft,er+=h*yt,zr+=h*pt,Jt+=h*Ke,Gr+=h*St,li+=h*Ot,h=N[15],Re+=h*ct,Me+=h*Qe,at+=h*ut,Ne+=h*ht,Et+=h*it,Ct+=h*Ye,Ut+=h*It,Ht+=h*xt,Dt+=h*lt,Wt+=h*Pt,er+=h*ft,zr+=h*yt,Jt+=h*pt,Gr+=h*Ke,li+=h*St,Ai+=h*Ot,Z+=38*Me,ue+=38*at,me+=38*Ne,Oe+=38*Et,Ae+=38*Ct,Ie+=38*Ut,bt+=38*Ht,gt+=38*Dt,tt+=38*Wt,Ce+=38*er,Fe+=38*zr,Ve+=38*Jt,rt+=38*Gr,Le+=38*li,Ge+=38*Ai,I=1,h=Z+I+65535,I=Math.floor(h/65536),Z=h-I*65536,h=ue+I+65535,I=Math.floor(h/65536),ue=h-I*65536,h=me+I+65535,I=Math.floor(h/65536),me=h-I*65536,h=Oe+I+65535,I=Math.floor(h/65536),Oe=h-I*65536,h=Ae+I+65535,I=Math.floor(h/65536),Ae=h-I*65536,h=Ie+I+65535,I=Math.floor(h/65536),Ie=h-I*65536,h=bt+I+65535,I=Math.floor(h/65536),bt=h-I*65536,h=gt+I+65535,I=Math.floor(h/65536),gt=h-I*65536,h=tt+I+65535,I=Math.floor(h/65536),tt=h-I*65536,h=Ce+I+65535,I=Math.floor(h/65536),Ce=h-I*65536,h=Fe+I+65535,I=Math.floor(h/65536),Fe=h-I*65536,h=Ve+I+65535,I=Math.floor(h/65536),Ve=h-I*65536,h=rt+I+65535,I=Math.floor(h/65536),rt=h-I*65536,h=Le+I+65535,I=Math.floor(h/65536),Le=h-I*65536,h=Ge+I+65535,I=Math.floor(h/65536),Ge=h-I*65536,h=Re+I+65535,I=Math.floor(h/65536),Re=h-I*65536,Z+=I-1+37*(I-1),I=1,h=Z+I+65535,I=Math.floor(h/65536),Z=h-I*65536,h=ue+I+65535,I=Math.floor(h/65536),ue=h-I*65536,h=me+I+65535,I=Math.floor(h/65536),me=h-I*65536,h=Oe+I+65535,I=Math.floor(h/65536),Oe=h-I*65536,h=Ae+I+65535,I=Math.floor(h/65536),Ae=h-I*65536,h=Ie+I+65535,I=Math.floor(h/65536),Ie=h-I*65536,h=bt+I+65535,I=Math.floor(h/65536),bt=h-I*65536,h=gt+I+65535,I=Math.floor(h/65536),gt=h-I*65536,h=tt+I+65535,I=Math.floor(h/65536),tt=h-I*65536,h=Ce+I+65535,I=Math.floor(h/65536),Ce=h-I*65536,h=Fe+I+65535,I=Math.floor(h/65536),Fe=h-I*65536,h=Ve+I+65535,I=Math.floor(h/65536),Ve=h-I*65536,h=rt+I+65535,I=Math.floor(h/65536),rt=h-I*65536,h=Le+I+65535,I=Math.floor(h/65536),Le=h-I*65536,h=Ge+I+65535,I=Math.floor(h/65536),Ge=h-I*65536,h=Re+I+65535,I=Math.floor(h/65536),Re=h-I*65536,Z+=I-1+37*(I-1),L[0]=Z,L[1]=ue,L[2]=me,L[3]=Oe,L[4]=Ae,L[5]=Ie,L[6]=bt,L[7]=gt,L[8]=tt,L[9]=Ce,L[10]=Fe,L[11]=Ve,L[12]=rt,L[13]=Le,L[14]=Ge,L[15]=Re}function ve(L,N){Y(L,N,N)}function _t(L,N){const C=s();let h;for(h=0;h<16;h++)C[h]=N[h];for(h=253;h>=0;h--)ve(C,C),h!==2&&h!==4&&Y(C,C,N);for(h=0;h<16;h++)L[h]=C[h]}function st(L,N){const C=s();let h;for(h=0;h<16;h++)C[h]=N[h];for(h=250;h>=0;h--)ve(C,C),h!==1&&Y(C,C,N);for(h=0;h<16;h++)L[h]=C[h]}function Be(L,N){const C=s(),h=s(),I=s(),Z=s(),ue=s(),me=s(),Oe=s(),Ae=s(),Ie=s();pe(C,L[1],L[0]),pe(Ie,N[1],N[0]),Y(C,C,Ie),he(h,L[0],L[1]),he(Ie,N[0],N[1]),Y(h,h,Ie),Y(I,L[3],N[3]),Y(I,I,p),Y(Z,L[2],N[2]),he(Z,Z,Z),pe(ue,h,C),pe(me,Z,I),he(Oe,Z,I),he(Ae,h,C),Y(L[0],ue,me),Y(L[1],Ae,Oe),Y(L[2],Oe,me),Y(L[3],ue,Ae)}function Mt(L,N,C){for(let h=0;h<4;h++)J(L[h],N[h],C)}function zt(L,N){const C=s(),h=s(),I=s();_t(I,N[2]),Y(C,N[0],I),Y(h,N[1],I),ee(L,h),L[31]^=oe(C)<<7}function b(L,N,C){D(L[0],l),D(L[1],g),D(L[2],g),D(L[3],l);for(let h=255;h>=0;--h){const I=C[h/8|0]>>(h&7)&1;Mt(L,N,I),Be(N,L),Be(L,L),Mt(L,N,I)}}function O(L,N){const C=[s(),s(),s(),s()];D(C[0],w),D(C[1],x),D(C[2],g),Y(C[3],w,x),b(L,C,N)}function Q(L){if(L.length!==o.SEED_LENGTH)throw new Error(`ed25519: seed must be ${o.SEED_LENGTH} bytes`);const N=(0,r.hash)(L);N[0]&=248,N[31]&=127,N[31]|=64;const C=new Uint8Array(32),h=[s(),s(),s(),s()];O(h,N),zt(C,h);const I=new Uint8Array(64);return I.set(L),I.set(C,32),{publicKey:C,secretKey:I}}o.generateKeyPairFromSeed=Q;function le(L){const N=(0,t.randomBytes)(32,L),C=Q(N);return(0,n.wipe)(N),C}o.generateKeyPair=le;function k(L){if(L.length!==o.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${o.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(L.subarray(32))}o.extractPublicKeyFromSecretKey=k;const H=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function K(L,N){let C,h,I,Z;for(h=63;h>=32;--h){for(C=0,I=h-32,Z=h-12;I<Z;++I)N[I]+=C-16*N[h]*H[I-(h-32)],C=Math.floor((N[I]+128)/256),N[I]-=C*256;N[I]+=C,N[h]=0}for(C=0,I=0;I<32;I++)N[I]+=C-(N[31]>>4)*H[I],C=N[I]>>8,N[I]&=255;for(I=0;I<32;I++)N[I]-=C*H[I];for(h=0;h<32;h++)N[h+1]+=N[h]>>8,L[h]=N[h]&255}function B(L){const N=new Float64Array(64);for(let C=0;C<64;C++)N[C]=L[C];for(let C=0;C<64;C++)L[C]=0;K(L,N)}function et(L,N){const C=new Float64Array(64),h=[s(),s(),s(),s()],I=(0,r.hash)(L.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const Z=new Uint8Array(64);Z.set(I.subarray(32),32);const ue=new r.SHA512;ue.update(Z.subarray(32)),ue.update(N);const me=ue.digest();ue.clean(),B(me),O(h,me),zt(Z,h),ue.reset(),ue.update(Z.subarray(0,32)),ue.update(L.subarray(32)),ue.update(N);const Oe=ue.digest();B(Oe);for(let Ae=0;Ae<32;Ae++)C[Ae]=me[Ae];for(let Ae=0;Ae<32;Ae++)for(let Ie=0;Ie<32;Ie++)C[Ae+Ie]+=Oe[Ae]*I[Ie];return K(Z.subarray(32),C),Z}o.sign=et;function ot(L,N){const C=s(),h=s(),I=s(),Z=s(),ue=s(),me=s(),Oe=s();return D(L[2],g),te(L[1],N),ve(I,L[1]),Y(Z,I,v),pe(I,I,L[2]),he(Z,L[2],Z),ve(ue,Z),ve(me,ue),Y(Oe,me,ue),Y(C,Oe,I),Y(C,C,Z),st(C,C),Y(C,C,I),Y(C,C,Z),Y(C,C,Z),Y(L[0],C,Z),ve(h,L[0]),Y(h,h,Z),ae(h,I)&&Y(L[0],L[0],T),ve(h,L[0]),Y(h,h,Z),ae(h,I)?-1:(oe(L[0])===N[31]>>7&&pe(L[0],l,L[0]),Y(L[3],L[0],L[1]),0)}function Ri(L,N,C){const h=new Uint8Array(32),I=[s(),s(),s(),s()],Z=[s(),s(),s(),s()];if(C.length!==o.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${o.SIGNATURE_LENGTH} bytes`);if(ot(Z,L))return!1;const ue=new r.SHA512;ue.update(C.subarray(0,32)),ue.update(L),ue.update(N);const me=ue.digest();return B(me),b(I,Z,me),O(Z,C.subarray(32)),Be(I,Z),zt(h,I),!ce(C,h)}o.verify=Ri;function Ee(L){let N=[s(),s(),s(),s()];if(ot(N,L))throw new Error("Ed25519: invalid public key");let C=s(),h=s(),I=N[1];he(C,g,I),pe(h,g,I),_t(h,h),Y(C,C,h);let Z=new Uint8Array(32);return ee(Z,C),Z}o.convertPublicKeyToX25519=Ee;function Ar(L){const N=(0,r.hash)(L.subarray(0,32));N[0]&=248,N[31]&=127,N[31]|=64;const C=new Uint8Array(N.subarray(0,32));return(0,n.wipe)(N),C}o.convertSecretKeyToX25519=Ar})(Jc);const Ob="EdDSA",Rb="JWT",Kf=".",Bf="base64url",Ab="utf8",Tb="utf8",Cb=":",$b="did",Nb="key",xl="base58btc",Db="z",Lb="K36",jb=32;function Ao(o){return No(Vc(Fi(o),Ab),Bf)}function Ff(o){const t=Vc(Lb,xl),r=Db+No(X0([t,o]),xl);return[$b,Nb,r].join(Cb)}function qb(o){return No(o,Bf)}function Mb(o){return Vc([Ao(o.header),Ao(o.payload)].join(Kf),Tb)}function zb(o){return[Ao(o.header),Ao(o.payload),qb(o.signature)].join(Kf)}function Pl(o=_f.randomBytes(jb)){return Jc.generateKeyPairFromSeed(o)}async function Ub(o,t,r,n,s=re.fromMiliseconds(Date.now())){const c={alg:Ob,typ:Rb},l=Ff(n.publicKey),g=s+r,v={iss:l,sub:o,aud:t,iat:s,exp:g},p=Mb({header:c,payload:v}),w=Jc.sign(n.secretKey,p);return zb({header:c,payload:v,signature:w})}const Hb="PARSE_ERROR",kb="INVALID_REQUEST",Kb="METHOD_NOT_FOUND",Bb="INVALID_PARAMS",Vf="INTERNAL_ERROR",Qc="SERVER_ERROR",Fb=[-32700,-32600,-32601,-32602,-32603],es={[Hb]:{code:-32700,message:"Parse error"},[kb]:{code:-32600,message:"Invalid Request"},[Kb]:{code:-32601,message:"Method not found"},[Bb]:{code:-32602,message:"Invalid params"},[Vf]:{code:-32603,message:"Internal error"},[Qc]:{code:-32e3,message:"Server error"}},Gf=Qc;function Vb(o){return Fb.includes(o)}function Sl(o){return Object.keys(es).includes(o)?es[o]:es[Gf]}function Gb(o){const t=Object.values(es).find(r=>r.code===o);return t||es[Gf]}function Wf(o,t,r){return o.message.includes("getaddrinfo ENOTFOUND")||o.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):o}var Jf={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var jc=function(o,t){return jc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])},jc(o,t)};function Wb(o,t){jc(o,t);function r(){this.constructor=o}o.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var qc=function(){return qc=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},qc.apply(this,arguments)};function Jb(o,t){var r={};for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&t.indexOf(n)<0&&(r[n]=o[n]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(o);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(o,n[s])&&(r[n[s]]=o[n[s]]);return r}function Qb(o,t,r,n){var s=arguments.length,c=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,t,r,n);else for(var g=o.length-1;g>=0;g--)(l=o[g])&&(c=(s<3?l(c):s>3?l(t,r,c):l(t,r))||c);return s>3&&c&&Object.defineProperty(t,r,c),c}function Yb(o,t){return function(r,n){t(r,n,o)}}function Zb(o,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,t)}function Xb(o,t,r,n){function s(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function g(w){try{p(n.next(w))}catch(x){l(x)}}function v(w){try{p(n.throw(w))}catch(x){l(x)}}function p(w){w.done?c(w.value):s(w.value).then(g,v)}p((n=n.apply(o,t||[])).next())})}function e1(o,t){var r={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function g(p){return function(w){return v([p,w])}}function v(p){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(c=p[0]&2?s.return:p[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,p[1])).done)return c;switch(s=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return r.label++,{value:p[1],done:!1};case 5:r.label++,s=p[1],p=[0];continue;case 7:p=r.ops.pop(),r.trys.pop();continue;default:if(c=r.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){r=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){r.label=p[1];break}if(p[0]===6&&r.label<c[1]){r.label=c[1],c=p;break}if(c&&r.label<c[2]){r.label=c[2],r.ops.push(p);break}c[2]&&r.ops.pop(),r.trys.pop();continue}p=t.call(o,r)}catch(w){p=[6,w],s=0}finally{n=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function t1(o,t,r,n){n===void 0&&(n=r),o[n]=t[r]}function r1(o,t){for(var r in o)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=o[r])}function Mc(o){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&o[t],n=0;if(r)return r.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&n>=o.length&&(o=void 0),{value:o&&o[n++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Qf(o,t){var r=typeof Symbol=="function"&&o[Symbol.iterator];if(!r)return o;var n=r.call(o),s,c=[],l;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(g){l={error:g}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(l)throw l.error}}return c}function i1(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(Qf(arguments[t]));return o}function n1(){for(var o=0,t=0,r=arguments.length;t<r;t++)o+=arguments[t].length;for(var n=Array(o),s=0,t=0;t<r;t++)for(var c=arguments[t],l=0,g=c.length;l<g;l++,s++)n[s]=c[l];return n}function ss(o){return this instanceof ss?(this.v=o,this):new ss(o)}function s1(o,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(o,t||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(T){n[T]&&(s[T]=function(D){return new Promise(function(A,J){c.push([T,D,A,J])>1||g(T,D)})})}function g(T,D){try{v(n[T](D))}catch(A){x(c[0][3],A)}}function v(T){T.value instanceof ss?Promise.resolve(T.value.v).then(p,w):x(c[0][2],T)}function p(T){g("next",T)}function w(T){g("throw",T)}function x(T,D){T(D),c.shift(),c.length&&g(c[0][0],c[0][1])}}function o1(o){var t,r;return t={},n("next"),n("throw",function(s){throw s}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(s,c){t[s]=o[s]?function(l){return(r=!r)?{value:ss(o[s](l)),done:s==="return"}:c?c(l):l}:c}}function a1(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=o[Symbol.asyncIterator],r;return t?t.call(o):(o=typeof Mc=="function"?Mc(o):o[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(c){r[c]=o[c]&&function(l){return new Promise(function(g,v){l=o[c](l),s(g,v,l.done,l.value)})}}function s(c,l,g,v){Promise.resolve(v).then(function(p){c({value:p,done:g})},l)}}function c1(o,t){return Object.defineProperty?Object.defineProperty(o,"raw",{value:t}):o.raw=t,o}function u1(o){if(o&&o.__esModule)return o;var t={};if(o!=null)for(var r in o)Object.hasOwnProperty.call(o,r)&&(t[r]=o[r]);return t.default=o,t}function h1(o){return o&&o.__esModule?o:{default:o}}function l1(o,t){if(!t.has(o))throw new TypeError("attempted to get private field on non-instance");return t.get(o)}function f1(o,t,r){if(!t.has(o))throw new TypeError("attempted to set private field on non-instance");return t.set(o,r),r}const p1=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return qc},__asyncDelegator:o1,__asyncGenerator:s1,__asyncValues:a1,__await:ss,__awaiter:Xb,__classPrivateFieldGet:l1,__classPrivateFieldSet:f1,__createBinding:t1,__decorate:Qb,__exportStar:r1,__extends:Wb,__generator:e1,__importDefault:h1,__importStar:u1,__makeTemplateObject:c1,__metadata:Zb,__param:Yb,__read:Qf,__rest:Jb,__spread:i1,__spreadArrays:n1,__values:Mc},Symbol.toStringTag,{value:"Module"})),d1=$o(p1);var si={},Ol;function g1(){if(Ol)return si;Ol=1,Object.defineProperty(si,"__esModule",{value:!0}),si.isBrowserCryptoAvailable=si.getSubtleCrypto=si.getBrowerCrypto=void 0;function o(){return(Mr===null||Mr===void 0?void 0:Mr.crypto)||(Mr===null||Mr===void 0?void 0:Mr.msCrypto)||{}}si.getBrowerCrypto=o;function t(){const n=o();return n.subtle||n.webkitSubtle}si.getSubtleCrypto=t;function r(){return!!o()&&!!t()}return si.isBrowserCryptoAvailable=r,si}var oi={},Rl;function y1(){if(Rl)return oi;Rl=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.isBrowser=oi.isNode=oi.isReactNative=void 0;function o(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}oi.isReactNative=o;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}oi.isNode=t;function r(){return!o()&&!t()}return oi.isBrowser=r,oi}(function(o){Object.defineProperty(o,"__esModule",{value:!0});const t=d1;t.__exportStar(g1(),o),t.__exportStar(y1(),o)})(Jf);function Yc(o=3){const t=Date.now()*Math.pow(10,o),r=Math.floor(Math.random()*Math.pow(10,o));return t+r}function Zc(o=6){return BigInt(Yc(o))}function Bi(o,t,r){return{id:r||Yc(),jsonrpc:"2.0",method:o,params:t}}function zo(o,t){return{id:o,jsonrpc:"2.0",result:t}}function Uo(o,t,r){return{id:o,jsonrpc:"2.0",error:v1(t)}}function v1(o,t){return typeof o>"u"?Sl(Vf):(typeof o=="string"&&(o=Object.assign(Object.assign({},Sl(Qc)),{message:o})),Vb(o.code)&&(o=Gb(o.code)),o)}class m1{}class w1 extends m1{constructor(){super()}}class Yf extends w1{constructor(t){super()}}const _1="^https?:",b1="^wss?:";function E1(o){const t=o.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Zf(o,t){const r=E1(o);return typeof r>"u"?!1:new RegExp(t).test(r)}function Al(o){return Zf(o,_1)}function Tl(o){return Zf(o,b1)}function I1(o){return new RegExp("wss?://localhost(:d{2,5})?").test(o)}function Xf(o){return typeof o=="object"&&"id"in o&&"jsonrpc"in o&&o.jsonrpc==="2.0"}function Xc(o){return Xf(o)&&"method"in o}function hs(o){return Xf(o)&&(ui(o)||Rr(o))}function ui(o){return"result"in o}function Rr(o){return"error"in o}let x1=class extends Yf{constructor(t){super(t),this.events=new ur.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Bi(t.method,t.params||[],t.id||Zc().toString()),r)}async requestStrict(t,r){return new Promise(async(n,s)=>{if(!this.connection.connected)try{await this.open()}catch(c){s(c)}this.events.on(`${t.id}`,c=>{Rr(c)?s(c.error):n(c.result)});try{await this.connection.send(t,r)}catch(c){s(c)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),hs(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const P1=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),S1=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Cl=o=>o.split("?")[0],$l=10,O1=P1();let R1=class{constructor(t){if(this.url=t,this.events=new ur.EventEmitter,this.registering=!1,!Tl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Fi(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!Tl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,s)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),s(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,n)=>{const s=new URLSearchParams(t).get("origin"),c=Jf.isReactNative()?{headers:{origin:s}}:{rejectUnauthorized:!I1(t)},l=new O1(t,[],c);S1()?l.onerror=g=>{const v=g;n(this.emitError(v.error))}:l.on("error",g=>{n(this.emitError(g))}),l.onopen=()=>{this.onOpen(l),r(l)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?cs(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),s=n.message||n.toString(),c=Uo(t,s);this.events.emit("payload",c)}parseError(t,r=this.url){return Wf(t,Cl(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>$l&&this.events.setMaxListeners($l)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${Cl(this.url)}`));return this.events.emit("register_error",r),r}};var To={exports:{}};To.exports;(function(o,t){var r=200,n="__lodash_hash_undefined__",s=1,c=2,l=9007199254740991,g="[object Arguments]",v="[object Array]",p="[object AsyncFunction]",w="[object Boolean]",x="[object Date]",T="[object Error]",D="[object Function]",A="[object GeneratorFunction]",J="[object Map]",ee="[object Number]",ce="[object Null]",ae="[object Object]",oe="[object Promise]",te="[object Proxy]",he="[object RegExp]",pe="[object Set]",Y="[object String]",ve="[object Symbol]",_t="[object Undefined]",st="[object WeakMap]",Be="[object ArrayBuffer]",Mt="[object DataView]",zt="[object Float32Array]",b="[object Float64Array]",O="[object Int8Array]",Q="[object Int16Array]",le="[object Int32Array]",k="[object Uint8Array]",H="[object Uint8ClampedArray]",K="[object Uint16Array]",B="[object Uint32Array]",et=/[\\^$.*+?()[\]{}|]/g,ot=/^\[object .+?Constructor\]$/,Ri=/^(?:0|[1-9]\d*)$/,Ee={};Ee[zt]=Ee[b]=Ee[O]=Ee[Q]=Ee[le]=Ee[k]=Ee[H]=Ee[K]=Ee[B]=!0,Ee[g]=Ee[v]=Ee[Be]=Ee[w]=Ee[Mt]=Ee[x]=Ee[T]=Ee[D]=Ee[J]=Ee[ee]=Ee[ae]=Ee[he]=Ee[pe]=Ee[Y]=Ee[st]=!1;var Ar=typeof Mr=="object"&&Mr&&Mr.Object===Object&&Mr,L=typeof self=="object"&&self&&self.Object===Object&&self,N=Ar||L||Function("return this")(),C=t&&!t.nodeType&&t,h=C&&!0&&o&&!o.nodeType&&o,I=h&&h.exports===C,Z=I&&Ar.process,ue=function(){try{return Z&&Z.binding&&Z.binding("util")}catch{}}(),me=ue&&ue.isTypedArray;function Oe(m,P){for(var z=-1,V=m==null?0:m.length,Ue=0,de=[];++z<V;){var We=m[z];P(We,z,m)&&(de[Ue++]=We)}return de}function Ae(m,P){for(var z=-1,V=P.length,Ue=m.length;++z<V;)m[Ue+z]=P[z];return m}function Ie(m,P){for(var z=-1,V=m==null?0:m.length;++z<V;)if(P(m[z],z,m))return!0;return!1}function bt(m,P){for(var z=-1,V=Array(m);++z<m;)V[z]=P(z);return V}function gt(m){return function(P){return m(P)}}function tt(m,P){return m.has(P)}function Ce(m,P){return m==null?void 0:m[P]}function Fe(m){var P=-1,z=Array(m.size);return m.forEach(function(V,Ue){z[++P]=[Ue,V]}),z}function Ve(m,P){return function(z){return m(P(z))}}function rt(m){var P=-1,z=Array(m.size);return m.forEach(function(V){z[++P]=V}),z}var Le=Array.prototype,Ge=Function.prototype,Re=Object.prototype,Me=N["__core-js_shared__"],at=Ge.toString,Ne=Re.hasOwnProperty,Et=function(){var m=/[^.]+$/.exec(Me&&Me.keys&&Me.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),Ct=Re.toString,Ut=RegExp("^"+at.call(Ne).replace(et,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ht=I?N.Buffer:void 0,Dt=N.Symbol,Wt=N.Uint8Array,er=Re.propertyIsEnumerable,zr=Le.splice,Jt=Dt?Dt.toStringTag:void 0,Gr=Object.getOwnPropertySymbols,li=Ht?Ht.isBuffer:void 0,Ai=Ve(Object.keys,Object),ct=fr(N,"DataView"),Qe=fr(N,"Map"),ut=fr(N,"Promise"),ht=fr(N,"Set"),it=fr(N,"WeakMap"),Ye=fr(Object,"create"),It=Jr(ct),xt=Jr(Qe),lt=Jr(ut),Pt=Jr(ht),ft=Jr(it),yt=Dt?Dt.prototype:void 0,pt=yt?yt.valueOf:void 0;function Ke(m){var P=-1,z=m==null?0:m.length;for(this.clear();++P<z;){var V=m[P];this.set(V[0],V[1])}}function St(){this.__data__=Ye?Ye(null):{},this.size=0}function Ot(m){var P=this.has(m)&&delete this.__data__[m];return this.size-=P?1:0,P}function Ko(m){var P=this.__data__;if(Ye){var z=P[m];return z===n?void 0:z}return Ne.call(P,m)?P[m]:void 0}function Bo(m){var P=this.__data__;return Ye?P[m]!==void 0:Ne.call(P,m)}function Fo(m,P){var z=this.__data__;return this.size+=this.has(m)?0:1,z[m]=Ye&&P===void 0?n:P,this}Ke.prototype.clear=St,Ke.prototype.delete=Ot,Ke.prototype.get=Ko,Ke.prototype.has=Bo,Ke.prototype.set=Fo;function mr(m){var P=-1,z=m==null?0:m.length;for(this.clear();++P<z;){var V=m[P];this.set(V[0],V[1])}}function Vo(){this.__data__=[],this.size=0}function Go(m){var P=this.__data__,z=Ti(P,m);if(z<0)return!1;var V=P.length-1;return z==V?P.pop():zr.call(P,z,1),--this.size,!0}function Wo(m){var P=this.__data__,z=Ti(P,m);return z<0?void 0:P[z][1]}function Jo(m){return Ti(this.__data__,m)>-1}function Qo(m,P){var z=this.__data__,V=Ti(z,m);return V<0?(++this.size,z.push([m,P])):z[V][1]=P,this}mr.prototype.clear=Vo,mr.prototype.delete=Go,mr.prototype.get=Wo,mr.prototype.has=Jo,mr.prototype.set=Qo;function Wr(m){var P=-1,z=m==null?0:m.length;for(this.clear();++P<z;){var V=m[P];this.set(V[0],V[1])}}function Ji(){this.size=0,this.__data__={hash:new Ke,map:new(Qe||mr),string:new Ke}}function Yo(m){var P=fi(this,m).delete(m);return this.size-=P?1:0,P}function Qi(m){return fi(this,m).get(m)}function Zo(m){return fi(this,m).has(m)}function Xo(m,P){var z=fi(this,m),V=z.size;return z.set(m,P),this.size+=z.size==V?0:1,this}Wr.prototype.clear=Ji,Wr.prototype.delete=Yo,Wr.prototype.get=Qi,Wr.prototype.has=Zo,Wr.prototype.set=Xo;function Yi(m){var P=-1,z=m==null?0:m.length;for(this.__data__=new Wr;++P<z;)this.add(m[P])}function fs(m){return this.__data__.set(m,n),this}function ps(m){return this.__data__.has(m)}Yi.prototype.add=Yi.prototype.push=fs,Yi.prototype.has=ps;function Tr(m){var P=this.__data__=new mr(m);this.size=P.size}function ea(){this.__data__=new mr,this.size=0}function ta(m){var P=this.__data__,z=P.delete(m);return this.size=P.size,z}function ra(m){return this.__data__.get(m)}function ia(m){return this.__data__.has(m)}function ds(m,P){var z=this.__data__;if(z instanceof mr){var V=z.__data__;if(!Qe||V.length<r-1)return V.push([m,P]),this.size=++z.size,this;z=this.__data__=new Wr(V)}return z.set(m,P),this.size=z.size,this}Tr.prototype.clear=ea,Tr.prototype.delete=ta,Tr.prototype.get=ra,Tr.prototype.has=ia,Tr.prototype.set=ds;function gs(m,P){var z=en(m),V=!z&&Os(m),Ue=!z&&!V&&On(m),de=!z&&!V&&!Ue&&Ts(m),We=z||V||Ue||de,Rt=We?bt(m.length,String):[],Pe=Rt.length;for(var He in m)Ne.call(m,He)&&!(We&&(He=="length"||Ue&&(He=="offset"||He=="parent")||de&&(He=="buffer"||He=="byteLength"||He=="byteOffset")||Es(He,Pe)))&&Rt.push(He);return Rt}function Ti(m,P){for(var z=m.length;z--;)if(Ss(m[z][0],P))return z;return-1}function Pn(m,P,z){var V=P(m);return en(m)?V:Ae(V,z(m))}function Ci(m){return m==null?m===void 0?_t:ce:Jt&&Jt in Object(m)?_s(m):oa(m)}function Sn(m){return Ni(m)&&Ci(m)==g}function $i(m,P,z,V,Ue){return m===P?!0:m==null||P==null||!Ni(m)&&!Ni(P)?m!==m&&P!==P:ys(m,P,z,V,$i,Ue)}function ys(m,P,z,V,Ue,de){var We=en(m),Rt=en(P),Pe=We?v:Ur(m),He=Rt?v:Ur(P);Pe=Pe==g?ae:Pe,He=He==g?ae:He;var vt=Pe==ae,tr=He==ae,At=Pe==He;if(At&&On(m)){if(!On(P))return!1;We=!0,vt=!1}if(At&&!vt)return de||(de=new Tr),We||Ts(m)?Zi(m,P,z,V,Ue,de):sa(m,P,Pe,z,V,Ue,de);if(!(z&s)){var Je=vt&&Ne.call(m,"__wrapped__"),Qt=tr&&Ne.call(P,"__wrapped__");if(Je||Qt){var Cr=Je?m.value():m,wr=Qt?P.value():P;return de||(de=new Tr),Ue(Cr,wr,z,V,de)}}return At?(de||(de=new Tr),ws(m,P,z,V,Ue,de)):!1}function na(m){if(!As(m)||xs(m))return!1;var P=tn(m)?Ut:ot;return P.test(Jr(m))}function vs(m){return Ni(m)&&Rs(m.length)&&!!Ee[Ci(m)]}function ms(m){if(!Ps(m))return Ai(m);var P=[];for(var z in Object(m))Ne.call(m,z)&&z!="constructor"&&P.push(z);return P}function Zi(m,P,z,V,Ue,de){var We=z&s,Rt=m.length,Pe=P.length;if(Rt!=Pe&&!(We&&Pe>Rt))return!1;var He=de.get(m);if(He&&de.get(P))return He==P;var vt=-1,tr=!0,At=z&c?new Yi:void 0;for(de.set(m,P),de.set(P,m);++vt<Rt;){var Je=m[vt],Qt=P[vt];if(V)var Cr=We?V(Qt,Je,vt,P,m,de):V(Je,Qt,vt,m,P,de);if(Cr!==void 0){if(Cr)continue;tr=!1;break}if(At){if(!Ie(P,function(wr,Hr){if(!tt(At,Hr)&&(Je===wr||Ue(Je,wr,z,V,de)))return At.push(Hr)})){tr=!1;break}}else if(!(Je===Qt||Ue(Je,Qt,z,V,de))){tr=!1;break}}return de.delete(m),de.delete(P),tr}function sa(m,P,z,V,Ue,de,We){switch(z){case Mt:if(m.byteLength!=P.byteLength||m.byteOffset!=P.byteOffset)return!1;m=m.buffer,P=P.buffer;case Be:return!(m.byteLength!=P.byteLength||!de(new Wt(m),new Wt(P)));case w:case x:case ee:return Ss(+m,+P);case T:return m.name==P.name&&m.message==P.message;case he:case Y:return m==P+"";case J:var Rt=Fe;case pe:var Pe=V&s;if(Rt||(Rt=rt),m.size!=P.size&&!Pe)return!1;var He=We.get(m);if(He)return He==P;V|=c,We.set(m,P);var vt=Zi(Rt(m),Rt(P),V,Ue,de,We);return We.delete(m),vt;case ve:if(pt)return pt.call(m)==pt.call(P)}return!1}function ws(m,P,z,V,Ue,de){var We=z&s,Rt=Xi(m),Pe=Rt.length,He=Xi(P),vt=He.length;if(Pe!=vt&&!We)return!1;for(var tr=Pe;tr--;){var At=Rt[tr];if(!(We?At in P:Ne.call(P,At)))return!1}var Je=de.get(m);if(Je&&de.get(P))return Je==P;var Qt=!0;de.set(m,P),de.set(P,m);for(var Cr=We;++tr<Pe;){At=Rt[tr];var wr=m[At],Hr=P[At];if(V)var Rn=We?V(Hr,wr,At,P,m,de):V(wr,Hr,At,m,P,de);if(!(Rn===void 0?wr===Hr||Ue(wr,Hr,z,V,de):Rn)){Qt=!1;break}Cr||(Cr=At=="constructor")}if(Qt&&!Cr){var Di=m.constructor,Lt=P.constructor;Di!=Lt&&"constructor"in m&&"constructor"in P&&!(typeof Di=="function"&&Di instanceof Di&&typeof Lt=="function"&&Lt instanceof Lt)&&(Qt=!1)}return de.delete(m),de.delete(P),Qt}function Xi(m){return Pn(m,ua,bs)}function fi(m,P){var z=m.__data__;return Is(P)?z[typeof P=="string"?"string":"hash"]:z.map}function fr(m,P){var z=Ce(m,P);return na(z)?z:void 0}function _s(m){var P=Ne.call(m,Jt),z=m[Jt];try{m[Jt]=void 0;var V=!0}catch{}var Ue=Ct.call(m);return V&&(P?m[Jt]=z:delete m[Jt]),Ue}var bs=Gr?function(m){return m==null?[]:(m=Object(m),Oe(Gr(m),function(P){return er.call(m,P)}))}:ze,Ur=Ci;(ct&&Ur(new ct(new ArrayBuffer(1)))!=Mt||Qe&&Ur(new Qe)!=J||ut&&Ur(ut.resolve())!=oe||ht&&Ur(new ht)!=pe||it&&Ur(new it)!=st)&&(Ur=function(m){var P=Ci(m),z=P==ae?m.constructor:void 0,V=z?Jr(z):"";if(V)switch(V){case It:return Mt;case xt:return J;case lt:return oe;case Pt:return pe;case ft:return st}return P});function Es(m,P){return P=P??l,!!P&&(typeof m=="number"||Ri.test(m))&&m>-1&&m%1==0&&m<P}function Is(m){var P=typeof m;return P=="string"||P=="number"||P=="symbol"||P=="boolean"?m!=="__proto__":m===null}function xs(m){return!!Et&&Et in m}function Ps(m){var P=m&&m.constructor,z=typeof P=="function"&&P.prototype||Re;return m===z}function oa(m){return Ct.call(m)}function Jr(m){if(m!=null){try{return at.call(m)}catch{}try{return m+""}catch{}}return""}function Ss(m,P){return m===P||m!==m&&P!==P}var Os=Sn(function(){return arguments}())?Sn:function(m){return Ni(m)&&Ne.call(m,"callee")&&!er.call(m,"callee")},en=Array.isArray;function aa(m){return m!=null&&Rs(m.length)&&!tn(m)}var On=li||je;function ca(m,P){return $i(m,P)}function tn(m){if(!As(m))return!1;var P=Ci(m);return P==D||P==A||P==p||P==te}function Rs(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=l}function As(m){var P=typeof m;return m!=null&&(P=="object"||P=="function")}function Ni(m){return m!=null&&typeof m=="object"}var Ts=me?gt(me):vs;function ua(m){return aa(m)?gs(m):ms(m)}function ze(){return[]}function je(){return!1}o.exports=ca})(To,To.exports);var A1=To.exports;const T1=os(A1);function C1(o,t){return t=t||{},new Promise(function(r,n){var s=new XMLHttpRequest,c=[],l=[],g={},v=function(){return{ok:(s.status/100|0)==2,statusText:s.statusText,status:s.status,url:s.responseURL,text:function(){return Promise.resolve(s.responseText)},json:function(){return Promise.resolve(s.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([s.response]))},clone:v,headers:{keys:function(){return c},entries:function(){return l},get:function(w){return g[w.toLowerCase()]},has:function(w){return w.toLowerCase()in g}}}};for(var p in s.open(t.method||"get",o,!0),s.onload=function(){s.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(w,x,T){c.push(x=x.toLowerCase()),l.push([x,T]),g[x]=g[x]?g[x]+","+T:T}),r(v())},s.onerror=n,s.withCredentials=t.credentials=="include",t.headers)s.setRequestHeader(p,t.headers[p]);s.send(t.body||null)})}const $1=Object.freeze(Object.defineProperty({__proto__:null,default:C1},Symbol.toStringTag,{value:"Module"})),Nl=$o($1);var N1=self.fetch||(self.fetch=Nl.default||Nl);const D1=os(N1);var L1={};function j1(o,t){if(o.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<o.length;s++){var c=o.charAt(s),l=c.charCodeAt(0);if(r[l]!==255)throw new TypeError(c+" is ambiguous");r[l]=s}var g=o.length,v=o.charAt(0),p=Math.log(g)/Math.log(256),w=Math.log(256)/Math.log(g);function x(A){if(A instanceof Uint8Array||(ArrayBuffer.isView(A)?A=new Uint8Array(A.buffer,A.byteOffset,A.byteLength):Array.isArray(A)&&(A=Uint8Array.from(A))),!(A instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(A.length===0)return"";for(var J=0,ee=0,ce=0,ae=A.length;ce!==ae&&A[ce]===0;)ce++,J++;for(var oe=(ae-ce)*w+1>>>0,te=new Uint8Array(oe);ce!==ae;){for(var he=A[ce],pe=0,Y=oe-1;(he!==0||pe<ee)&&Y!==-1;Y--,pe++)he+=256*te[Y]>>>0,te[Y]=he%g>>>0,he=he/g>>>0;if(he!==0)throw new Error("Non-zero carry");ee=pe,ce++}for(var ve=oe-ee;ve!==oe&&te[ve]===0;)ve++;for(var _t=v.repeat(J);ve<oe;++ve)_t+=o.charAt(te[ve]);return _t}function T(A){if(typeof A!="string")throw new TypeError("Expected String");if(A.length===0)return new Uint8Array;var J=0;if(A[J]!==" "){for(var ee=0,ce=0;A[J]===v;)ee++,J++;for(var ae=(A.length-J)*p+1>>>0,oe=new Uint8Array(ae);A[J];){var te=r[A.charCodeAt(J)];if(te===255)return;for(var he=0,pe=ae-1;(te!==0||he<ce)&&pe!==-1;pe--,he++)te+=g*oe[pe]>>>0,oe[pe]=te%256>>>0,te=te/256>>>0;if(te!==0)throw new Error("Non-zero carry");ce=he,J++}if(A[J]!==" "){for(var Y=ae-ce;Y!==ae&&oe[Y]===0;)Y++;for(var ve=new Uint8Array(ee+(ae-Y)),_t=ee;Y!==ae;)ve[_t++]=oe[Y++];return ve}}}function D(A){var J=T(A);if(J)return J;throw new Error(`Non-${t} character`)}return{encode:x,decodeUnsafe:T,decode:D}}var q1=j1,M1=q1;const ep=o=>{if(o instanceof Uint8Array&&o.constructor.name==="Uint8Array")return o;if(o instanceof ArrayBuffer)return new Uint8Array(o);if(ArrayBuffer.isView(o))return new Uint8Array(o.buffer,o.byteOffset,o.byteLength);throw new Error("Unknown type, must be binary type")},z1=o=>new TextEncoder().encode(o),U1=o=>new TextDecoder().decode(o);class H1{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class k1{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return tp(this,t)}}class K1{constructor(t){this.decoders=t}or(t){return tp(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const tp=(o,t)=>new K1({...o.decoders||{[o.prefix]:o},...t.decoders||{[t.prefix]:t}});class B1{constructor(t,r,n,s){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new H1(t,r,n),this.decoder=new k1(t,r,s)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Ho=({name:o,prefix:t,encode:r,decode:n})=>new B1(o,t,r,n),ls=({prefix:o,name:t,alphabet:r})=>{const{encode:n,decode:s}=M1(r,t);return Ho({prefix:o,name:t,encode:n,decode:c=>ep(s(c))})},F1=(o,t,r,n)=>{const s={};for(let w=0;w<t.length;++w)s[t[w]]=w;let c=o.length;for(;o[c-1]==="=";)--c;const l=new Uint8Array(c*r/8|0);let g=0,v=0,p=0;for(let w=0;w<c;++w){const x=s[o[w]];if(x===void 0)throw new SyntaxError(`Non-${n} character`);v=v<<r|x,g+=r,g>=8&&(g-=8,l[p++]=255&v>>g)}if(g>=r||255&v<<8-g)throw new SyntaxError("Unexpected end of data");return l},V1=(o,t,r)=>{const n=t[t.length-1]==="=",s=(1<<r)-1;let c="",l=0,g=0;for(let v=0;v<o.length;++v)for(g=g<<8|o[v],l+=8;l>r;)l-=r,c+=t[s&g>>l];if(l&&(c+=t[s&g<<r-l]),n)for(;c.length*r&7;)c+="=";return c},Kt=({name:o,prefix:t,bitsPerChar:r,alphabet:n})=>Ho({prefix:t,name:o,encode(s){return V1(s,n,r)},decode(s){return F1(s,n,r,o)}}),G1=Ho({prefix:"\0",name:"identity",encode:o=>U1(o),decode:o=>z1(o)});var W1=Object.freeze({__proto__:null,identity:G1});const J1=Kt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Q1=Object.freeze({__proto__:null,base2:J1});const Y1=Kt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Z1=Object.freeze({__proto__:null,base8:Y1});const X1=ls({prefix:"9",name:"base10",alphabet:"0123456789"});var eE=Object.freeze({__proto__:null,base10:X1});const tE=Kt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),rE=Kt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var iE=Object.freeze({__proto__:null,base16:tE,base16upper:rE});const nE=Kt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),sE=Kt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),oE=Kt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),aE=Kt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),cE=Kt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),uE=Kt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),hE=Kt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),lE=Kt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),fE=Kt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var pE=Object.freeze({__proto__:null,base32:nE,base32upper:sE,base32pad:oE,base32padupper:aE,base32hex:cE,base32hexupper:uE,base32hexpad:hE,base32hexpadupper:lE,base32z:fE});const dE=ls({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),gE=ls({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var yE=Object.freeze({__proto__:null,base36:dE,base36upper:gE});const vE=ls({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),mE=ls({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var wE=Object.freeze({__proto__:null,base58btc:vE,base58flickr:mE});const _E=Kt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),bE=Kt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),EE=Kt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),IE=Kt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var xE=Object.freeze({__proto__:null,base64:_E,base64pad:bE,base64url:EE,base64urlpad:IE});const rp=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),PE=rp.reduce((o,t,r)=>(o[r]=t,o),[]),SE=rp.reduce((o,t,r)=>(o[t.codePointAt(0)]=r,o),[]);function OE(o){return o.reduce((t,r)=>(t+=PE[r],t),"")}function RE(o){const t=[];for(const r of o){const n=SE[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const AE=Ho({prefix:"🚀",name:"base256emoji",encode:OE,decode:RE});var TE=Object.freeze({__proto__:null,base256emoji:AE}),CE=ip,Dl=128,$E=127,NE=~$E,DE=Math.pow(2,31);function ip(o,t,r){t=t||[],r=r||0;for(var n=r;o>=DE;)t[r++]=o&255|Dl,o/=128;for(;o&NE;)t[r++]=o&255|Dl,o>>>=7;return t[r]=o|0,ip.bytes=r-n+1,t}var LE=zc,jE=128,Ll=127;function zc(o,n){var r=0,n=n||0,s=0,c=n,l,g=o.length;do{if(c>=g)throw zc.bytes=0,new RangeError("Could not decode varint");l=o[c++],r+=s<28?(l&Ll)<<s:(l&Ll)*Math.pow(2,s),s+=7}while(l>=jE);return zc.bytes=c-n,r}var qE=Math.pow(2,7),ME=Math.pow(2,14),zE=Math.pow(2,21),UE=Math.pow(2,28),HE=Math.pow(2,35),kE=Math.pow(2,42),KE=Math.pow(2,49),BE=Math.pow(2,56),FE=Math.pow(2,63),VE=function(o){return o<qE?1:o<ME?2:o<zE?3:o<UE?4:o<HE?5:o<kE?6:o<KE?7:o<BE?8:o<FE?9:10},GE={encode:CE,decode:LE,encodingLength:VE},np=GE;const jl=(o,t,r=0)=>(np.encode(o,t,r),t),ql=o=>np.encodingLength(o),Uc=(o,t)=>{const r=t.byteLength,n=ql(o),s=n+ql(r),c=new Uint8Array(s+r);return jl(o,c,0),jl(r,c,n),c.set(t,s),new WE(o,r,t,c)};class WE{constructor(t,r,n,s){this.code=t,this.size=r,this.digest=n,this.bytes=s}}const sp=({name:o,code:t,encode:r})=>new JE(o,t,r);class JE{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Uc(this.code,r):r.then(n=>Uc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const op=o=>async t=>new Uint8Array(await crypto.subtle.digest(o,t)),QE=sp({name:"sha2-256",code:18,encode:op("SHA-256")}),YE=sp({name:"sha2-512",code:19,encode:op("SHA-512")});var ZE=Object.freeze({__proto__:null,sha256:QE,sha512:YE});const ap=0,XE="identity",cp=ep,eI=o=>Uc(ap,cp(o)),tI={code:ap,name:XE,encode:cp,digest:eI};var rI=Object.freeze({__proto__:null,identity:tI});new TextEncoder,new TextDecoder;const Ml={...W1,...Q1,...Z1,...eE,...iE,...pE,...yE,...wE,...xE,...TE};({...ZE,...rI});function up(o){return globalThis.Buffer!=null?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):o}function iI(o=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?up(globalThis.Buffer.allocUnsafe(o)):new Uint8Array(o)}function hp(o,t,r,n){return{name:o,prefix:t,encoder:{name:o,prefix:t,encode:r},decoder:{decode:n}}}const zl=hp("utf8","u",o=>"u"+new TextDecoder("utf8").decode(o),o=>new TextEncoder().encode(o.substring(1))),_c=hp("ascii","a",o=>{let t="a";for(let r=0;r<o.length;r++)t+=String.fromCharCode(o[r]);return t},o=>{o=o.substring(1);const t=iI(o.length);for(let r=0;r<o.length;r++)t[r]=o.charCodeAt(r);return t}),nI={utf8:zl,"utf-8":zl,hex:Ml.base16,latin1:_c,ascii:_c,binary:_c,...Ml};function sI(o,t="utf8"){const r=nI[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?up(globalThis.Buffer.from(o,"utf-8")):r.decoder.decode(`${r.prefix}${o}`)}const lp="wc",oI=2,eu="core",xi=`${lp}@2:${eu}:`,aI={name:eu,logger:"error"},cI={database:":memory:"},uI="crypto",Ul="client_ed25519_seed",hI=re.ONE_DAY,lI="keychain",fI="0.3",pI="messages",dI="0.3",gI=re.SIX_HOURS,yI="publisher",fp="irn",vI="error",pp="wss://relay.walletconnect.com",Hl="wss://relay.walletconnect.org",mI="relayer",Gt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},wI="_subscription",ai={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},_I=re.ONE_SECOND,bI="2.11.0",EI=1e4,II="0.3",xI="WALLETCONNECT_CLIENT_ID",jr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},PI="subscription",SI="0.3",OI=re.FIVE_SECONDS*1e3,RI="pairing",AI="0.3",Vn={wc_pairingDelete:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:re.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:re.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:re.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:re.ONE_DAY,prompt:!1,tag:0},res:{ttl:re.ONE_DAY,prompt:!1,tag:0}}},Zn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Fr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},TI="history",CI="0.3",$I="expirer",Or={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},NI="0.3",bc="verify-api",_n="https://verify.walletconnect.com",Hc="https://verify.walletconnect.org",DI=[_n,Hc],LI="echo",jI="https://echo.walletconnect.com";class qI{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=lI,this.version=fI,this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,s)=>{this.isInitialized(),this.keychain.set(n,s),await this.persist()},this.get=n=>{this.isInitialized();const s=this.keychain.get(n);if(typeof s>"u"){const{message:c}=G("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(c)}return s},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=lr(r,this.name)}get context(){return hr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,xf(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Pf(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class MI{constructor(t,r,n){this.core=t,this.logger=r,this.name=uI,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=s=>(this.isInitialized(),this.keychain.has(s)),this.getClientId=async()=>{this.isInitialized();const s=await this.getClientSeed(),c=Pl(s);return Ff(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const s=rw();return this.setPrivateKey(s.publicKey,s.privateKey)},this.signJWT=async s=>{this.isInitialized();const c=await this.getClientSeed(),l=Pl(c),g=Ac();return await Ub(g,s,hI,l)},this.generateSharedKey=(s,c,l)=>{this.isInitialized();const g=this.getPrivateKey(s),v=iw(g,c);return this.setSymKey(v,l)},this.setSymKey=async(s,c)=>{this.isInitialized();const l=c||nw(s);return await this.keychain.set(l,s),l},this.deleteKeyPair=async s=>{this.isInitialized(),await this.keychain.del(s)},this.deleteSymKey=async s=>{this.isInitialized(),await this.keychain.del(s)},this.encode=async(s,c,l)=>{this.isInitialized();const g=sw(l),v=Fi(c);if(nl(g)){const T=g.senderPublicKey,D=g.receiverPublicKey;s=await this.generateSharedKey(T,D)}const p=this.getSymKey(s),{type:w,senderPublicKey:x}=g;return ow({type:w,symKey:p,message:v,senderPublicKey:x})},this.decode=async(s,c,l)=>{this.isInitialized();const g=aw(c,l);if(nl(g)){const v=g.receiverPublicKey,p=g.senderPublicKey;s=await this.generateSharedKey(v,p)}try{const v=this.getSymKey(s),p=cw({symKey:v,encoded:c});return cs(p)}catch(v){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(v)}},this.getPayloadType=s=>{const c=sl(s);return uw(c.type)},this.getPayloadSenderPublicKey=s=>{const c=sl(s);return c.senderPublicKey?No(c.senderPublicKey,hw):void 0},this.core=t,this.logger=lr(r,this.name),this.keychain=n||new qI(this.core,this.logger)}get context(){return hr(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Ul)}catch{t=Ac(),await this.keychain.set(Ul,t)}return sI(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class zI extends vb{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=pI,this.version=dI,this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,s)=>{this.isInitialized();const c=bn(s);let l=this.messages.get(n);return typeof l>"u"&&(l={}),typeof l[c]<"u"||(l[c]=s,this.messages.set(n,l),await this.persist()),c},this.get=n=>{this.isInitialized();let s=this.messages.get(n);return typeof s>"u"&&(s={}),s},this.has=(n,s)=>{this.isInitialized();const c=this.get(n),l=bn(s);return typeof c[l]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=lr(t,this.name),this.core=r}get context(){return hr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,xf(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Pf(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class UI extends mb{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new ur.EventEmitter,this.name=yI,this.queue=new Map,this.publishTimeout=re.toMiliseconds(re.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,s,c)=>{var l;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:c}});try{const g=(c==null?void 0:c.ttl)||gI,v=Tc(c),p=(c==null?void 0:c.prompt)||!1,w=(c==null?void 0:c.tag)||0,x=(c==null?void 0:c.id)||Zc().toString(),T={topic:n,message:s,opts:{ttl:g,relay:v,prompt:p,tag:w,id:x}},D=setTimeout(()=>this.queue.set(x,T),this.publishTimeout);try{await await ts(this.rpcPublish(n,s,g,v,p,w,x),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(x),this.relayer.events.emit(Gt.publish,T)}catch(A){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(l=c==null?void 0:c.internal)!=null&&l.throwOnFailedPublish)throw this.removeRequestFromQueue(x),A;return}finally{clearTimeout(D)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:c}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.relayer=t,this.logger=lr(r,this.name),this.registerEventListeners()}get context(){return hr(this.logger)}rpcPublish(t,r,n,s,c,l,g){var v,p,w,x;const T={method:xo(s.protocol).publish,params:{topic:t,message:r,ttl:n,prompt:c,tag:l},id:g};return Ii((v=T.params)==null?void 0:v.prompt)&&((p=T.params)==null||delete p.prompt),Ii((w=T.params)==null?void 0:w.tag)&&((x=T.params)==null||delete x.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:T}),this.relayer.request(T)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:n,opts:s}=t;await this.publish(r,n,s)})}registerEventListeners(){this.relayer.core.heartbeat.on(xn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Gt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Gt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class HI{constructor(){this.map=new Map,this.set=(t,r)=>{const n=this.get(t);this.exists(t,r)||this.map.set(t,[...n,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,r))return;const s=n.filter(c=>c!==r);if(!s.length){this.map.delete(t);return}this.map.set(t,s)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var kI=Object.defineProperty,KI=Object.defineProperties,BI=Object.getOwnPropertyDescriptors,kl=Object.getOwnPropertySymbols,FI=Object.prototype.hasOwnProperty,VI=Object.prototype.propertyIsEnumerable,Kl=(o,t,r)=>t in o?kI(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,Gn=(o,t)=>{for(var r in t||(t={}))FI.call(t,r)&&Kl(o,r,t[r]);if(kl)for(var r of kl(t))VI.call(t,r)&&Kl(o,r,t[r]);return o},Ec=(o,t)=>KI(o,BI(t));class GI extends bb{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new HI,this.events=new ur.EventEmitter,this.name=PI,this.version=SI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=xi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,s)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}});try{const c=Tc(s),l={topic:n,relay:c};this.pending.set(n,l);const g=await this.rpcSubscribe(n,c);return this.onSubscribe(g,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}}),g}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(n,s)=>{await this.restartToComplete(),this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(n,s.id,s):await this.unsubscribeByTopic(n,s)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((s,c)=>{const l=new re.Watch;l.start(this.pendingSubscriptionWatchLabel);const g=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(g),l.stop(this.pendingSubscriptionWatchLabel),s(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=OI&&(clearInterval(g),l.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=lr(r,this.name),this.clientId=""}get context(){return hr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let n=!1;try{n=this.getSubscription(t).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const n=this.topicMap.get(t);await Promise.all(n.map(async s=>await this.unsubscribeById(t,s,r)))}async unsubscribeById(t,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}});try{const s=Tc(n);await this.rpcUnsubscribe(t,r,s);const c=Vt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(t,r){const n={method:xo(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await ts(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Gt.connection_stalled)}return bn(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,n={method:xo(r.protocol).batchSubscribe,params:{topics:t.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await ts(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Gt.connection_stalled)}}rpcUnsubscribe(t,r,n){const s={method:xo(n.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(t,r){this.setSubscription(t,Ec(Gn({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,Gn({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,Gn({},r)),this.topicMap.set(r.topic,t),this.events.emit(jr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(jr.deleted,Ec(Gn({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(jr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(jr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);In(r)&&this.onBatchSubscribe(r.map((n,s)=>Ec(Gn({},t[s]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(xn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Gt.connect,async()=>{await this.onConnect()}),this.relayer.on(Gt.disconnect,()=>{this.onDisconnect()}),this.events.on(jr.created,async t=>{const r=jr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(jr.deleted,async t=>{const r=jr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var WI=Object.defineProperty,Bl=Object.getOwnPropertySymbols,JI=Object.prototype.hasOwnProperty,QI=Object.prototype.propertyIsEnumerable,Fl=(o,t,r)=>t in o?WI(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,YI=(o,t)=>{for(var r in t||(t={}))JI.call(t,r)&&Fl(o,r,t[r]);if(Bl)for(var r of Bl(t))QI.call(t,r)&&Fl(o,r,t[r]);return o};class ZI extends wb{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new ur.EventEmitter,this.name=mI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Gt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Gt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(ai.payload,this.onPayloadHandler),this.provider.on(ai.connect,this.onConnectHandler),this.provider.on(ai.disconnect,this.onDisconnectHandler),this.provider.on(ai.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?lr(t.logger,this.name):qo(Mo({level:t.logger||vI})),this.messages=new zI(this.logger,t.core),this.subscriber=new GI(this,this.logger),this.publisher=new UI(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||pp,this.projectId=t.projectId,this.bundleId=lw(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Hl}...`),await this.restartTransport(Hl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},EI)}get context(){return hr(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,n){this.isInitialized(),await this.publisher.publish(t,r,n),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var n;this.isInitialized();let s=((n=this.subscriber.topicMap.get(t))==null?void 0:n[0])||"";if(s)return s;let c;const l=g=>{g.topic===t&&(this.subscriber.off(jr.created,l),c())};return await Promise.all([new Promise(g=>{c=g,this.subscriber.on(jr.created,l)}),new Promise(async g=>{s=await this.subscriber.subscribe(t,r),g()})]),s}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await ts(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(jr.resubscribed,()=>{r()})}),new Promise(async(r,n)=>{try{await ts(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(s){n(s);return}r()})])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.provider.events.emit(ai.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await ol())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new x1(new R1(fw({sdkVersion:bI,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:n}=t;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(t){const{topic:r,message:n}=t;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const s=this.messages.has(r,n);return s&&this.logger.debug(`Ignoring duplicate message: ${n}`),s}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Xc(t)){if(!t.method.endsWith(wI))return;const r=t.params,{topic:n,message:s,publishedAt:c}=r.data,l={topic:n,message:s,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(YI({type:"event",event:r.id},l)),this.events.emit(r.id,l),await this.acknowledgePayload(t),await this.onMessageEvent(l)}else hs(t)&&this.events.emit(Gt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Gt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=zo(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(ai.payload,this.onPayloadHandler),this.provider.off(ai.connect,this.onConnectHandler),this.provider.off(ai.disconnect,this.onDisconnectHandler),this.provider.off(ai.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Gt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await ol();pw(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Gt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},re.toMiliseconds(_I)))}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var XI=Object.defineProperty,Vl=Object.getOwnPropertySymbols,ex=Object.prototype.hasOwnProperty,tx=Object.prototype.propertyIsEnumerable,Gl=(o,t,r)=>t in o?XI(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,Wl=(o,t)=>{for(var r in t||(t={}))ex.call(t,r)&&Gl(o,r,t[r]);if(Vl)for(var r of Vl(t))tx.call(t,r)&&Gl(o,r,t[r]);return o};class ko extends _b{constructor(t,r,n,s=xi,c=void 0){super(t,r,n,s),this.core=t,this.logger=r,this.name=n,this.map=new Map,this.version=II,this.cached=[],this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!Ii(l)?this.map.set(this.getKey(l),l):ew(l)?this.map.set(l.id,l):tw(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)},this.set=async(l,g)=>{this.isInitialized(),this.map.has(l)?await this.update(l,g):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:g}),this.map.set(l,g),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(g=>Object.keys(l).every(v=>T1(g[v],l[v]))):this.values),this.update=async(l,g)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:g});const v=Wl(Wl({},this.getData(l)),g);this.map.set(l,v),await this.persist()},this.delete=async(l,g)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:g}),this.map.delete(l),await this.persist())},this.logger=lr(r,this.name),this.storagePrefix=s,this.getKey=c}get context(){return hr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class rx{constructor(t,r){this.core=t,this.logger=r,this.name=RI,this.version=AI,this.events=new Wc,this.initialized=!1,this.storagePrefix=xi,this.ignoredPayloadTypes=[bf],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=Ac(),s=await this.core.crypto.setSymKey(n),c=qr(re.FIVE_MINUTES),l={protocol:fp},g={topic:s,expiry:c,relay:l,active:!1},v=dw({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:n,relay:l});return await this.pairings.set(s,g),await this.core.relayer.subscribe(s),this.core.expirer.set(s,c),{topic:s,uri:v}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:s,symKey:c,relay:l}=al(n.uri);let g;if(this.pairings.keys.includes(s)&&(g=this.pairings.get(s),g.active))throw new Error(`Pairing already exists: ${s}. Please try again with a new connection URI.`);const v=qr(re.FIVE_MINUTES),p={topic:s,relay:l,expiry:v,active:!1};return await this.pairings.set(s,p),this.core.expirer.set(s,v),n.activatePairing&&await this.activate({topic:s}),this.events.emit(Zn.create,p),this.core.crypto.keychain.has(s)||(await this.core.crypto.setSymKey(c,s),await this.core.relayer.subscribe(s,{relay:l})),p},this.activate=async({topic:n})=>{this.isInitialized();const s=qr(re.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:s}),this.core.expirer.set(n,s)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:s}=n;if(this.pairings.keys.includes(s)){const c=await this.sendRequest(s,"wc_pairingPing",{}),{done:l,resolve:g,reject:v}=mn();this.events.once(Tt("pairing_ping",c),({error:p})=>{p?v(p):g()}),await l()}},this.updateExpiry=async({topic:n,expiry:s})=>{this.isInitialized(),await this.pairings.update(n,{expiry:s})},this.updateMetadata=async({topic:n,metadata:s})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:s})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:s}=n;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",Vt("USER_DISCONNECTED")),await this.deletePairing(s))},this.sendRequest=async(n,s,c)=>{const l=Bi(s,c),g=await this.core.crypto.encode(n,l),v=Vn[s].req;return this.core.history.set(n,l),this.core.relayer.publish(n,g,v),l.id},this.sendResult=async(n,s,c)=>{const l=zo(n,c),g=await this.core.crypto.encode(s,l),v=await this.core.history.get(s,n),p=Vn[v.request.method].res;await this.core.relayer.publish(s,g,p),await this.core.history.resolve(l)},this.sendError=async(n,s,c)=>{const l=Uo(n,c),g=await this.core.crypto.encode(s,l),v=await this.core.history.get(s,n),p=Vn[v.request.method]?Vn[v.request.method].res:Vn.unregistered_method.res;await this.core.relayer.publish(s,g,p),await this.core.history.resolve(l)},this.deletePairing=async(n,s)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Vt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),s?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(s=>Ei(s.expiry));await Promise.all(n.map(s=>this.deletePairing(s.topic)))},this.onRelayEventRequest=n=>{const{topic:s,payload:c}=n;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(s,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(s,c);default:return this.onUnknownRpcMethodRequest(s,c)}},this.onRelayEventResponse=async n=>{const{topic:s,payload:c}=n,l=(await this.core.history.get(s,c.id)).request.method;switch(l){case"wc_pairingPing":return this.onPairingPingResponse(s,c);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(n,s)=>{const{id:c}=s;try{this.isValidPing({topic:n}),await this.sendResult(c,n,!0),this.events.emit(Zn.ping,{id:c,topic:n})}catch(l){await this.sendError(c,n,l),this.logger.error(l)}},this.onPairingPingResponse=(n,s)=>{const{id:c}=s;setTimeout(()=>{ui(s)?this.events.emit(Tt("pairing_ping",c),{}):Rr(s)&&this.events.emit(Tt("pairing_ping",c),{error:s.error})},500)},this.onPairingDeleteRequest=async(n,s)=>{const{id:c}=s;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Zn.delete,{id:c,topic:n})}catch(l){await this.sendError(c,n,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(n,s)=>{const{id:c,method:l}=s;try{if(this.registeredMethods.includes(l))return;const g=Vt("WC_METHOD_UNSUPPORTED",l);await this.sendError(c,n,g),this.logger.error(g)}catch(g){await this.sendError(c,n,g),this.logger.error(g)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Vt("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{var s;if(!cr(n)){const{message:l}=G("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(l)}if(!gw(n.uri)){const{message:l}=G("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(l)}const c=al(n.uri);if(!((s=c==null?void 0:c.relay)!=null&&s.protocol)){const{message:l}=G("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(l)}if(!(c!=null&&c.symKey)){const{message:l}=G("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(l)}},this.isValidPing=async n=>{if(!cr(n)){const{message:c}=G("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(c)}const{topic:s}=n;await this.isValidPairingTopic(s)},this.isValidDisconnect=async n=>{if(!cr(n)){const{message:c}=G("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(c)}const{topic:s}=n;await this.isValidPairingTopic(s)},this.isValidPairingTopic=async n=>{if(!wn(n,!1)){const{message:s}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(s)}if(!this.pairings.keys.includes(n)){const{message:s}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(s)}if(Ei(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:s}=G("EXPIRED",`pairing topic: ${n}`);throw new Error(s)}},this.core=t,this.logger=lr(r,this.name),this.pairings=new ko(this.core,this.logger,this.name,this.storagePrefix)}get context(){return hr(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Gt.message,async t=>{const{topic:r,message:n}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const s=await this.core.crypto.decode(r,n);try{Xc(s)?(this.core.history.set(r,s),this.onRelayEventRequest({topic:r,payload:s})):hs(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:r,payload:s}),this.core.history.delete(r,s.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Or.expired,async t=>{const{topic:r}=Ef(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(Zn.expire,{topic:r}))})}}class ix extends yb{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new ur.EventEmitter,this.name=TI,this.version=CI,this.cached=[],this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,s,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:s,chainId:c}),this.records.has(s.id))return;const l={id:s.id,topic:n,request:{method:s.method,params:s.params||null},chainId:c,expiry:qr(re.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(Fr.created,l)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const s=await this.getRecord(n.id);typeof s.response>"u"&&(s.response=Rr(n)?{error:n.error}:{result:n.result},this.records.set(s.id,s),this.events.emit(Fr.updated,s))},this.get=async(n,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:s}),await this.getRecord(s)),this.delete=(n,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(c=>{if(c.topic===n){if(typeof s<"u"&&c.id!==s)return;this.records.delete(c.id),this.events.emit(Fr.deleted,c)}})},this.exists=async(n,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===n:!1),this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.logger=lr(r,this.name)}get context(){return hr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:Bi(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Fr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Fr.created,t=>{const r=Fr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Fr.updated,t=>{const r=Fr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Fr.deleted,t=>{const r=Fr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(xn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{re.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class nx extends Eb{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new ur.EventEmitter,this.name=$I,this.version=NI,this.cached=[],this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const s=this.formatTarget(n);return typeof this.getExpiration(s)<"u"}catch{return!1}},this.set=(n,s)=>{this.isInitialized();const c=this.formatTarget(n),l={target:c,expiry:s};this.expirations.set(c,l),this.checkExpiry(c,l),this.events.emit(Or.created,{target:c,expiration:l})},this.get=n=>{this.isInitialized();const s=this.formatTarget(n);return this.getExpiration(s)},this.del=n=>{if(this.isInitialized(),this.has(n)){const s=this.formatTarget(n),c=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Or.deleted,{target:s,expiration:c})}},this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.logger=lr(r,this.name)}get context(){return hr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return yw(t);if(typeof t=="number")return vw(t);const{message:r}=G("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Or.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(t,r){const{expiry:n}=r;re.toMiliseconds(n)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Or.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(xn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Or.created,t=>{const r=Or.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Or.expired,t=>{const r=Or.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Or.deleted,t=>{const r=Or.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class sx extends Ib{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=bc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||mw()||!If())return;const s=this.getVerifyUrl(n==null?void 0:n.verifyUrl);this.verifyUrl!==s&&this.removeIframe(),this.verifyUrl=s;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Hc;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const s=this.getVerifyUrl(n==null?void 0:n.verifyUrl);let c;try{c=await this.fetchAttestation(n.attestationId,s)}catch(l){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${s}`),this.logger.info(l),c=await this.fetchAttestation(n.attestationId,Hc)}return c},this.fetchAttestation=async(n,s)=>{this.logger.info(`resolving attestation: ${n} from url: ${s}`);const c=this.startAbortTimer(re.ONE_SECOND*2),l=await fetch(`${s}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(c),l.status===200?await l.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var s;try{if(!this.iframe)return;(s=this.iframe.contentWindow)==null||s.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const s=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",s),n())};await Promise.race([new Promise(c=>{if(document.getElementById(bc))return c();window.addEventListener("message",s);const l=document.createElement("iframe");l.id=bc,l.src=`${this.verifyUrl}/${this.projectId}`,l.style.display="none",document.body.append(l),this.iframe=l,n=c}),new Promise((c,l)=>setTimeout(()=>{window.removeEventListener("message",s),l("verify iframe load timeout")},re.toMiliseconds(re.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=n=>{let s=n||_n;return DI.includes(s)||(this.logger.info(`verify url: ${s}, not included in trusted list, assigning default: ${_n}`),s=_n),s},this.logger=lr(r,this.name),this.verifyUrl=_n,this.abortController=new AbortController,this.isDevEnv=ww()&&L1.IS_VITEST}get context(){return hr(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),re.toMiliseconds(t))}}class ox extends xb{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.context=LI,this.registerDeviceToken=async n=>{const{clientId:s,token:c,notificationType:l,enableEncrypted:g=!1}=n,v=`${jI}/${this.projectId}/clients`;await D1(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:l,token:c,always_raw:g})})},this.logger=lr(r,this.context)}}var ax=Object.defineProperty,Jl=Object.getOwnPropertySymbols,cx=Object.prototype.hasOwnProperty,ux=Object.prototype.propertyIsEnumerable,Ql=(o,t,r)=>t in o?ax(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,Yl=(o,t)=>{for(var r in t||(t={}))cx.call(t,r)&&Ql(o,r,t[r]);if(Jl)for(var r of Jl(t))ux.call(t,r)&&Ql(o,r,t[r]);return o};class tu extends gb{constructor(t){super(t),this.protocol=lp,this.version=oI,this.name=eu,this.events=new ur.EventEmitter,this.initialized=!1,this.on=(n,s)=>this.events.on(n,s),this.once=(n,s)=>this.events.once(n,s),this.off=(n,s)=>this.events.off(n,s),this.removeListener=(n,s)=>this.events.removeListener(n,s),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||pp,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:qo(Mo({level:(t==null?void 0:t.logger)||aI.logger}));this.logger=lr(r,this.name),this.heartbeat=new xn.HeartBeat,this.crypto=new MI(this,this.logger,t==null?void 0:t.keychain),this.history=new ix(this,this.logger),this.expirer=new nx(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new m_(Yl(Yl({},cI),t==null?void 0:t.storageOptions)),this.relayer=new ZI({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new rx(this,this.logger),this.verify=new sx(this.projectId||"",this.logger),this.echoClient=new ox(this.projectId||"",this.logger)}static async init(t){const r=new tu(t);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(xI,n),r}get context(){return hr(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const hx=tu,dp="wc",gp=2,yp="client",ru=`${dp}@${gp}:${yp}:`,Ic={name:yp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Zl="WALLETCONNECT_DEEPLINK_CHOICE",lx="proposal",vp="Proposal expired",fx="session",bo=re.SEVEN_DAYS,px="engine",Wn={wc_sessionPropose:{req:{ttl:re.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1104},res:{ttl:re.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1106},res:{ttl:re.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:re.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:re.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1112},res:{ttl:re.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:re.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:re.THIRTY_SECONDS,prompt:!1,tag:1115}}},xc={min:re.FIVE_MINUTES,max:re.SEVEN_DAYS},ci={idle:"IDLE",active:"ACTIVE"},dx="request",gx=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var yx=Object.defineProperty,vx=Object.defineProperties,mx=Object.getOwnPropertyDescriptors,Xl=Object.getOwnPropertySymbols,wx=Object.prototype.hasOwnProperty,_x=Object.prototype.propertyIsEnumerable,ef=(o,t,r)=>t in o?yx(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,or=(o,t)=>{for(var r in t||(t={}))wx.call(t,r)&&ef(o,r,t[r]);if(Xl)for(var r of Xl(t))_x.call(t,r)&&ef(o,r,t[r]);return o},Jn=(o,t)=>vx(o,mx(t));class bx extends Sb{constructor(t){super(t),this.name=px,this.events=new Wc,this.initialized=!1,this.ignoredPayloadTypes=[bf],this.requestQueue={state:ci.idle,queue:[]},this.sessionRequestQueue={state:ci.idle,queue:[]},this.requestQueueDelay=re.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Wn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},re.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const n=Jn(or({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:s,requiredNamespaces:c,optionalNamespaces:l,sessionProperties:g,relays:v}=n;let p=s,w,x=!1;if(p&&(x=this.client.core.pairing.pairings.get(p).active),!p||!x){const{topic:oe,uri:te}=await this.client.core.pairing.create();p=oe,w=te}const T=await this.client.core.crypto.generateKeyPair(),D=or({requiredNamespaces:c,optionalNamespaces:l,relays:v??[{protocol:fp}],proposer:{publicKey:T,metadata:this.client.metadata}},g&&{sessionProperties:g}),{reject:A,resolve:J,done:ee}=mn(re.FIVE_MINUTES,vp);if(this.events.once(Tt("session_connect"),async({error:oe,session:te})=>{if(oe)A(oe);else if(te){te.self.publicKey=T;const he=Jn(or({},te),{requiredNamespaces:te.requiredNamespaces,optionalNamespaces:te.optionalNamespaces});await this.client.session.set(te.topic,he),await this.setExpiry(te.topic,te.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:te.peer.metadata}),J(he)}}),!p){const{message:oe}=G("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(oe)}const ce=await this.sendRequest({topic:p,method:"wc_sessionPropose",params:D}),ae=qr(re.FIVE_MINUTES);return await this.setProposal(ce,or({id:ce,expiry:ae},D)),{uri:w,approval:ee}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:s,namespaces:c,sessionProperties:l}=r,g=this.client.proposal.get(n);let{pairingTopic:v,proposer:p,requiredNamespaces:w,optionalNamespaces:x}=g;v=v||"",Po(w)||(w=bw(c,"approve()"));const T=await this.client.core.crypto.generateKeyPair(),D=p.publicKey,A=await this.client.core.crypto.generateSharedKey(T,D);v&&n&&(await this.client.core.pairing.updateMetadata({topic:v,metadata:p.metadata}),await this.sendResult({id:n,topic:v,result:{relay:{protocol:s??"irn"},responderPublicKey:T}}),await this.client.proposal.delete(n,Vt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:v}));const J=or({relay:{protocol:s??"irn"},namespaces:c,requiredNamespaces:w,optionalNamespaces:x,pairingTopic:v,controller:{publicKey:T,metadata:this.client.metadata},expiry:qr(bo)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(A),await this.sendRequest({topic:A,method:"wc_sessionSettle",params:J,throwOnFailedPublish:!0});const ee=Jn(or({},J),{topic:A,pairingTopic:v,acknowledged:!1,self:J.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:T});return await this.client.session.set(A,ee),await this.setExpiry(A,qr(bo)),{topic:A,acknowledged:()=>new Promise(ce=>setTimeout(()=>ce(this.client.session.get(A)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:n,reason:s}=r,{pairingTopic:c}=this.client.proposal.get(n);c&&(await this.sendError(n,c,s),await this.client.proposal.delete(n,Vt("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:s}=r,c=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:s}}),{done:l,resolve:g,reject:v}=mn();return this.events.once(Tt("session_update",c),({error:p})=>{p?v(p):g()}),await this.client.session.update(n,{namespaces:s}),{acknowledged:l}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,s=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:c,resolve:l,reject:g}=mn();return this.events.once(Tt("session_extend",s),({error:v})=>{v?g(v):l()}),await this.setExpiry(n,qr(bo)),{acknowledged:c}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:s,topic:c,expiry:l}=r,g=Yc(),{done:v,resolve:p,reject:w}=mn(l,"Request expired. Please try again.");return this.events.once(Tt("session_request",g),({error:x,result:T})=>{x?w(x):p(T)}),await Promise.all([new Promise(async x=>{await this.sendRequest({clientRpcId:g,topic:c,method:"wc_sessionRequest",params:{request:s,chainId:n},expiry:l,throwOnFailedPublish:!0}).catch(T=>w(T)),this.client.events.emit("session_request_sent",{topic:c,request:s,chainId:n,id:g}),x()}),new Promise(async x=>{const T=await Ew(this.client.core.storage,Zl);Iw({id:g,topic:c,wcDeepLink:T}),x()}),v()]).then(x=>x[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:s}=r,{id:c}=s;ui(s)?await this.sendResult({id:c,topic:n,result:s.result,throwOnFailedPublish:!0}):Rr(s)&&await this.sendError(c,n,s.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const s=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:c,resolve:l,reject:g}=mn();this.events.once(Tt("session_ping",s),({error:v})=>{v?g(v):l()}),await c()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:s,chainId:c}=r;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:s,chainId:c}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:Vt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>xw(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(c=>{var l,g;return((l=c.peerMetadata)==null?void 0:l.url)&&((g=c.peerMetadata)==null?void 0:g.url)===r.peer.metadata.url&&c.topic&&c.topic!==n.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(r,n)=>{const{self:s}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Vt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(s.publicKey)&&await this.client.core.crypto.deleteKeyPair(s.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r),this.client.core.storage.removeItem(Zl).catch(c=>this.client.logger.warn(c)),this.getPendingSessionRequests().forEach(c=>{c.topic===r&&this.deletePendingSessionRequest(c.id,Vt("USER_DISCONNECTED"))})},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,Vt("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),s?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==r),s&&(this.sessionRequestQueue.state=ci.idle)},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=Wn.wc_sessionRequest.req.ttl,{id:s,topic:c,params:l,verifyContext:g}=r;await this.client.pendingRequest.set(s,{id:s,topic:c,params:l,verifyContext:g}),n&&this.client.core.expirer.set(s,qr(n))},this.sendRequest=async r=>{const{topic:n,method:s,params:c,expiry:l,relayRpcId:g,clientRpcId:v,throwOnFailedPublish:p}=r,w=Bi(s,c,v);if(If()&&gx.includes(s)){const D=bn(JSON.stringify(w));this.client.core.verify.register({attestationId:D})}const x=await this.client.core.crypto.encode(n,w),T=Wn[s].req;return l&&(T.ttl=l),g&&(T.id=g),this.client.core.history.set(n,w),p?(T.internal=Jn(or({},T.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,x,T)):this.client.core.relayer.publish(n,x,T).catch(D=>this.client.logger.error(D)),w.id},this.sendResult=async r=>{const{id:n,topic:s,result:c,throwOnFailedPublish:l}=r,g=zo(n,c),v=await this.client.core.crypto.encode(s,g),p=await this.client.core.history.get(s,n),w=Wn[p.request.method].res;l?(w.internal=Jn(or({},w.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,v,w)):this.client.core.relayer.publish(s,v,w).catch(x=>this.client.logger.error(x)),await this.client.core.history.resolve(g)},this.sendError=async(r,n,s)=>{const c=Uo(r,s),l=await this.client.core.crypto.encode(n,c),g=await this.client.core.history.get(n,r),v=Wn[g.request.method].res;this.client.core.relayer.publish(n,l,v),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(s=>{Ei(s.expiry)&&r.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{Ei(s.expiry)&&n.push(s.id)}),await Promise.all([...r.map(s=>this.deleteSession(s)),...n.map(s=>this.deleteProposal(s))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===ci.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ci.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=ci.idle},this.processRequest=r=>{const{topic:n,payload:s}=r,c=s.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(n,s);case"wc_sessionSettle":return this.onSessionSettleRequest(n,s);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,s);case"wc_sessionExtend":return this.onSessionExtendRequest(n,s);case"wc_sessionPing":return this.onSessionPingRequest(n,s);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,s);case"wc_sessionRequest":return this.onSessionRequest(n,s);case"wc_sessionEvent":return this.onSessionEventRequest(n,s);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:s}=r,c=(await this.client.core.history.get(n,s.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(n,s);case"wc_sessionSettle":return this.onSessionSettleResponse(n,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,s);case"wc_sessionExtend":return this.onSessionExtendResponse(n,s);case"wc_sessionPing":return this.onSessionPingResponse(n,s);case"wc_sessionRequest":return this.onSessionRequestResponse(n,s);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:n}=r,{message:s}=G("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)},this.onSessionProposeRequest=async(r,n)=>{const{params:s,id:c}=n;try{this.isValidConnect(or({},n.params));const l=qr(re.FIVE_MINUTES),g=or({id:c,pairingTopic:r,expiry:l},s);await this.setProposal(c,g);const v=bn(JSON.stringify(n)),p=await this.getVerifyContext(v,g.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:g,verifyContext:p})}catch(l){await this.sendError(c,r,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(r,n)=>{const{id:s}=n;if(ui(n)){const{result:c}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const l=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const g=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});const v=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:v});const p=await this.client.core.crypto.generateSharedKey(g,v);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const w=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:w}),await this.client.core.pairing.activate({topic:r})}else Rr(n)&&(await this.client.proposal.delete(s,Vt("USER_DISCONNECTED")),this.events.emit(Tt("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:s,params:c}=n;try{this.isValidSessionSettleRequest(c);const{relay:l,controller:g,expiry:v,namespaces:p,requiredNamespaces:w,optionalNamespaces:x,sessionProperties:T,pairingTopic:D}=n.params,A=or({topic:r,relay:l,expiry:v,namespaces:p,acknowledged:!0,pairingTopic:D,requiredNamespaces:w,optionalNamespaces:x,controller:g.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:g.publicKey,metadata:g.metadata}},T&&{sessionProperties:T});await this.sendResult({id:n.id,topic:r,result:!0}),this.events.emit(Tt("session_connect"),{session:A}),this.cleanupDuplicatePairings(A)}catch(l){await this.sendError(s,r,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(r,n)=>{const{id:s}=n;ui(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Tt("session_approve",s),{})):Rr(n)&&(await this.client.session.delete(r,Vt("USER_DISCONNECTED")),this.events.emit(Tt("session_approve",s),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:s,id:c}=n;try{const l=`${r}_session_update`,g=mo.get(l);if(g&&this.isRequestOutOfSync(g,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(or({topic:r},s)),await this.client.session.update(r,{namespaces:s.namespaces}),await this.sendResult({id:c,topic:r,result:!0}),this.client.events.emit("session_update",{id:c,topic:r,params:s}),mo.set(l,c)}catch(l){await this.sendError(c,r,l),this.client.logger.error(l)}},this.isRequestOutOfSync=(r,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,n)=>{const{id:s}=n;ui(n)?this.events.emit(Tt("session_update",s),{}):Rr(n)&&this.events.emit(Tt("session_update",s),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:s}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,qr(bo)),await this.sendResult({id:s,topic:r,result:!0}),this.client.events.emit("session_extend",{id:s,topic:r})}catch(c){await this.sendError(s,r,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(r,n)=>{const{id:s}=n;ui(n)?this.events.emit(Tt("session_extend",s),{}):Rr(n)&&this.events.emit(Tt("session_extend",s),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:s}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:s,topic:r,result:!0}),this.client.events.emit("session_ping",{id:s,topic:r})}catch(c){await this.sendError(s,r,c),this.client.logger.error(c)}},this.onSessionPingResponse=(r,n)=>{const{id:s}=n;setTimeout(()=>{ui(n)?this.events.emit(Tt("session_ping",s),{}):Rr(n)&&this.events.emit(Tt("session_ping",s),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(Gt.publish,async()=>{c(await this.deleteSession(r))})}),this.sendResult({id:s,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:s,topic:r})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(r,n)=>{const{id:s,params:c}=n;try{this.isValidRequest(or({topic:r},c));const l=bn(JSON.stringify(Bi("wc_sessionRequest",c,s))),g=this.client.session.get(r),v=await this.getVerifyContext(l,g.peer.metadata),p={id:s,topic:r,params:c,verifyContext:v};await this.setPendingSessionRequest(p),this.addSessionRequestToSessionRequestQueue(p),this.processSessionRequestQueue()}catch(l){await this.sendError(s,r,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(r,n)=>{const{id:s}=n;ui(n)?this.events.emit(Tt("session_request",s),{result:n.result}):Rr(n)&&this.events.emit(Tt("session_request",s),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:s,params:c}=n;try{const l=`${r}_session_event_${c.event.name}`,g=mo.get(l);if(g&&this.isRequestOutOfSync(g,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(or({topic:r},c)),this.client.events.emit("session_event",{id:s,topic:r,params:c}),mo.set(l,s)}catch(l){await this.sendError(s,r,l),this.client.logger.error(l)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ci.idle,this.processSessionRequestQueue()},re.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===ci.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=ci.active,this.client.events.emit("session_request",r)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=r=>{if(r.active)return;const n=this.client.proposal.getAll().find(s=>s.pairingTopic===r.topic);n&&this.onSessionProposeRequest(r.topic,Bi("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties},n.id))},this.isValidConnect=async r=>{if(!cr(r)){const{message:v}=G("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(v)}const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:c,sessionProperties:l,relays:g}=r;if(Ii(n)||await this.isValidPairingTopic(n),!Pw(g)){const{message:v}=G("MISSING_OR_INVALID",`connect() relays: ${g}`);throw new Error(v)}!Ii(s)&&Po(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!Ii(c)&&Po(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),Ii(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(r,n)=>{const s=Sw(r,"connect()",n);if(s)throw new Error(s.message)},this.isValidApprove=async r=>{if(!cr(r))throw new Error(G("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:s,relayProtocol:c,sessionProperties:l}=r;await this.isValidProposalId(n);const g=this.client.proposal.get(n),v=pc(s,"approve()");if(v)throw new Error(v.message);const p=cl(g.requiredNamespaces,s,"approve()");if(p)throw new Error(p.message);if(!wn(c,!0)){const{message:w}=G("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(w)}Ii(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async r=>{if(!cr(r)){const{message:c}=G("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(c)}const{id:n,reason:s}=r;if(await this.isValidProposalId(n),!Ow(s)){const{message:c}=G("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(c)}},this.isValidSessionSettleRequest=r=>{if(!cr(r)){const{message:p}=G("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(p)}const{relay:n,controller:s,namespaces:c,expiry:l}=r;if(!Rw(n)){const{message:p}=G("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const g=Aw(s,"onSessionSettleRequest()");if(g)throw new Error(g.message);const v=pc(c,"onSessionSettleRequest()");if(v)throw new Error(v.message);if(Ei(l)){const{message:p}=G("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async r=>{if(!cr(r)){const{message:v}=G("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(v)}const{topic:n,namespaces:s}=r;await this.isValidSessionTopic(n);const c=this.client.session.get(n),l=pc(s,"update()");if(l)throw new Error(l.message);const g=cl(c.requiredNamespaces,s,"update()");if(g)throw new Error(g.message)},this.isValidExtend=async r=>{if(!cr(r)){const{message:s}=G("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(s)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!cr(r)){const{message:v}=G("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(v)}const{topic:n,request:s,chainId:c,expiry:l}=r;await this.isValidSessionTopic(n);const{namespaces:g}=this.client.session.get(n);if(!ul(g,c)){const{message:v}=G("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(v)}if(!Tw(s)){const{message:v}=G("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(v)}if(!Cw(g,c,s.method)){const{message:v}=G("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(v)}if(l&&!$w(l,xc)){const{message:v}=G("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${xc.min} and ${xc.max}`);throw new Error(v)}},this.isValidRespond=async r=>{var n;if(!cr(r)){const{message:l}=G("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(l)}const{topic:s,response:c}=r;try{await this.isValidSessionTopic(s)}catch(l){throw(n=r==null?void 0:r.response)!=null&&n.id&&this.cleanupAfterResponse(r),l}if(!Nw(c)){const{message:l}=G("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(l)}},this.isValidPing=async r=>{if(!cr(r)){const{message:s}=G("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(s)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!cr(r)){const{message:g}=G("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(g)}const{topic:n,event:s,chainId:c}=r;await this.isValidSessionTopic(n);const{namespaces:l}=this.client.session.get(n);if(!ul(l,c)){const{message:g}=G("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(g)}if(!Dw(s)){const{message:g}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(g)}if(!Lw(l,c,s.name)){const{message:g}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(g)}},this.isValidDisconnect=async r=>{if(!cr(r)){const{message:s}=G("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(s)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(r,n)=>{const s={verified:{verifyUrl:n.verifyUrl||_n,validation:"UNKNOWN",origin:n.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:r,verifyUrl:n.verifyUrl});c&&(s.verified.origin=c.origin,s.verified.isScam=c.isScam,s.verified.validation=c.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(s)}`),s},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(s=>{if(!wn(s,!1)){const{message:c}=G("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(s)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Gt.message,async t=>{const{topic:r,message:n}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const s=await this.client.core.crypto.decode(r,n);try{Xc(s)?(this.client.core.history.set(r,s),this.onRelayEventRequest({topic:r,payload:s})):hs(s)?(await this.client.core.history.resolve(s),await this.onRelayEventResponse({topic:r,payload:s}),this.client.core.history.delete(r,s.id)):this.onRelayEventUnknownPayload({topic:r,payload:s})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Or.expired,async t=>{const{topic:r,id:n}=Ef(t.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,G("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Zn.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!wn(t,!1)){const{message:r}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Ei(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=G("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!wn(t,!1)){const{message:r}=G("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=G("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Ei(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=G("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(wn(t,!1)){const{message:r}=G("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=G("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!jw(t)){const{message:r}=G("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=G("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Ei(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=G("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class Ex extends ko{constructor(t,r){super(t,r,lx,ru),this.core=t,this.logger=r}}class Ix extends ko{constructor(t,r){super(t,r,fx,ru),this.core=t,this.logger=r}}class xx extends ko{constructor(t,r){super(t,r,dx,ru,n=>n.id),this.core=t,this.logger=r}}let Px=class mp extends Pb{constructor(t){super(t),this.protocol=dp,this.version=gp,this.name=Ic.name,this.events=new ur.EventEmitter,this.on=(n,s)=>this.events.on(n,s),this.once=(n,s)=>this.events.once(n,s),this.off=(n,s)=>this.events.off(n,s),this.removeListener=(n,s)=>this.events.removeListener(n,s),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(s){throw this.logger.error(s.message),s}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(s){throw this.logger.error(s.message),s}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(s){throw this.logger.error(s.message),s}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(s){throw this.logger.error(s.message),s}},this.update=async n=>{try{return await this.engine.update(n)}catch(s){throw this.logger.error(s.message),s}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(s){throw this.logger.error(s.message),s}},this.request=async n=>{try{return await this.engine.request(n)}catch(s){throw this.logger.error(s.message),s}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(s){throw this.logger.error(s.message),s}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(s){throw this.logger.error(s.message),s}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(s){throw this.logger.error(s.message),s}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(s){throw this.logger.error(s.message),s}},this.find=n=>{try{return this.engine.find(n)}catch(s){throw this.logger.error(s.message),s}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(t==null?void 0:t.name)||Ic.name,this.metadata=(t==null?void 0:t.metadata)||_w();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:qo(Mo({level:(t==null?void 0:t.logger)||Ic.logger}));this.core=(t==null?void 0:t.core)||new hx(t),this.logger=lr(r,this.name),this.session=new Ix(this.core,this.logger),this.proposal=new Ex(this.core,this.logger),this.pendingRequest=new xx(this.core,this.logger),this.engine=new bx(this)}static async init(t){const r=new mp(t);return await r.initialize(),r}get context(){return hr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var kc={exports:{}};(function(o,t){var r=typeof self<"u"?self:Mr,n=function(){function c(){this.fetch=!1,this.DOMException=r.DOMException}return c.prototype=r,new c}();(function(c){(function(l){var g={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function v(b){return b&&DataView.prototype.isPrototypeOf(b)}if(g.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],w=ArrayBuffer.isView||function(b){return b&&p.indexOf(Object.prototype.toString.call(b))>-1};function x(b){if(typeof b!="string"&&(b=String(b)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(b))throw new TypeError("Invalid character in header field name");return b.toLowerCase()}function T(b){return typeof b!="string"&&(b=String(b)),b}function D(b){var O={next:function(){var Q=b.shift();return{done:Q===void 0,value:Q}}};return g.iterable&&(O[Symbol.iterator]=function(){return O}),O}function A(b){this.map={},b instanceof A?b.forEach(function(O,Q){this.append(Q,O)},this):Array.isArray(b)?b.forEach(function(O){this.append(O[0],O[1])},this):b&&Object.getOwnPropertyNames(b).forEach(function(O){this.append(O,b[O])},this)}A.prototype.append=function(b,O){b=x(b),O=T(O);var Q=this.map[b];this.map[b]=Q?Q+", "+O:O},A.prototype.delete=function(b){delete this.map[x(b)]},A.prototype.get=function(b){return b=x(b),this.has(b)?this.map[b]:null},A.prototype.has=function(b){return this.map.hasOwnProperty(x(b))},A.prototype.set=function(b,O){this.map[x(b)]=T(O)},A.prototype.forEach=function(b,O){for(var Q in this.map)this.map.hasOwnProperty(Q)&&b.call(O,this.map[Q],Q,this)},A.prototype.keys=function(){var b=[];return this.forEach(function(O,Q){b.push(Q)}),D(b)},A.prototype.values=function(){var b=[];return this.forEach(function(O){b.push(O)}),D(b)},A.prototype.entries=function(){var b=[];return this.forEach(function(O,Q){b.push([Q,O])}),D(b)},g.iterable&&(A.prototype[Symbol.iterator]=A.prototype.entries);function J(b){if(b.bodyUsed)return Promise.reject(new TypeError("Already read"));b.bodyUsed=!0}function ee(b){return new Promise(function(O,Q){b.onload=function(){O(b.result)},b.onerror=function(){Q(b.error)}})}function ce(b){var O=new FileReader,Q=ee(O);return O.readAsArrayBuffer(b),Q}function ae(b){var O=new FileReader,Q=ee(O);return O.readAsText(b),Q}function oe(b){for(var O=new Uint8Array(b),Q=new Array(O.length),le=0;le<O.length;le++)Q[le]=String.fromCharCode(O[le]);return Q.join("")}function te(b){if(b.slice)return b.slice(0);var O=new Uint8Array(b.byteLength);return O.set(new Uint8Array(b)),O.buffer}function he(){return this.bodyUsed=!1,this._initBody=function(b){this._bodyInit=b,b?typeof b=="string"?this._bodyText=b:g.blob&&Blob.prototype.isPrototypeOf(b)?this._bodyBlob=b:g.formData&&FormData.prototype.isPrototypeOf(b)?this._bodyFormData=b:g.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)?this._bodyText=b.toString():g.arrayBuffer&&g.blob&&v(b)?(this._bodyArrayBuffer=te(b.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):g.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(b)||w(b))?this._bodyArrayBuffer=te(b):this._bodyText=b=Object.prototype.toString.call(b):this._bodyText="",this.headers.get("content-type")||(typeof b=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):g.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g.blob&&(this.blob=function(){var b=J(this);if(b)return b;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?J(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ce)}),this.text=function(){var b=J(this);if(b)return b;if(this._bodyBlob)return ae(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(oe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g.formData&&(this.formData=function(){return this.text().then(_t)}),this.json=function(){return this.text().then(JSON.parse)},this}var pe=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Y(b){var O=b.toUpperCase();return pe.indexOf(O)>-1?O:b}function ve(b,O){O=O||{};var Q=O.body;if(b instanceof ve){if(b.bodyUsed)throw new TypeError("Already read");this.url=b.url,this.credentials=b.credentials,O.headers||(this.headers=new A(b.headers)),this.method=b.method,this.mode=b.mode,this.signal=b.signal,!Q&&b._bodyInit!=null&&(Q=b._bodyInit,b.bodyUsed=!0)}else this.url=String(b);if(this.credentials=O.credentials||this.credentials||"same-origin",(O.headers||!this.headers)&&(this.headers=new A(O.headers)),this.method=Y(O.method||this.method||"GET"),this.mode=O.mode||this.mode||null,this.signal=O.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&Q)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(Q)}ve.prototype.clone=function(){return new ve(this,{body:this._bodyInit})};function _t(b){var O=new FormData;return b.trim().split("&").forEach(function(Q){if(Q){var le=Q.split("="),k=le.shift().replace(/\+/g," "),H=le.join("=").replace(/\+/g," ");O.append(decodeURIComponent(k),decodeURIComponent(H))}}),O}function st(b){var O=new A,Q=b.replace(/\r?\n[\t ]+/g," ");return Q.split(/\r?\n/).forEach(function(le){var k=le.split(":"),H=k.shift().trim();if(H){var K=k.join(":").trim();O.append(H,K)}}),O}he.call(ve.prototype);function Be(b,O){O||(O={}),this.type="default",this.status=O.status===void 0?200:O.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in O?O.statusText:"OK",this.headers=new A(O.headers),this.url=O.url||"",this._initBody(b)}he.call(Be.prototype),Be.prototype.clone=function(){return new Be(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new A(this.headers),url:this.url})},Be.error=function(){var b=new Be(null,{status:0,statusText:""});return b.type="error",b};var Mt=[301,302,303,307,308];Be.redirect=function(b,O){if(Mt.indexOf(O)===-1)throw new RangeError("Invalid status code");return new Be(null,{status:O,headers:{location:b}})},l.DOMException=c.DOMException;try{new l.DOMException}catch{l.DOMException=function(O,Q){this.message=O,this.name=Q;var le=Error(O);this.stack=le.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function zt(b,O){return new Promise(function(Q,le){var k=new ve(b,O);if(k.signal&&k.signal.aborted)return le(new l.DOMException("Aborted","AbortError"));var H=new XMLHttpRequest;function K(){H.abort()}H.onload=function(){var B={status:H.status,statusText:H.statusText,headers:st(H.getAllResponseHeaders()||"")};B.url="responseURL"in H?H.responseURL:B.headers.get("X-Request-URL");var et="response"in H?H.response:H.responseText;Q(new Be(et,B))},H.onerror=function(){le(new TypeError("Network request failed"))},H.ontimeout=function(){le(new TypeError("Network request failed"))},H.onabort=function(){le(new l.DOMException("Aborted","AbortError"))},H.open(k.method,k.url,!0),k.credentials==="include"?H.withCredentials=!0:k.credentials==="omit"&&(H.withCredentials=!1),"responseType"in H&&g.blob&&(H.responseType="blob"),k.headers.forEach(function(B,et){H.setRequestHeader(et,B)}),k.signal&&(k.signal.addEventListener("abort",K),H.onreadystatechange=function(){H.readyState===4&&k.signal.removeEventListener("abort",K)}),H.send(typeof k._bodyInit>"u"?null:k._bodyInit)})}return zt.polyfill=!0,c.fetch||(c.fetch=zt,c.Headers=A,c.Request=ve,c.Response=Be),l.Headers=A,l.Request=ve,l.Response=Be,l.fetch=zt,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var s=n;t=s.fetch,t.default=s.fetch,t.fetch=s.fetch,t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response,o.exports=t})(kc,kc.exports);var Sx=kc.exports;const tf=os(Sx);var Ox=Object.defineProperty,Rx=Object.defineProperties,Ax=Object.getOwnPropertyDescriptors,rf=Object.getOwnPropertySymbols,Tx=Object.prototype.hasOwnProperty,Cx=Object.prototype.propertyIsEnumerable,nf=(o,t,r)=>t in o?Ox(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,sf=(o,t)=>{for(var r in t||(t={}))Tx.call(t,r)&&nf(o,r,t[r]);if(rf)for(var r of rf(t))Cx.call(t,r)&&nf(o,r,t[r]);return o},of=(o,t)=>Rx(o,Ax(t));const $x={Accept:"application/json","Content-Type":"application/json"},Nx="POST",af={headers:$x,method:Nx},cf=10;let Si=class{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new ur.EventEmitter,this.isAvailable=!1,this.registering=!1,!Al(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t){this.isAvailable||await this.register();try{const r=Fi(t),n=await(await tf(this.url,of(sf({},af),{body:r}))).json();this.onPayload({data:n})}catch(r){this.onError(t.id,r)}}async register(t=this.url){if(!Al(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,s)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),s(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));n()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=Fi({id:1,jsonrpc:"2.0",method:"test",params:[]});await tf(t,of(sf({},af),{body:r}))}this.onOpen()}catch(r){const n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?cs(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),s=n.message||n.toString(),c=Uo(t,s);this.events.emit("payload",c)}parseError(t,r=this.url){return Wf(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>cf&&this.events.setMaxListeners(cf)}};class Oi extends Yf{constructor(t){super(t),this.events=new ur.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Bi(t.method,t.params||[],t.id||Zc().toString()),r)}async requestStrict(t,r){return new Promise(async(n,s)=>{if(!this.connection.connected)try{await this.open()}catch(c){s(c)}this.events.on(`${t.id}`,c=>{Rr(c)?s(c.error):n(c.result)});try{await this.connection.send(t,r)}catch(c){s(c)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),hs(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const uf="error",Dx="wss://relay.walletconnect.com",Lx="wc",jx="universal_provider",hf=`${Lx}@2:${jx}:`,qx="https://rpc.walletconnect.com/v1/",hi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Qn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Kc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(o,t){(function(){var r,n="4.17.21",s=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",g="Invalid `variable` option passed into `_.template`",v="__lodash_hash_undefined__",p=500,w="__lodash_placeholder__",x=1,T=2,D=4,A=1,J=2,ee=1,ce=2,ae=4,oe=8,te=16,he=32,pe=64,Y=128,ve=256,_t=512,st=30,Be="...",Mt=800,zt=16,b=1,O=2,Q=3,le=1/0,k=9007199254740991,H=17976931348623157e292,K=NaN,B=4294967295,et=B-1,ot=B>>>1,Ri=[["ary",Y],["bind",ee],["bindKey",ce],["curry",oe],["curryRight",te],["flip",_t],["partial",he],["partialRight",pe],["rearg",ve]],Ee="[object Arguments]",Ar="[object Array]",L="[object AsyncFunction]",N="[object Boolean]",C="[object Date]",h="[object DOMException]",I="[object Error]",Z="[object Function]",ue="[object GeneratorFunction]",me="[object Map]",Oe="[object Number]",Ae="[object Null]",Ie="[object Object]",bt="[object Promise]",gt="[object Proxy]",tt="[object RegExp]",Ce="[object Set]",Fe="[object String]",Ve="[object Symbol]",rt="[object Undefined]",Le="[object WeakMap]",Ge="[object WeakSet]",Re="[object ArrayBuffer]",Me="[object DataView]",at="[object Float32Array]",Ne="[object Float64Array]",Et="[object Int8Array]",Ct="[object Int16Array]",Ut="[object Int32Array]",Ht="[object Uint8Array]",Dt="[object Uint8ClampedArray]",Wt="[object Uint16Array]",er="[object Uint32Array]",zr=/\b__p \+= '';/g,Jt=/\b(__p \+=) '' \+/g,Gr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,li=/&(?:amp|lt|gt|quot|#39);/g,Ai=/[&<>"']/g,ct=RegExp(li.source),Qe=RegExp(Ai.source),ut=/<%-([\s\S]+?)%>/g,ht=/<%([\s\S]+?)%>/g,it=/<%=([\s\S]+?)%>/g,Ye=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,It=/^\w*$/,xt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,lt=/[\\^$.*+?()[\]{}|]/g,Pt=RegExp(lt.source),ft=/^\s+/,yt=/\s/,pt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ke=/\{\n\/\* \[wrapped with (.+)\] \*/,St=/,? & /,Ot=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ko=/[()=,{}\[\]\/\s]/,Bo=/\\(\\)?/g,Fo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,mr=/\w*$/,Vo=/^[-+]0x[0-9a-f]+$/i,Go=/^0b[01]+$/i,Wo=/^\[object .+?Constructor\]$/,Jo=/^0o[0-7]+$/i,Qo=/^(?:0|[1-9]\d*)$/,Wr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ji=/($^)/,Yo=/['\n\r\u2028\u2029\\]/g,Qi="\\ud800-\\udfff",Zo="\\u0300-\\u036f",Xo="\\ufe20-\\ufe2f",Yi="\\u20d0-\\u20ff",fs=Zo+Xo+Yi,ps="\\u2700-\\u27bf",Tr="a-z\\xdf-\\xf6\\xf8-\\xff",ea="\\xac\\xb1\\xd7\\xf7",ta="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ra="\\u2000-\\u206f",ia=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ds="A-Z\\xc0-\\xd6\\xd8-\\xde",gs="\\ufe0e\\ufe0f",Ti=ea+ta+ra+ia,Pn="['’]",Ci="["+Qi+"]",Sn="["+Ti+"]",$i="["+fs+"]",ys="\\d+",na="["+ps+"]",vs="["+Tr+"]",ms="[^"+Qi+Ti+ys+ps+Tr+ds+"]",Zi="\\ud83c[\\udffb-\\udfff]",sa="(?:"+$i+"|"+Zi+")",ws="[^"+Qi+"]",Xi="(?:\\ud83c[\\udde6-\\uddff]){2}",fi="[\\ud800-\\udbff][\\udc00-\\udfff]",fr="["+ds+"]",_s="\\u200d",bs="(?:"+vs+"|"+ms+")",Ur="(?:"+fr+"|"+ms+")",Es="(?:"+Pn+"(?:d|ll|m|re|s|t|ve))?",Is="(?:"+Pn+"(?:D|LL|M|RE|S|T|VE))?",xs=sa+"?",Ps="["+gs+"]?",oa="(?:"+_s+"(?:"+[ws,Xi,fi].join("|")+")"+Ps+xs+")*",Jr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ss="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Os=Ps+xs+oa,en="(?:"+[na,Xi,fi].join("|")+")"+Os,aa="(?:"+[ws+$i+"?",$i,Xi,fi,Ci].join("|")+")",On=RegExp(Pn,"g"),ca=RegExp($i,"g"),tn=RegExp(Zi+"(?="+Zi+")|"+aa+Os,"g"),Rs=RegExp([fr+"?"+vs+"+"+Es+"(?="+[Sn,fr,"$"].join("|")+")",Ur+"+"+Is+"(?="+[Sn,fr+bs,"$"].join("|")+")",fr+"?"+bs+"+"+Es,fr+"+"+Is,Ss,Jr,ys,en].join("|"),"g"),As=RegExp("["+_s+Qi+fs+gs+"]"),Ni=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ts=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ua=-1,ze={};ze[at]=ze[Ne]=ze[Et]=ze[Ct]=ze[Ut]=ze[Ht]=ze[Dt]=ze[Wt]=ze[er]=!0,ze[Ee]=ze[Ar]=ze[Re]=ze[N]=ze[Me]=ze[C]=ze[I]=ze[Z]=ze[me]=ze[Oe]=ze[Ie]=ze[tt]=ze[Ce]=ze[Fe]=ze[Le]=!1;var je={};je[Ee]=je[Ar]=je[Re]=je[Me]=je[N]=je[C]=je[at]=je[Ne]=je[Et]=je[Ct]=je[Ut]=je[me]=je[Oe]=je[Ie]=je[tt]=je[Ce]=je[Fe]=je[Ve]=je[Ht]=je[Dt]=je[Wt]=je[er]=!0,je[I]=je[Z]=je[Le]=!1;var m={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},P={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},z={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},V={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ue=parseFloat,de=parseInt,We=typeof Qn=="object"&&Qn&&Qn.Object===Object&&Qn,Rt=typeof self=="object"&&self&&self.Object===Object&&self,Pe=We||Rt||Function("return this")(),He=t&&!t.nodeType&&t,vt=He&&!0&&o&&!o.nodeType&&o,tr=vt&&vt.exports===He,At=tr&&We.process,Je=function(){try{var S=vt&&vt.require&&vt.require("util").types;return S||At&&At.binding&&At.binding("util")}catch{}}(),Qt=Je&&Je.isArrayBuffer,Cr=Je&&Je.isDate,wr=Je&&Je.isMap,Hr=Je&&Je.isRegExp,Rn=Je&&Je.isSet,Di=Je&&Je.isTypedArray;function Lt(S,j,$){switch($.length){case 0:return S.call(j);case 1:return S.call(j,$[0]);case 2:return S.call(j,$[0],$[1]);case 3:return S.call(j,$[0],$[1],$[2])}return S.apply(j,$)}function bp(S,j,$,W){for(var fe=-1,Te=S==null?0:S.length;++fe<Te;){var $t=S[fe];j(W,$t,$($t),S)}return W}function _r(S,j){for(var $=-1,W=S==null?0:S.length;++$<W&&j(S[$],$,S)!==!1;);return S}function Ep(S,j){for(var $=S==null?0:S.length;$--&&j(S[$],$,S)!==!1;);return S}function su(S,j){for(var $=-1,W=S==null?0:S.length;++$<W;)if(!j(S[$],$,S))return!1;return!0}function pi(S,j){for(var $=-1,W=S==null?0:S.length,fe=0,Te=[];++$<W;){var $t=S[$];j($t,$,S)&&(Te[fe++]=$t)}return Te}function Cs(S,j){var $=S==null?0:S.length;return!!$&&rn(S,j,0)>-1}function ha(S,j,$){for(var W=-1,fe=S==null?0:S.length;++W<fe;)if($(j,S[W]))return!0;return!1}function Ze(S,j){for(var $=-1,W=S==null?0:S.length,fe=Array(W);++$<W;)fe[$]=j(S[$],$,S);return fe}function di(S,j){for(var $=-1,W=j.length,fe=S.length;++$<W;)S[fe+$]=j[$];return S}function la(S,j,$,W){var fe=-1,Te=S==null?0:S.length;for(W&&Te&&($=S[++fe]);++fe<Te;)$=j($,S[fe],fe,S);return $}function Ip(S,j,$,W){var fe=S==null?0:S.length;for(W&&fe&&($=S[--fe]);fe--;)$=j($,S[fe],fe,S);return $}function fa(S,j){for(var $=-1,W=S==null?0:S.length;++$<W;)if(j(S[$],$,S))return!0;return!1}var xp=pa("length");function Pp(S){return S.split("")}function Sp(S){return S.match(Ot)||[]}function ou(S,j,$){var W;return $(S,function(fe,Te,$t){if(j(fe,Te,$t))return W=Te,!1}),W}function $s(S,j,$,W){for(var fe=S.length,Te=$+(W?1:-1);W?Te--:++Te<fe;)if(j(S[Te],Te,S))return Te;return-1}function rn(S,j,$){return j===j?Mp(S,j,$):$s(S,au,$)}function Op(S,j,$,W){for(var fe=$-1,Te=S.length;++fe<Te;)if(W(S[fe],j))return fe;return-1}function au(S){return S!==S}function cu(S,j){var $=S==null?0:S.length;return $?ga(S,j)/$:K}function pa(S){return function(j){return j==null?r:j[S]}}function da(S){return function(j){return S==null?r:S[j]}}function uu(S,j,$,W,fe){return fe(S,function(Te,$t,ke){$=W?(W=!1,Te):j($,Te,$t,ke)}),$}function Rp(S,j){var $=S.length;for(S.sort(j);$--;)S[$]=S[$].value;return S}function ga(S,j){for(var $,W=-1,fe=S.length;++W<fe;){var Te=j(S[W]);Te!==r&&($=$===r?Te:$+Te)}return $}function ya(S,j){for(var $=-1,W=Array(S);++$<S;)W[$]=j($);return W}function Ap(S,j){return Ze(j,function($){return[$,S[$]]})}function hu(S){return S&&S.slice(0,du(S)+1).replace(ft,"")}function pr(S){return function(j){return S(j)}}function va(S,j){return Ze(j,function($){return S[$]})}function An(S,j){return S.has(j)}function lu(S,j){for(var $=-1,W=S.length;++$<W&&rn(j,S[$],0)>-1;);return $}function fu(S,j){for(var $=S.length;$--&&rn(j,S[$],0)>-1;);return $}function Tp(S,j){for(var $=S.length,W=0;$--;)S[$]===j&&++W;return W}var Cp=da(m),$p=da(P);function Np(S){return"\\"+V[S]}function Dp(S,j){return S==null?r:S[j]}function nn(S){return As.test(S)}function Lp(S){return Ni.test(S)}function jp(S){for(var j,$=[];!(j=S.next()).done;)$.push(j.value);return $}function ma(S){var j=-1,$=Array(S.size);return S.forEach(function(W,fe){$[++j]=[fe,W]}),$}function pu(S,j){return function($){return S(j($))}}function gi(S,j){for(var $=-1,W=S.length,fe=0,Te=[];++$<W;){var $t=S[$];($t===j||$t===w)&&(S[$]=w,Te[fe++]=$)}return Te}function Ns(S){var j=-1,$=Array(S.size);return S.forEach(function(W){$[++j]=W}),$}function qp(S){var j=-1,$=Array(S.size);return S.forEach(function(W){$[++j]=[W,W]}),$}function Mp(S,j,$){for(var W=$-1,fe=S.length;++W<fe;)if(S[W]===j)return W;return-1}function zp(S,j,$){for(var W=$+1;W--;)if(S[W]===j)return W;return W}function sn(S){return nn(S)?Hp(S):xp(S)}function $r(S){return nn(S)?kp(S):Pp(S)}function du(S){for(var j=S.length;j--&&yt.test(S.charAt(j)););return j}var Up=da(z);function Hp(S){for(var j=tn.lastIndex=0;tn.test(S);)++j;return j}function kp(S){return S.match(tn)||[]}function Kp(S){return S.match(Rs)||[]}var Bp=function S(j){j=j==null?Pe:on.defaults(Pe.Object(),j,on.pick(Pe,Ts));var $=j.Array,W=j.Date,fe=j.Error,Te=j.Function,$t=j.Math,ke=j.Object,wa=j.RegExp,Fp=j.String,br=j.TypeError,Ds=$.prototype,Vp=Te.prototype,an=ke.prototype,Ls=j["__core-js_shared__"],js=Vp.toString,De=an.hasOwnProperty,Gp=0,gu=function(){var e=/[^.]+$/.exec(Ls&&Ls.keys&&Ls.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),qs=an.toString,Wp=js.call(ke),Jp=Pe._,Qp=wa("^"+js.call(De).replace(lt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ms=tr?j.Buffer:r,yi=j.Symbol,zs=j.Uint8Array,yu=Ms?Ms.allocUnsafe:r,Us=pu(ke.getPrototypeOf,ke),vu=ke.create,mu=an.propertyIsEnumerable,Hs=Ds.splice,wu=yi?yi.isConcatSpreadable:r,Tn=yi?yi.iterator:r,Li=yi?yi.toStringTag:r,ks=function(){try{var e=Ui(ke,"defineProperty");return e({},"",{}),e}catch{}}(),Yp=j.clearTimeout!==Pe.clearTimeout&&j.clearTimeout,Zp=W&&W.now!==Pe.Date.now&&W.now,Xp=j.setTimeout!==Pe.setTimeout&&j.setTimeout,Ks=$t.ceil,Bs=$t.floor,_a=ke.getOwnPropertySymbols,ed=Ms?Ms.isBuffer:r,_u=j.isFinite,td=Ds.join,rd=pu(ke.keys,ke),Nt=$t.max,Bt=$t.min,id=W.now,nd=j.parseInt,bu=$t.random,sd=Ds.reverse,ba=Ui(j,"DataView"),Cn=Ui(j,"Map"),Ea=Ui(j,"Promise"),cn=Ui(j,"Set"),$n=Ui(j,"WeakMap"),Nn=Ui(ke,"create"),Fs=$n&&new $n,un={},od=Hi(ba),ad=Hi(Cn),cd=Hi(Ea),ud=Hi(cn),hd=Hi($n),Vs=yi?yi.prototype:r,Dn=Vs?Vs.valueOf:r,Eu=Vs?Vs.toString:r;function d(e){if(dt(e)&&!ge(e)&&!(e instanceof xe)){if(e instanceof Er)return e;if(De.call(e,"__wrapped__"))return Ih(e)}return new Er(e)}var hn=function(){function e(){}return function(i){if(!nt(i))return{};if(vu)return vu(i);e.prototype=i;var a=new e;return e.prototype=r,a}}();function Gs(){}function Er(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}d.templateSettings={escape:ut,evaluate:ht,interpolate:it,variable:"",imports:{_:d}},d.prototype=Gs.prototype,d.prototype.constructor=d,Er.prototype=hn(Gs.prototype),Er.prototype.constructor=Er;function xe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=B,this.__views__=[]}function ld(){var e=new xe(this.__wrapped__);return e.__actions__=rr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=rr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=rr(this.__views__),e}function fd(){if(this.__filtered__){var e=new xe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function pd(){var e=this.__wrapped__.value(),i=this.__dir__,a=ge(e),u=i<0,f=a?e.length:0,y=Pg(0,f,this.__views__),_=y.start,E=y.end,R=E-_,q=u?E:_-1,M=this.__iteratees__,U=M.length,F=0,X=Bt(R,this.__takeCount__);if(!a||!u&&f==R&&X==R)return Vu(e,this.__actions__);var ne=[];e:for(;R--&&F<X;){q+=i;for(var we=-1,se=e[q];++we<U;){var be=M[we],Se=be.iteratee,yr=be.type,Xt=Se(se);if(yr==O)se=Xt;else if(!Xt){if(yr==b)continue e;break e}}ne[F++]=se}return ne}xe.prototype=hn(Gs.prototype),xe.prototype.constructor=xe;function ji(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var u=e[i];this.set(u[0],u[1])}}function dd(){this.__data__=Nn?Nn(null):{},this.size=0}function gd(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function yd(e){var i=this.__data__;if(Nn){var a=i[e];return a===v?r:a}return De.call(i,e)?i[e]:r}function vd(e){var i=this.__data__;return Nn?i[e]!==r:De.call(i,e)}function md(e,i){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=Nn&&i===r?v:i,this}ji.prototype.clear=dd,ji.prototype.delete=gd,ji.prototype.get=yd,ji.prototype.has=vd,ji.prototype.set=md;function Qr(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var u=e[i];this.set(u[0],u[1])}}function wd(){this.__data__=[],this.size=0}function _d(e){var i=this.__data__,a=Ws(i,e);if(a<0)return!1;var u=i.length-1;return a==u?i.pop():Hs.call(i,a,1),--this.size,!0}function bd(e){var i=this.__data__,a=Ws(i,e);return a<0?r:i[a][1]}function Ed(e){return Ws(this.__data__,e)>-1}function Id(e,i){var a=this.__data__,u=Ws(a,e);return u<0?(++this.size,a.push([e,i])):a[u][1]=i,this}Qr.prototype.clear=wd,Qr.prototype.delete=_d,Qr.prototype.get=bd,Qr.prototype.has=Ed,Qr.prototype.set=Id;function Yr(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var u=e[i];this.set(u[0],u[1])}}function xd(){this.size=0,this.__data__={hash:new ji,map:new(Cn||Qr),string:new ji}}function Pd(e){var i=oo(this,e).delete(e);return this.size-=i?1:0,i}function Sd(e){return oo(this,e).get(e)}function Od(e){return oo(this,e).has(e)}function Rd(e,i){var a=oo(this,e),u=a.size;return a.set(e,i),this.size+=a.size==u?0:1,this}Yr.prototype.clear=xd,Yr.prototype.delete=Pd,Yr.prototype.get=Sd,Yr.prototype.has=Od,Yr.prototype.set=Rd;function qi(e){var i=-1,a=e==null?0:e.length;for(this.__data__=new Yr;++i<a;)this.add(e[i])}function Ad(e){return this.__data__.set(e,v),this}function Td(e){return this.__data__.has(e)}qi.prototype.add=qi.prototype.push=Ad,qi.prototype.has=Td;function Nr(e){var i=this.__data__=new Qr(e);this.size=i.size}function Cd(){this.__data__=new Qr,this.size=0}function $d(e){var i=this.__data__,a=i.delete(e);return this.size=i.size,a}function Nd(e){return this.__data__.get(e)}function Dd(e){return this.__data__.has(e)}function Ld(e,i){var a=this.__data__;if(a instanceof Qr){var u=a.__data__;if(!Cn||u.length<s-1)return u.push([e,i]),this.size=++a.size,this;a=this.__data__=new Yr(u)}return a.set(e,i),this.size=a.size,this}Nr.prototype.clear=Cd,Nr.prototype.delete=$d,Nr.prototype.get=Nd,Nr.prototype.has=Dd,Nr.prototype.set=Ld;function Iu(e,i){var a=ge(e),u=!a&&ki(e),f=!a&&!u&&bi(e),y=!a&&!u&&!f&&dn(e),_=a||u||f||y,E=_?ya(e.length,Fp):[],R=E.length;for(var q in e)(i||De.call(e,q))&&!(_&&(q=="length"||f&&(q=="offset"||q=="parent")||y&&(q=="buffer"||q=="byteLength"||q=="byteOffset")||ti(q,R)))&&E.push(q);return E}function xu(e){var i=e.length;return i?e[Na(0,i-1)]:r}function jd(e,i){return ao(rr(e),Mi(i,0,e.length))}function qd(e){return ao(rr(e))}function Ia(e,i,a){(a!==r&&!Dr(e[i],a)||a===r&&!(i in e))&&Zr(e,i,a)}function Ln(e,i,a){var u=e[i];(!(De.call(e,i)&&Dr(u,a))||a===r&&!(i in e))&&Zr(e,i,a)}function Ws(e,i){for(var a=e.length;a--;)if(Dr(e[a][0],i))return a;return-1}function Md(e,i,a,u){return vi(e,function(f,y,_){i(u,f,a(f),_)}),u}function Pu(e,i){return e&&Kr(i,jt(i),e)}function zd(e,i){return e&&Kr(i,nr(i),e)}function Zr(e,i,a){i=="__proto__"&&ks?ks(e,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[i]=a}function xa(e,i){for(var a=-1,u=i.length,f=$(u),y=e==null;++a<u;)f[a]=y?r:nc(e,i[a]);return f}function Mi(e,i,a){return e===e&&(a!==r&&(e=e<=a?e:a),i!==r&&(e=e>=i?e:i)),e}function Ir(e,i,a,u,f,y){var _,E=i&x,R=i&T,q=i&D;if(a&&(_=f?a(e,u,f,y):a(e)),_!==r)return _;if(!nt(e))return e;var M=ge(e);if(M){if(_=Og(e),!E)return rr(e,_)}else{var U=Ft(e),F=U==Z||U==ue;if(bi(e))return Ju(e,E);if(U==Ie||U==Ee||F&&!f){if(_=R||F?{}:dh(e),!E)return R?yg(e,zd(_,e)):gg(e,Pu(_,e))}else{if(!je[U])return f?e:{};_=Rg(e,U,E)}}y||(y=new Nr);var X=y.get(e);if(X)return X;y.set(e,_),Kh(e)?e.forEach(function(se){_.add(Ir(se,i,a,se,e,y))}):Hh(e)&&e.forEach(function(se,be){_.set(be,Ir(se,i,a,be,e,y))});var ne=q?R?Ba:Ka:R?nr:jt,we=M?r:ne(e);return _r(we||e,function(se,be){we&&(be=se,se=e[be]),Ln(_,be,Ir(se,i,a,be,e,y))}),_}function Ud(e){var i=jt(e);return function(a){return Su(a,e,i)}}function Su(e,i,a){var u=a.length;if(e==null)return!u;for(e=ke(e);u--;){var f=a[u],y=i[f],_=e[f];if(_===r&&!(f in e)||!y(_))return!1}return!0}function Ou(e,i,a){if(typeof e!="function")throw new br(l);return kn(function(){e.apply(r,a)},i)}function jn(e,i,a,u){var f=-1,y=Cs,_=!0,E=e.length,R=[],q=i.length;if(!E)return R;a&&(i=Ze(i,pr(a))),u?(y=ha,_=!1):i.length>=s&&(y=An,_=!1,i=new qi(i));e:for(;++f<E;){var M=e[f],U=a==null?M:a(M);if(M=u||M!==0?M:0,_&&U===U){for(var F=q;F--;)if(i[F]===U)continue e;R.push(M)}else y(i,U,u)||R.push(M)}return R}var vi=eh(kr),Ru=eh(Sa,!0);function Hd(e,i){var a=!0;return vi(e,function(u,f,y){return a=!!i(u,f,y),a}),a}function Js(e,i,a){for(var u=-1,f=e.length;++u<f;){var y=e[u],_=i(y);if(_!=null&&(E===r?_===_&&!gr(_):a(_,E)))var E=_,R=y}return R}function kd(e,i,a,u){var f=e.length;for(a=ye(a),a<0&&(a=-a>f?0:f+a),u=u===r||u>f?f:ye(u),u<0&&(u+=f),u=a>u?0:Fh(u);a<u;)e[a++]=i;return e}function Au(e,i){var a=[];return vi(e,function(u,f,y){i(u,f,y)&&a.push(u)}),a}function kt(e,i,a,u,f){var y=-1,_=e.length;for(a||(a=Tg),f||(f=[]);++y<_;){var E=e[y];i>0&&a(E)?i>1?kt(E,i-1,a,u,f):di(f,E):u||(f[f.length]=E)}return f}var Pa=th(),Tu=th(!0);function kr(e,i){return e&&Pa(e,i,jt)}function Sa(e,i){return e&&Tu(e,i,jt)}function Qs(e,i){return pi(i,function(a){return ri(e[a])})}function zi(e,i){i=wi(i,e);for(var a=0,u=i.length;e!=null&&a<u;)e=e[Br(i[a++])];return a&&a==u?e:r}function Cu(e,i,a){var u=i(e);return ge(e)?u:di(u,a(e))}function Yt(e){return e==null?e===r?rt:Ae:Li&&Li in ke(e)?xg(e):qg(e)}function Oa(e,i){return e>i}function Kd(e,i){return e!=null&&De.call(e,i)}function Bd(e,i){return e!=null&&i in ke(e)}function Fd(e,i,a){return e>=Bt(i,a)&&e<Nt(i,a)}function Ra(e,i,a){for(var u=a?ha:Cs,f=e[0].length,y=e.length,_=y,E=$(y),R=1/0,q=[];_--;){var M=e[_];_&&i&&(M=Ze(M,pr(i))),R=Bt(M.length,R),E[_]=!a&&(i||f>=120&&M.length>=120)?new qi(_&&M):r}M=e[0];var U=-1,F=E[0];e:for(;++U<f&&q.length<R;){var X=M[U],ne=i?i(X):X;if(X=a||X!==0?X:0,!(F?An(F,ne):u(q,ne,a))){for(_=y;--_;){var we=E[_];if(!(we?An(we,ne):u(e[_],ne,a)))continue e}F&&F.push(ne),q.push(X)}}return q}function Vd(e,i,a,u){return kr(e,function(f,y,_){i(u,a(f),y,_)}),u}function qn(e,i,a){i=wi(i,e),e=mh(e,i);var u=e==null?e:e[Br(Pr(i))];return u==null?r:Lt(u,e,a)}function $u(e){return dt(e)&&Yt(e)==Ee}function Gd(e){return dt(e)&&Yt(e)==Re}function Wd(e){return dt(e)&&Yt(e)==C}function Mn(e,i,a,u,f){return e===i?!0:e==null||i==null||!dt(e)&&!dt(i)?e!==e&&i!==i:Jd(e,i,a,u,Mn,f)}function Jd(e,i,a,u,f,y){var _=ge(e),E=ge(i),R=_?Ar:Ft(e),q=E?Ar:Ft(i);R=R==Ee?Ie:R,q=q==Ee?Ie:q;var M=R==Ie,U=q==Ie,F=R==q;if(F&&bi(e)){if(!bi(i))return!1;_=!0,M=!1}if(F&&!M)return y||(y=new Nr),_||dn(e)?lh(e,i,a,u,f,y):Eg(e,i,R,a,u,f,y);if(!(a&A)){var X=M&&De.call(e,"__wrapped__"),ne=U&&De.call(i,"__wrapped__");if(X||ne){var we=X?e.value():e,se=ne?i.value():i;return y||(y=new Nr),f(we,se,a,u,y)}}return F?(y||(y=new Nr),Ig(e,i,a,u,f,y)):!1}function Qd(e){return dt(e)&&Ft(e)==me}function Aa(e,i,a,u){var f=a.length,y=f,_=!u;if(e==null)return!y;for(e=ke(e);f--;){var E=a[f];if(_&&E[2]?E[1]!==e[E[0]]:!(E[0]in e))return!1}for(;++f<y;){E=a[f];var R=E[0],q=e[R],M=E[1];if(_&&E[2]){if(q===r&&!(R in e))return!1}else{var U=new Nr;if(u)var F=u(q,M,R,e,i,U);if(!(F===r?Mn(M,q,A|J,u,U):F))return!1}}return!0}function Nu(e){if(!nt(e)||$g(e))return!1;var i=ri(e)?Qp:Wo;return i.test(Hi(e))}function Yd(e){return dt(e)&&Yt(e)==tt}function Zd(e){return dt(e)&&Ft(e)==Ce}function Xd(e){return dt(e)&&po(e.length)&&!!ze[Yt(e)]}function Du(e){return typeof e=="function"?e:e==null?sr:typeof e=="object"?ge(e)?qu(e[0],e[1]):ju(e):rl(e)}function Ta(e){if(!Hn(e))return rd(e);var i=[];for(var a in ke(e))De.call(e,a)&&a!="constructor"&&i.push(a);return i}function eg(e){if(!nt(e))return jg(e);var i=Hn(e),a=[];for(var u in e)u=="constructor"&&(i||!De.call(e,u))||a.push(u);return a}function Ca(e,i){return e<i}function Lu(e,i){var a=-1,u=ir(e)?$(e.length):[];return vi(e,function(f,y,_){u[++a]=i(f,y,_)}),u}function ju(e){var i=Va(e);return i.length==1&&i[0][2]?yh(i[0][0],i[0][1]):function(a){return a===e||Aa(a,e,i)}}function qu(e,i){return Wa(e)&&gh(i)?yh(Br(e),i):function(a){var u=nc(a,e);return u===r&&u===i?sc(a,e):Mn(i,u,A|J)}}function Ys(e,i,a,u,f){e!==i&&Pa(i,function(y,_){if(f||(f=new Nr),nt(y))tg(e,i,_,a,Ys,u,f);else{var E=u?u(Qa(e,_),y,_+"",e,i,f):r;E===r&&(E=y),Ia(e,_,E)}},nr)}function tg(e,i,a,u,f,y,_){var E=Qa(e,a),R=Qa(i,a),q=_.get(R);if(q){Ia(e,a,q);return}var M=y?y(E,R,a+"",e,i,_):r,U=M===r;if(U){var F=ge(R),X=!F&&bi(R),ne=!F&&!X&&dn(R);M=R,F||X||ne?ge(E)?M=E:mt(E)?M=rr(E):X?(U=!1,M=Ju(R,!0)):ne?(U=!1,M=Qu(R,!0)):M=[]:Kn(R)||ki(R)?(M=E,ki(E)?M=Vh(E):(!nt(E)||ri(E))&&(M=dh(R))):U=!1}U&&(_.set(R,M),f(M,R,u,y,_),_.delete(R)),Ia(e,a,M)}function Mu(e,i){var a=e.length;if(a)return i+=i<0?a:0,ti(i,a)?e[i]:r}function zu(e,i,a){i.length?i=Ze(i,function(y){return ge(y)?function(_){return zi(_,y.length===1?y[0]:y)}:y}):i=[sr];var u=-1;i=Ze(i,pr(ie()));var f=Lu(e,function(y,_,E){var R=Ze(i,function(q){return q(y)});return{criteria:R,index:++u,value:y}});return Rp(f,function(y,_){return dg(y,_,a)})}function rg(e,i){return Uu(e,i,function(a,u){return sc(e,u)})}function Uu(e,i,a){for(var u=-1,f=i.length,y={};++u<f;){var _=i[u],E=zi(e,_);a(E,_)&&zn(y,wi(_,e),E)}return y}function ig(e){return function(i){return zi(i,e)}}function $a(e,i,a,u){var f=u?Op:rn,y=-1,_=i.length,E=e;for(e===i&&(i=rr(i)),a&&(E=Ze(e,pr(a)));++y<_;)for(var R=0,q=i[y],M=a?a(q):q;(R=f(E,M,R,u))>-1;)E!==e&&Hs.call(E,R,1),Hs.call(e,R,1);return e}function Hu(e,i){for(var a=e?i.length:0,u=a-1;a--;){var f=i[a];if(a==u||f!==y){var y=f;ti(f)?Hs.call(e,f,1):ja(e,f)}}return e}function Na(e,i){return e+Bs(bu()*(i-e+1))}function ng(e,i,a,u){for(var f=-1,y=Nt(Ks((i-e)/(a||1)),0),_=$(y);y--;)_[u?y:++f]=e,e+=a;return _}function Da(e,i){var a="";if(!e||i<1||i>k)return a;do i%2&&(a+=e),i=Bs(i/2),i&&(e+=e);while(i);return a}function _e(e,i){return Ya(vh(e,i,sr),e+"")}function sg(e){return xu(gn(e))}function og(e,i){var a=gn(e);return ao(a,Mi(i,0,a.length))}function zn(e,i,a,u){if(!nt(e))return e;i=wi(i,e);for(var f=-1,y=i.length,_=y-1,E=e;E!=null&&++f<y;){var R=Br(i[f]),q=a;if(R==="__proto__"||R==="constructor"||R==="prototype")return e;if(f!=_){var M=E[R];q=u?u(M,R,E):r,q===r&&(q=nt(M)?M:ti(i[f+1])?[]:{})}Ln(E,R,q),E=E[R]}return e}var ku=Fs?function(e,i){return Fs.set(e,i),e}:sr,ag=ks?function(e,i){return ks(e,"toString",{configurable:!0,enumerable:!1,value:ac(i),writable:!0})}:sr;function cg(e){return ao(gn(e))}function xr(e,i,a){var u=-1,f=e.length;i<0&&(i=-i>f?0:f+i),a=a>f?f:a,a<0&&(a+=f),f=i>a?0:a-i>>>0,i>>>=0;for(var y=$(f);++u<f;)y[u]=e[u+i];return y}function ug(e,i){var a;return vi(e,function(u,f,y){return a=i(u,f,y),!a}),!!a}function Zs(e,i,a){var u=0,f=e==null?u:e.length;if(typeof i=="number"&&i===i&&f<=ot){for(;u<f;){var y=u+f>>>1,_=e[y];_!==null&&!gr(_)&&(a?_<=i:_<i)?u=y+1:f=y}return f}return La(e,i,sr,a)}function La(e,i,a,u){var f=0,y=e==null?0:e.length;if(y===0)return 0;i=a(i);for(var _=i!==i,E=i===null,R=gr(i),q=i===r;f<y;){var M=Bs((f+y)/2),U=a(e[M]),F=U!==r,X=U===null,ne=U===U,we=gr(U);if(_)var se=u||ne;else q?se=ne&&(u||F):E?se=ne&&F&&(u||!X):R?se=ne&&F&&!X&&(u||!we):X||we?se=!1:se=u?U<=i:U<i;se?f=M+1:y=M}return Bt(y,et)}function Ku(e,i){for(var a=-1,u=e.length,f=0,y=[];++a<u;){var _=e[a],E=i?i(_):_;if(!a||!Dr(E,R)){var R=E;y[f++]=_===0?0:_}}return y}function Bu(e){return typeof e=="number"?e:gr(e)?K:+e}function dr(e){if(typeof e=="string")return e;if(ge(e))return Ze(e,dr)+"";if(gr(e))return Eu?Eu.call(e):"";var i=e+"";return i=="0"&&1/e==-le?"-0":i}function mi(e,i,a){var u=-1,f=Cs,y=e.length,_=!0,E=[],R=E;if(a)_=!1,f=ha;else if(y>=s){var q=i?null:_g(e);if(q)return Ns(q);_=!1,f=An,R=new qi}else R=i?[]:E;e:for(;++u<y;){var M=e[u],U=i?i(M):M;if(M=a||M!==0?M:0,_&&U===U){for(var F=R.length;F--;)if(R[F]===U)continue e;i&&R.push(U),E.push(M)}else f(R,U,a)||(R!==E&&R.push(U),E.push(M))}return E}function ja(e,i){return i=wi(i,e),e=mh(e,i),e==null||delete e[Br(Pr(i))]}function Fu(e,i,a,u){return zn(e,i,a(zi(e,i)),u)}function Xs(e,i,a,u){for(var f=e.length,y=u?f:-1;(u?y--:++y<f)&&i(e[y],y,e););return a?xr(e,u?0:y,u?y+1:f):xr(e,u?y+1:0,u?f:y)}function Vu(e,i){var a=e;return a instanceof xe&&(a=a.value()),la(i,function(u,f){return f.func.apply(f.thisArg,di([u],f.args))},a)}function qa(e,i,a){var u=e.length;if(u<2)return u?mi(e[0]):[];for(var f=-1,y=$(u);++f<u;)for(var _=e[f],E=-1;++E<u;)E!=f&&(y[f]=jn(y[f]||_,e[E],i,a));return mi(kt(y,1),i,a)}function Gu(e,i,a){for(var u=-1,f=e.length,y=i.length,_={};++u<f;){var E=u<y?i[u]:r;a(_,e[u],E)}return _}function Ma(e){return mt(e)?e:[]}function za(e){return typeof e=="function"?e:sr}function wi(e,i){return ge(e)?e:Wa(e,i)?[e]:Eh($e(e))}var hg=_e;function _i(e,i,a){var u=e.length;return a=a===r?u:a,!i&&a>=u?e:xr(e,i,a)}var Wu=Yp||function(e){return Pe.clearTimeout(e)};function Ju(e,i){if(i)return e.slice();var a=e.length,u=yu?yu(a):new e.constructor(a);return e.copy(u),u}function Ua(e){var i=new e.constructor(e.byteLength);return new zs(i).set(new zs(e)),i}function lg(e,i){var a=i?Ua(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.byteLength)}function fg(e){var i=new e.constructor(e.source,mr.exec(e));return i.lastIndex=e.lastIndex,i}function pg(e){return Dn?ke(Dn.call(e)):{}}function Qu(e,i){var a=i?Ua(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.length)}function Yu(e,i){if(e!==i){var a=e!==r,u=e===null,f=e===e,y=gr(e),_=i!==r,E=i===null,R=i===i,q=gr(i);if(!E&&!q&&!y&&e>i||y&&_&&R&&!E&&!q||u&&_&&R||!a&&R||!f)return 1;if(!u&&!y&&!q&&e<i||q&&a&&f&&!u&&!y||E&&a&&f||!_&&f||!R)return-1}return 0}function dg(e,i,a){for(var u=-1,f=e.criteria,y=i.criteria,_=f.length,E=a.length;++u<_;){var R=Yu(f[u],y[u]);if(R){if(u>=E)return R;var q=a[u];return R*(q=="desc"?-1:1)}}return e.index-i.index}function Zu(e,i,a,u){for(var f=-1,y=e.length,_=a.length,E=-1,R=i.length,q=Nt(y-_,0),M=$(R+q),U=!u;++E<R;)M[E]=i[E];for(;++f<_;)(U||f<y)&&(M[a[f]]=e[f]);for(;q--;)M[E++]=e[f++];return M}function Xu(e,i,a,u){for(var f=-1,y=e.length,_=-1,E=a.length,R=-1,q=i.length,M=Nt(y-E,0),U=$(M+q),F=!u;++f<M;)U[f]=e[f];for(var X=f;++R<q;)U[X+R]=i[R];for(;++_<E;)(F||f<y)&&(U[X+a[_]]=e[f++]);return U}function rr(e,i){var a=-1,u=e.length;for(i||(i=$(u));++a<u;)i[a]=e[a];return i}function Kr(e,i,a,u){var f=!a;a||(a={});for(var y=-1,_=i.length;++y<_;){var E=i[y],R=u?u(a[E],e[E],E,a,e):r;R===r&&(R=e[E]),f?Zr(a,E,R):Ln(a,E,R)}return a}function gg(e,i){return Kr(e,Ga(e),i)}function yg(e,i){return Kr(e,fh(e),i)}function eo(e,i){return function(a,u){var f=ge(a)?bp:Md,y=i?i():{};return f(a,e,ie(u,2),y)}}function ln(e){return _e(function(i,a){var u=-1,f=a.length,y=f>1?a[f-1]:r,_=f>2?a[2]:r;for(y=e.length>3&&typeof y=="function"?(f--,y):r,_&&Zt(a[0],a[1],_)&&(y=f<3?r:y,f=1),i=ke(i);++u<f;){var E=a[u];E&&e(i,E,u,y)}return i})}function eh(e,i){return function(a,u){if(a==null)return a;if(!ir(a))return e(a,u);for(var f=a.length,y=i?f:-1,_=ke(a);(i?y--:++y<f)&&u(_[y],y,_)!==!1;);return a}}function th(e){return function(i,a,u){for(var f=-1,y=ke(i),_=u(i),E=_.length;E--;){var R=_[e?E:++f];if(a(y[R],R,y)===!1)break}return i}}function vg(e,i,a){var u=i&ee,f=Un(e);function y(){var _=this&&this!==Pe&&this instanceof y?f:e;return _.apply(u?a:this,arguments)}return y}function rh(e){return function(i){i=$e(i);var a=nn(i)?$r(i):r,u=a?a[0]:i.charAt(0),f=a?_i(a,1).join(""):i.slice(1);return u[e]()+f}}function fn(e){return function(i){return la(el(Xh(i).replace(On,"")),e,"")}}function Un(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var a=hn(e.prototype),u=e.apply(a,i);return nt(u)?u:a}}function mg(e,i,a){var u=Un(e);function f(){for(var y=arguments.length,_=$(y),E=y,R=pn(f);E--;)_[E]=arguments[E];var q=y<3&&_[0]!==R&&_[y-1]!==R?[]:gi(_,R);if(y-=q.length,y<a)return ah(e,i,to,f.placeholder,r,_,q,r,r,a-y);var M=this&&this!==Pe&&this instanceof f?u:e;return Lt(M,this,_)}return f}function ih(e){return function(i,a,u){var f=ke(i);if(!ir(i)){var y=ie(a,3);i=jt(i),a=function(E){return y(f[E],E,f)}}var _=e(i,a,u);return _>-1?f[y?i[_]:_]:r}}function nh(e){return ei(function(i){var a=i.length,u=a,f=Er.prototype.thru;for(e&&i.reverse();u--;){var y=i[u];if(typeof y!="function")throw new br(l);if(f&&!_&&so(y)=="wrapper")var _=new Er([],!0)}for(u=_?u:a;++u<a;){y=i[u];var E=so(y),R=E=="wrapper"?Fa(y):r;R&&Ja(R[0])&&R[1]==(Y|oe|he|ve)&&!R[4].length&&R[9]==1?_=_[so(R[0])].apply(_,R[3]):_=y.length==1&&Ja(y)?_[E]():_.thru(y)}return function(){var q=arguments,M=q[0];if(_&&q.length==1&&ge(M))return _.plant(M).value();for(var U=0,F=a?i[U].apply(this,q):M;++U<a;)F=i[U].call(this,F);return F}})}function to(e,i,a,u,f,y,_,E,R,q){var M=i&Y,U=i&ee,F=i&ce,X=i&(oe|te),ne=i&_t,we=F?r:Un(e);function se(){for(var be=arguments.length,Se=$(be),yr=be;yr--;)Se[yr]=arguments[yr];if(X)var Xt=pn(se),vr=Tp(Se,Xt);if(u&&(Se=Zu(Se,u,f,X)),y&&(Se=Xu(Se,y,_,X)),be-=vr,X&&be<q){var wt=gi(Se,Xt);return ah(e,i,to,se.placeholder,a,Se,wt,E,R,q-be)}var Lr=U?a:this,ni=F?Lr[e]:e;return be=Se.length,E?Se=Mg(Se,E):ne&&be>1&&Se.reverse(),M&&R<be&&(Se.length=R),this&&this!==Pe&&this instanceof se&&(ni=we||Un(ni)),ni.apply(Lr,Se)}return se}function sh(e,i){return function(a,u){return Vd(a,e,i(u),{})}}function ro(e,i){return function(a,u){var f;if(a===r&&u===r)return i;if(a!==r&&(f=a),u!==r){if(f===r)return u;typeof a=="string"||typeof u=="string"?(a=dr(a),u=dr(u)):(a=Bu(a),u=Bu(u)),f=e(a,u)}return f}}function Ha(e){return ei(function(i){return i=Ze(i,pr(ie())),_e(function(a){var u=this;return e(i,function(f){return Lt(f,u,a)})})})}function io(e,i){i=i===r?" ":dr(i);var a=i.length;if(a<2)return a?Da(i,e):i;var u=Da(i,Ks(e/sn(i)));return nn(i)?_i($r(u),0,e).join(""):u.slice(0,e)}function wg(e,i,a,u){var f=i&ee,y=Un(e);function _(){for(var E=-1,R=arguments.length,q=-1,M=u.length,U=$(M+R),F=this&&this!==Pe&&this instanceof _?y:e;++q<M;)U[q]=u[q];for(;R--;)U[q++]=arguments[++E];return Lt(F,f?a:this,U)}return _}function oh(e){return function(i,a,u){return u&&typeof u!="number"&&Zt(i,a,u)&&(a=u=r),i=ii(i),a===r?(a=i,i=0):a=ii(a),u=u===r?i<a?1:-1:ii(u),ng(i,a,u,e)}}function no(e){return function(i,a){return typeof i=="string"&&typeof a=="string"||(i=Sr(i),a=Sr(a)),e(i,a)}}function ah(e,i,a,u,f,y,_,E,R,q){var M=i&oe,U=M?_:r,F=M?r:_,X=M?y:r,ne=M?r:y;i|=M?he:pe,i&=~(M?pe:he),i&ae||(i&=~(ee|ce));var we=[e,i,f,X,U,ne,F,E,R,q],se=a.apply(r,we);return Ja(e)&&wh(se,we),se.placeholder=u,_h(se,e,i)}function ka(e){var i=$t[e];return function(a,u){if(a=Sr(a),u=u==null?0:Bt(ye(u),292),u&&_u(a)){var f=($e(a)+"e").split("e"),y=i(f[0]+"e"+(+f[1]+u));return f=($e(y)+"e").split("e"),+(f[0]+"e"+(+f[1]-u))}return i(a)}}var _g=cn&&1/Ns(new cn([,-0]))[1]==le?function(e){return new cn(e)}:hc;function ch(e){return function(i){var a=Ft(i);return a==me?ma(i):a==Ce?qp(i):Ap(i,e(i))}}function Xr(e,i,a,u,f,y,_,E){var R=i&ce;if(!R&&typeof e!="function")throw new br(l);var q=u?u.length:0;if(q||(i&=~(he|pe),u=f=r),_=_===r?_:Nt(ye(_),0),E=E===r?E:ye(E),q-=f?f.length:0,i&pe){var M=u,U=f;u=f=r}var F=R?r:Fa(e),X=[e,i,a,u,f,M,U,y,_,E];if(F&&Lg(X,F),e=X[0],i=X[1],a=X[2],u=X[3],f=X[4],E=X[9]=X[9]===r?R?0:e.length:Nt(X[9]-q,0),!E&&i&(oe|te)&&(i&=~(oe|te)),!i||i==ee)var ne=vg(e,i,a);else i==oe||i==te?ne=mg(e,i,E):(i==he||i==(ee|he))&&!f.length?ne=wg(e,i,a,u):ne=to.apply(r,X);var we=F?ku:wh;return _h(we(ne,X),e,i)}function uh(e,i,a,u){return e===r||Dr(e,an[a])&&!De.call(u,a)?i:e}function hh(e,i,a,u,f,y){return nt(e)&&nt(i)&&(y.set(i,e),Ys(e,i,r,hh,y),y.delete(i)),e}function bg(e){return Kn(e)?r:e}function lh(e,i,a,u,f,y){var _=a&A,E=e.length,R=i.length;if(E!=R&&!(_&&R>E))return!1;var q=y.get(e),M=y.get(i);if(q&&M)return q==i&&M==e;var U=-1,F=!0,X=a&J?new qi:r;for(y.set(e,i),y.set(i,e);++U<E;){var ne=e[U],we=i[U];if(u)var se=_?u(we,ne,U,i,e,y):u(ne,we,U,e,i,y);if(se!==r){if(se)continue;F=!1;break}if(X){if(!fa(i,function(be,Se){if(!An(X,Se)&&(ne===be||f(ne,be,a,u,y)))return X.push(Se)})){F=!1;break}}else if(!(ne===we||f(ne,we,a,u,y))){F=!1;break}}return y.delete(e),y.delete(i),F}function Eg(e,i,a,u,f,y,_){switch(a){case Me:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Re:return!(e.byteLength!=i.byteLength||!y(new zs(e),new zs(i)));case N:case C:case Oe:return Dr(+e,+i);case I:return e.name==i.name&&e.message==i.message;case tt:case Fe:return e==i+"";case me:var E=ma;case Ce:var R=u&A;if(E||(E=Ns),e.size!=i.size&&!R)return!1;var q=_.get(e);if(q)return q==i;u|=J,_.set(e,i);var M=lh(E(e),E(i),u,f,y,_);return _.delete(e),M;case Ve:if(Dn)return Dn.call(e)==Dn.call(i)}return!1}function Ig(e,i,a,u,f,y){var _=a&A,E=Ka(e),R=E.length,q=Ka(i),M=q.length;if(R!=M&&!_)return!1;for(var U=R;U--;){var F=E[U];if(!(_?F in i:De.call(i,F)))return!1}var X=y.get(e),ne=y.get(i);if(X&&ne)return X==i&&ne==e;var we=!0;y.set(e,i),y.set(i,e);for(var se=_;++U<R;){F=E[U];var be=e[F],Se=i[F];if(u)var yr=_?u(Se,be,F,i,e,y):u(be,Se,F,e,i,y);if(!(yr===r?be===Se||f(be,Se,a,u,y):yr)){we=!1;break}se||(se=F=="constructor")}if(we&&!se){var Xt=e.constructor,vr=i.constructor;Xt!=vr&&"constructor"in e&&"constructor"in i&&!(typeof Xt=="function"&&Xt instanceof Xt&&typeof vr=="function"&&vr instanceof vr)&&(we=!1)}return y.delete(e),y.delete(i),we}function ei(e){return Ya(vh(e,r,Sh),e+"")}function Ka(e){return Cu(e,jt,Ga)}function Ba(e){return Cu(e,nr,fh)}var Fa=Fs?function(e){return Fs.get(e)}:hc;function so(e){for(var i=e.name+"",a=un[i],u=De.call(un,i)?a.length:0;u--;){var f=a[u],y=f.func;if(y==null||y==e)return f.name}return i}function pn(e){var i=De.call(d,"placeholder")?d:e;return i.placeholder}function ie(){var e=d.iteratee||cc;return e=e===cc?Du:e,arguments.length?e(arguments[0],arguments[1]):e}function oo(e,i){var a=e.__data__;return Cg(i)?a[typeof i=="string"?"string":"hash"]:a.map}function Va(e){for(var i=jt(e),a=i.length;a--;){var u=i[a],f=e[u];i[a]=[u,f,gh(f)]}return i}function Ui(e,i){var a=Dp(e,i);return Nu(a)?a:r}function xg(e){var i=De.call(e,Li),a=e[Li];try{e[Li]=r;var u=!0}catch{}var f=qs.call(e);return u&&(i?e[Li]=a:delete e[Li]),f}var Ga=_a?function(e){return e==null?[]:(e=ke(e),pi(_a(e),function(i){return mu.call(e,i)}))}:lc,fh=_a?function(e){for(var i=[];e;)di(i,Ga(e)),e=Us(e);return i}:lc,Ft=Yt;(ba&&Ft(new ba(new ArrayBuffer(1)))!=Me||Cn&&Ft(new Cn)!=me||Ea&&Ft(Ea.resolve())!=bt||cn&&Ft(new cn)!=Ce||$n&&Ft(new $n)!=Le)&&(Ft=function(e){var i=Yt(e),a=i==Ie?e.constructor:r,u=a?Hi(a):"";if(u)switch(u){case od:return Me;case ad:return me;case cd:return bt;case ud:return Ce;case hd:return Le}return i});function Pg(e,i,a){for(var u=-1,f=a.length;++u<f;){var y=a[u],_=y.size;switch(y.type){case"drop":e+=_;break;case"dropRight":i-=_;break;case"take":i=Bt(i,e+_);break;case"takeRight":e=Nt(e,i-_);break}}return{start:e,end:i}}function Sg(e){var i=e.match(Ke);return i?i[1].split(St):[]}function ph(e,i,a){i=wi(i,e);for(var u=-1,f=i.length,y=!1;++u<f;){var _=Br(i[u]);if(!(y=e!=null&&a(e,_)))break;e=e[_]}return y||++u!=f?y:(f=e==null?0:e.length,!!f&&po(f)&&ti(_,f)&&(ge(e)||ki(e)))}function Og(e){var i=e.length,a=new e.constructor(i);return i&&typeof e[0]=="string"&&De.call(e,"index")&&(a.index=e.index,a.input=e.input),a}function dh(e){return typeof e.constructor=="function"&&!Hn(e)?hn(Us(e)):{}}function Rg(e,i,a){var u=e.constructor;switch(i){case Re:return Ua(e);case N:case C:return new u(+e);case Me:return lg(e,a);case at:case Ne:case Et:case Ct:case Ut:case Ht:case Dt:case Wt:case er:return Qu(e,a);case me:return new u;case Oe:case Fe:return new u(e);case tt:return fg(e);case Ce:return new u;case Ve:return pg(e)}}function Ag(e,i){var a=i.length;if(!a)return e;var u=a-1;return i[u]=(a>1?"& ":"")+i[u],i=i.join(a>2?", ":" "),e.replace(pt,`{
/* [wrapped with `+i+`] */
`)}function Tg(e){return ge(e)||ki(e)||!!(wu&&e&&e[wu])}function ti(e,i){var a=typeof e;return i=i??k,!!i&&(a=="number"||a!="symbol"&&Qo.test(e))&&e>-1&&e%1==0&&e<i}function Zt(e,i,a){if(!nt(a))return!1;var u=typeof i;return(u=="number"?ir(a)&&ti(i,a.length):u=="string"&&i in a)?Dr(a[i],e):!1}function Wa(e,i){if(ge(e))return!1;var a=typeof e;return a=="number"||a=="symbol"||a=="boolean"||e==null||gr(e)?!0:It.test(e)||!Ye.test(e)||i!=null&&e in ke(i)}function Cg(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function Ja(e){var i=so(e),a=d[i];if(typeof a!="function"||!(i in xe.prototype))return!1;if(e===a)return!0;var u=Fa(a);return!!u&&e===u[0]}function $g(e){return!!gu&&gu in e}var Ng=Ls?ri:fc;function Hn(e){var i=e&&e.constructor,a=typeof i=="function"&&i.prototype||an;return e===a}function gh(e){return e===e&&!nt(e)}function yh(e,i){return function(a){return a==null?!1:a[e]===i&&(i!==r||e in ke(a))}}function Dg(e){var i=lo(e,function(u){return a.size===p&&a.clear(),u}),a=i.cache;return i}function Lg(e,i){var a=e[1],u=i[1],f=a|u,y=f<(ee|ce|Y),_=u==Y&&a==oe||u==Y&&a==ve&&e[7].length<=i[8]||u==(Y|ve)&&i[7].length<=i[8]&&a==oe;if(!(y||_))return e;u&ee&&(e[2]=i[2],f|=a&ee?0:ae);var E=i[3];if(E){var R=e[3];e[3]=R?Zu(R,E,i[4]):E,e[4]=R?gi(e[3],w):i[4]}return E=i[5],E&&(R=e[5],e[5]=R?Xu(R,E,i[6]):E,e[6]=R?gi(e[5],w):i[6]),E=i[7],E&&(e[7]=E),u&Y&&(e[8]=e[8]==null?i[8]:Bt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=f,e}function jg(e){var i=[];if(e!=null)for(var a in ke(e))i.push(a);return i}function qg(e){return qs.call(e)}function vh(e,i,a){return i=Nt(i===r?e.length-1:i,0),function(){for(var u=arguments,f=-1,y=Nt(u.length-i,0),_=$(y);++f<y;)_[f]=u[i+f];f=-1;for(var E=$(i+1);++f<i;)E[f]=u[f];return E[i]=a(_),Lt(e,this,E)}}function mh(e,i){return i.length<2?e:zi(e,xr(i,0,-1))}function Mg(e,i){for(var a=e.length,u=Bt(i.length,a),f=rr(e);u--;){var y=i[u];e[u]=ti(y,a)?f[y]:r}return e}function Qa(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var wh=bh(ku),kn=Xp||function(e,i){return Pe.setTimeout(e,i)},Ya=bh(ag);function _h(e,i,a){var u=i+"";return Ya(e,Ag(u,zg(Sg(u),a)))}function bh(e){var i=0,a=0;return function(){var u=id(),f=zt-(u-a);if(a=u,f>0){if(++i>=Mt)return arguments[0]}else i=0;return e.apply(r,arguments)}}function ao(e,i){var a=-1,u=e.length,f=u-1;for(i=i===r?u:i;++a<i;){var y=Na(a,f),_=e[y];e[y]=e[a],e[a]=_}return e.length=i,e}var Eh=Dg(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(xt,function(a,u,f,y){i.push(f?y.replace(Bo,"$1"):u||a)}),i});function Br(e){if(typeof e=="string"||gr(e))return e;var i=e+"";return i=="0"&&1/e==-le?"-0":i}function Hi(e){if(e!=null){try{return js.call(e)}catch{}try{return e+""}catch{}}return""}function zg(e,i){return _r(Ri,function(a){var u="_."+a[0];i&a[1]&&!Cs(e,u)&&e.push(u)}),e.sort()}function Ih(e){if(e instanceof xe)return e.clone();var i=new Er(e.__wrapped__,e.__chain__);return i.__actions__=rr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function Ug(e,i,a){(a?Zt(e,i,a):i===r)?i=1:i=Nt(ye(i),0);var u=e==null?0:e.length;if(!u||i<1)return[];for(var f=0,y=0,_=$(Ks(u/i));f<u;)_[y++]=xr(e,f,f+=i);return _}function Hg(e){for(var i=-1,a=e==null?0:e.length,u=0,f=[];++i<a;){var y=e[i];y&&(f[u++]=y)}return f}function kg(){var e=arguments.length;if(!e)return[];for(var i=$(e-1),a=arguments[0],u=e;u--;)i[u-1]=arguments[u];return di(ge(a)?rr(a):[a],kt(i,1))}var Kg=_e(function(e,i){return mt(e)?jn(e,kt(i,1,mt,!0)):[]}),Bg=_e(function(e,i){var a=Pr(i);return mt(a)&&(a=r),mt(e)?jn(e,kt(i,1,mt,!0),ie(a,2)):[]}),Fg=_e(function(e,i){var a=Pr(i);return mt(a)&&(a=r),mt(e)?jn(e,kt(i,1,mt,!0),r,a):[]});function Vg(e,i,a){var u=e==null?0:e.length;return u?(i=a||i===r?1:ye(i),xr(e,i<0?0:i,u)):[]}function Gg(e,i,a){var u=e==null?0:e.length;return u?(i=a||i===r?1:ye(i),i=u-i,xr(e,0,i<0?0:i)):[]}function Wg(e,i){return e&&e.length?Xs(e,ie(i,3),!0,!0):[]}function Jg(e,i){return e&&e.length?Xs(e,ie(i,3),!0):[]}function Qg(e,i,a,u){var f=e==null?0:e.length;return f?(a&&typeof a!="number"&&Zt(e,i,a)&&(a=0,u=f),kd(e,i,a,u)):[]}function xh(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var f=a==null?0:ye(a);return f<0&&(f=Nt(u+f,0)),$s(e,ie(i,3),f)}function Ph(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var f=u-1;return a!==r&&(f=ye(a),f=a<0?Nt(u+f,0):Bt(f,u-1)),$s(e,ie(i,3),f,!0)}function Sh(e){var i=e==null?0:e.length;return i?kt(e,1):[]}function Yg(e){var i=e==null?0:e.length;return i?kt(e,le):[]}function Zg(e,i){var a=e==null?0:e.length;return a?(i=i===r?1:ye(i),kt(e,i)):[]}function Xg(e){for(var i=-1,a=e==null?0:e.length,u={};++i<a;){var f=e[i];u[f[0]]=f[1]}return u}function Oh(e){return e&&e.length?e[0]:r}function ey(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var f=a==null?0:ye(a);return f<0&&(f=Nt(u+f,0)),rn(e,i,f)}function ty(e){var i=e==null?0:e.length;return i?xr(e,0,-1):[]}var ry=_e(function(e){var i=Ze(e,Ma);return i.length&&i[0]===e[0]?Ra(i):[]}),iy=_e(function(e){var i=Pr(e),a=Ze(e,Ma);return i===Pr(a)?i=r:a.pop(),a.length&&a[0]===e[0]?Ra(a,ie(i,2)):[]}),ny=_e(function(e){var i=Pr(e),a=Ze(e,Ma);return i=typeof i=="function"?i:r,i&&a.pop(),a.length&&a[0]===e[0]?Ra(a,r,i):[]});function sy(e,i){return e==null?"":td.call(e,i)}function Pr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function oy(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var f=u;return a!==r&&(f=ye(a),f=f<0?Nt(u+f,0):Bt(f,u-1)),i===i?zp(e,i,f):$s(e,au,f,!0)}function ay(e,i){return e&&e.length?Mu(e,ye(i)):r}var cy=_e(Rh);function Rh(e,i){return e&&e.length&&i&&i.length?$a(e,i):e}function uy(e,i,a){return e&&e.length&&i&&i.length?$a(e,i,ie(a,2)):e}function hy(e,i,a){return e&&e.length&&i&&i.length?$a(e,i,r,a):e}var ly=ei(function(e,i){var a=e==null?0:e.length,u=xa(e,i);return Hu(e,Ze(i,function(f){return ti(f,a)?+f:f}).sort(Yu)),u});function fy(e,i){var a=[];if(!(e&&e.length))return a;var u=-1,f=[],y=e.length;for(i=ie(i,3);++u<y;){var _=e[u];i(_,u,e)&&(a.push(_),f.push(u))}return Hu(e,f),a}function Za(e){return e==null?e:sd.call(e)}function py(e,i,a){var u=e==null?0:e.length;return u?(a&&typeof a!="number"&&Zt(e,i,a)?(i=0,a=u):(i=i==null?0:ye(i),a=a===r?u:ye(a)),xr(e,i,a)):[]}function dy(e,i){return Zs(e,i)}function gy(e,i,a){return La(e,i,ie(a,2))}function yy(e,i){var a=e==null?0:e.length;if(a){var u=Zs(e,i);if(u<a&&Dr(e[u],i))return u}return-1}function vy(e,i){return Zs(e,i,!0)}function my(e,i,a){return La(e,i,ie(a,2),!0)}function wy(e,i){var a=e==null?0:e.length;if(a){var u=Zs(e,i,!0)-1;if(Dr(e[u],i))return u}return-1}function _y(e){return e&&e.length?Ku(e):[]}function by(e,i){return e&&e.length?Ku(e,ie(i,2)):[]}function Ey(e){var i=e==null?0:e.length;return i?xr(e,1,i):[]}function Iy(e,i,a){return e&&e.length?(i=a||i===r?1:ye(i),xr(e,0,i<0?0:i)):[]}function xy(e,i,a){var u=e==null?0:e.length;return u?(i=a||i===r?1:ye(i),i=u-i,xr(e,i<0?0:i,u)):[]}function Py(e,i){return e&&e.length?Xs(e,ie(i,3),!1,!0):[]}function Sy(e,i){return e&&e.length?Xs(e,ie(i,3)):[]}var Oy=_e(function(e){return mi(kt(e,1,mt,!0))}),Ry=_e(function(e){var i=Pr(e);return mt(i)&&(i=r),mi(kt(e,1,mt,!0),ie(i,2))}),Ay=_e(function(e){var i=Pr(e);return i=typeof i=="function"?i:r,mi(kt(e,1,mt,!0),r,i)});function Ty(e){return e&&e.length?mi(e):[]}function Cy(e,i){return e&&e.length?mi(e,ie(i,2)):[]}function $y(e,i){return i=typeof i=="function"?i:r,e&&e.length?mi(e,r,i):[]}function Xa(e){if(!(e&&e.length))return[];var i=0;return e=pi(e,function(a){if(mt(a))return i=Nt(a.length,i),!0}),ya(i,function(a){return Ze(e,pa(a))})}function Ah(e,i){if(!(e&&e.length))return[];var a=Xa(e);return i==null?a:Ze(a,function(u){return Lt(i,r,u)})}var Ny=_e(function(e,i){return mt(e)?jn(e,i):[]}),Dy=_e(function(e){return qa(pi(e,mt))}),Ly=_e(function(e){var i=Pr(e);return mt(i)&&(i=r),qa(pi(e,mt),ie(i,2))}),jy=_e(function(e){var i=Pr(e);return i=typeof i=="function"?i:r,qa(pi(e,mt),r,i)}),qy=_e(Xa);function My(e,i){return Gu(e||[],i||[],Ln)}function zy(e,i){return Gu(e||[],i||[],zn)}var Uy=_e(function(e){var i=e.length,a=i>1?e[i-1]:r;return a=typeof a=="function"?(e.pop(),a):r,Ah(e,a)});function Th(e){var i=d(e);return i.__chain__=!0,i}function Hy(e,i){return i(e),e}function co(e,i){return i(e)}var ky=ei(function(e){var i=e.length,a=i?e[0]:0,u=this.__wrapped__,f=function(y){return xa(y,e)};return i>1||this.__actions__.length||!(u instanceof xe)||!ti(a)?this.thru(f):(u=u.slice(a,+a+(i?1:0)),u.__actions__.push({func:co,args:[f],thisArg:r}),new Er(u,this.__chain__).thru(function(y){return i&&!y.length&&y.push(r),y}))});function Ky(){return Th(this)}function By(){return new Er(this.value(),this.__chain__)}function Fy(){this.__values__===r&&(this.__values__=Bh(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function Vy(){return this}function Gy(e){for(var i,a=this;a instanceof Gs;){var u=Ih(a);u.__index__=0,u.__values__=r,i?f.__wrapped__=u:i=u;var f=u;a=a.__wrapped__}return f.__wrapped__=e,i}function Wy(){var e=this.__wrapped__;if(e instanceof xe){var i=e;return this.__actions__.length&&(i=new xe(this)),i=i.reverse(),i.__actions__.push({func:co,args:[Za],thisArg:r}),new Er(i,this.__chain__)}return this.thru(Za)}function Jy(){return Vu(this.__wrapped__,this.__actions__)}var Qy=eo(function(e,i,a){De.call(e,a)?++e[a]:Zr(e,a,1)});function Yy(e,i,a){var u=ge(e)?su:Hd;return a&&Zt(e,i,a)&&(i=r),u(e,ie(i,3))}function Zy(e,i){var a=ge(e)?pi:Au;return a(e,ie(i,3))}var Xy=ih(xh),ev=ih(Ph);function tv(e,i){return kt(uo(e,i),1)}function rv(e,i){return kt(uo(e,i),le)}function iv(e,i,a){return a=a===r?1:ye(a),kt(uo(e,i),a)}function Ch(e,i){var a=ge(e)?_r:vi;return a(e,ie(i,3))}function $h(e,i){var a=ge(e)?Ep:Ru;return a(e,ie(i,3))}var nv=eo(function(e,i,a){De.call(e,a)?e[a].push(i):Zr(e,a,[i])});function sv(e,i,a,u){e=ir(e)?e:gn(e),a=a&&!u?ye(a):0;var f=e.length;return a<0&&(a=Nt(f+a,0)),go(e)?a<=f&&e.indexOf(i,a)>-1:!!f&&rn(e,i,a)>-1}var ov=_e(function(e,i,a){var u=-1,f=typeof i=="function",y=ir(e)?$(e.length):[];return vi(e,function(_){y[++u]=f?Lt(i,_,a):qn(_,i,a)}),y}),av=eo(function(e,i,a){Zr(e,a,i)});function uo(e,i){var a=ge(e)?Ze:Lu;return a(e,ie(i,3))}function cv(e,i,a,u){return e==null?[]:(ge(i)||(i=i==null?[]:[i]),a=u?r:a,ge(a)||(a=a==null?[]:[a]),zu(e,i,a))}var uv=eo(function(e,i,a){e[a?0:1].push(i)},function(){return[[],[]]});function hv(e,i,a){var u=ge(e)?la:uu,f=arguments.length<3;return u(e,ie(i,4),a,f,vi)}function lv(e,i,a){var u=ge(e)?Ip:uu,f=arguments.length<3;return u(e,ie(i,4),a,f,Ru)}function fv(e,i){var a=ge(e)?pi:Au;return a(e,fo(ie(i,3)))}function pv(e){var i=ge(e)?xu:sg;return i(e)}function dv(e,i,a){(a?Zt(e,i,a):i===r)?i=1:i=ye(i);var u=ge(e)?jd:og;return u(e,i)}function gv(e){var i=ge(e)?qd:cg;return i(e)}function yv(e){if(e==null)return 0;if(ir(e))return go(e)?sn(e):e.length;var i=Ft(e);return i==me||i==Ce?e.size:Ta(e).length}function vv(e,i,a){var u=ge(e)?fa:ug;return a&&Zt(e,i,a)&&(i=r),u(e,ie(i,3))}var mv=_e(function(e,i){if(e==null)return[];var a=i.length;return a>1&&Zt(e,i[0],i[1])?i=[]:a>2&&Zt(i[0],i[1],i[2])&&(i=[i[0]]),zu(e,kt(i,1),[])}),ho=Zp||function(){return Pe.Date.now()};function wv(e,i){if(typeof i!="function")throw new br(l);return e=ye(e),function(){if(--e<1)return i.apply(this,arguments)}}function Nh(e,i,a){return i=a?r:i,i=e&&i==null?e.length:i,Xr(e,Y,r,r,r,r,i)}function Dh(e,i){var a;if(typeof i!="function")throw new br(l);return e=ye(e),function(){return--e>0&&(a=i.apply(this,arguments)),e<=1&&(i=r),a}}var ec=_e(function(e,i,a){var u=ee;if(a.length){var f=gi(a,pn(ec));u|=he}return Xr(e,u,i,a,f)}),Lh=_e(function(e,i,a){var u=ee|ce;if(a.length){var f=gi(a,pn(Lh));u|=he}return Xr(i,u,e,a,f)});function jh(e,i,a){i=a?r:i;var u=Xr(e,oe,r,r,r,r,r,i);return u.placeholder=jh.placeholder,u}function qh(e,i,a){i=a?r:i;var u=Xr(e,te,r,r,r,r,r,i);return u.placeholder=qh.placeholder,u}function Mh(e,i,a){var u,f,y,_,E,R,q=0,M=!1,U=!1,F=!0;if(typeof e!="function")throw new br(l);i=Sr(i)||0,nt(a)&&(M=!!a.leading,U="maxWait"in a,y=U?Nt(Sr(a.maxWait)||0,i):y,F="trailing"in a?!!a.trailing:F);function X(wt){var Lr=u,ni=f;return u=f=r,q=wt,_=e.apply(ni,Lr),_}function ne(wt){return q=wt,E=kn(be,i),M?X(wt):_}function we(wt){var Lr=wt-R,ni=wt-q,il=i-Lr;return U?Bt(il,y-ni):il}function se(wt){var Lr=wt-R,ni=wt-q;return R===r||Lr>=i||Lr<0||U&&ni>=y}function be(){var wt=ho();if(se(wt))return Se(wt);E=kn(be,we(wt))}function Se(wt){return E=r,F&&u?X(wt):(u=f=r,_)}function yr(){E!==r&&Wu(E),q=0,u=R=f=E=r}function Xt(){return E===r?_:Se(ho())}function vr(){var wt=ho(),Lr=se(wt);if(u=arguments,f=this,R=wt,Lr){if(E===r)return ne(R);if(U)return Wu(E),E=kn(be,i),X(R)}return E===r&&(E=kn(be,i)),_}return vr.cancel=yr,vr.flush=Xt,vr}var _v=_e(function(e,i){return Ou(e,1,i)}),bv=_e(function(e,i,a){return Ou(e,Sr(i)||0,a)});function Ev(e){return Xr(e,_t)}function lo(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new br(l);var a=function(){var u=arguments,f=i?i.apply(this,u):u[0],y=a.cache;if(y.has(f))return y.get(f);var _=e.apply(this,u);return a.cache=y.set(f,_)||y,_};return a.cache=new(lo.Cache||Yr),a}lo.Cache=Yr;function fo(e){if(typeof e!="function")throw new br(l);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function Iv(e){return Dh(2,e)}var xv=hg(function(e,i){i=i.length==1&&ge(i[0])?Ze(i[0],pr(ie())):Ze(kt(i,1),pr(ie()));var a=i.length;return _e(function(u){for(var f=-1,y=Bt(u.length,a);++f<y;)u[f]=i[f].call(this,u[f]);return Lt(e,this,u)})}),tc=_e(function(e,i){var a=gi(i,pn(tc));return Xr(e,he,r,i,a)}),zh=_e(function(e,i){var a=gi(i,pn(zh));return Xr(e,pe,r,i,a)}),Pv=ei(function(e,i){return Xr(e,ve,r,r,r,i)});function Sv(e,i){if(typeof e!="function")throw new br(l);return i=i===r?i:ye(i),_e(e,i)}function Ov(e,i){if(typeof e!="function")throw new br(l);return i=i==null?0:Nt(ye(i),0),_e(function(a){var u=a[i],f=_i(a,0,i);return u&&di(f,u),Lt(e,this,f)})}function Rv(e,i,a){var u=!0,f=!0;if(typeof e!="function")throw new br(l);return nt(a)&&(u="leading"in a?!!a.leading:u,f="trailing"in a?!!a.trailing:f),Mh(e,i,{leading:u,maxWait:i,trailing:f})}function Av(e){return Nh(e,1)}function Tv(e,i){return tc(za(i),e)}function Cv(){if(!arguments.length)return[];var e=arguments[0];return ge(e)?e:[e]}function $v(e){return Ir(e,D)}function Nv(e,i){return i=typeof i=="function"?i:r,Ir(e,D,i)}function Dv(e){return Ir(e,x|D)}function Lv(e,i){return i=typeof i=="function"?i:r,Ir(e,x|D,i)}function jv(e,i){return i==null||Su(e,i,jt(i))}function Dr(e,i){return e===i||e!==e&&i!==i}var qv=no(Oa),Mv=no(function(e,i){return e>=i}),ki=$u(function(){return arguments}())?$u:function(e){return dt(e)&&De.call(e,"callee")&&!mu.call(e,"callee")},ge=$.isArray,zv=Qt?pr(Qt):Gd;function ir(e){return e!=null&&po(e.length)&&!ri(e)}function mt(e){return dt(e)&&ir(e)}function Uv(e){return e===!0||e===!1||dt(e)&&Yt(e)==N}var bi=ed||fc,Hv=Cr?pr(Cr):Wd;function kv(e){return dt(e)&&e.nodeType===1&&!Kn(e)}function Kv(e){if(e==null)return!0;if(ir(e)&&(ge(e)||typeof e=="string"||typeof e.splice=="function"||bi(e)||dn(e)||ki(e)))return!e.length;var i=Ft(e);if(i==me||i==Ce)return!e.size;if(Hn(e))return!Ta(e).length;for(var a in e)if(De.call(e,a))return!1;return!0}function Bv(e,i){return Mn(e,i)}function Fv(e,i,a){a=typeof a=="function"?a:r;var u=a?a(e,i):r;return u===r?Mn(e,i,r,a):!!u}function rc(e){if(!dt(e))return!1;var i=Yt(e);return i==I||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!Kn(e)}function Vv(e){return typeof e=="number"&&_u(e)}function ri(e){if(!nt(e))return!1;var i=Yt(e);return i==Z||i==ue||i==L||i==gt}function Uh(e){return typeof e=="number"&&e==ye(e)}function po(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=k}function nt(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function dt(e){return e!=null&&typeof e=="object"}var Hh=wr?pr(wr):Qd;function Gv(e,i){return e===i||Aa(e,i,Va(i))}function Wv(e,i,a){return a=typeof a=="function"?a:r,Aa(e,i,Va(i),a)}function Jv(e){return kh(e)&&e!=+e}function Qv(e){if(Ng(e))throw new fe(c);return Nu(e)}function Yv(e){return e===null}function Zv(e){return e==null}function kh(e){return typeof e=="number"||dt(e)&&Yt(e)==Oe}function Kn(e){if(!dt(e)||Yt(e)!=Ie)return!1;var i=Us(e);if(i===null)return!0;var a=De.call(i,"constructor")&&i.constructor;return typeof a=="function"&&a instanceof a&&js.call(a)==Wp}var ic=Hr?pr(Hr):Yd;function Xv(e){return Uh(e)&&e>=-k&&e<=k}var Kh=Rn?pr(Rn):Zd;function go(e){return typeof e=="string"||!ge(e)&&dt(e)&&Yt(e)==Fe}function gr(e){return typeof e=="symbol"||dt(e)&&Yt(e)==Ve}var dn=Di?pr(Di):Xd;function em(e){return e===r}function tm(e){return dt(e)&&Ft(e)==Le}function rm(e){return dt(e)&&Yt(e)==Ge}var im=no(Ca),nm=no(function(e,i){return e<=i});function Bh(e){if(!e)return[];if(ir(e))return go(e)?$r(e):rr(e);if(Tn&&e[Tn])return jp(e[Tn]());var i=Ft(e),a=i==me?ma:i==Ce?Ns:gn;return a(e)}function ii(e){if(!e)return e===0?e:0;if(e=Sr(e),e===le||e===-le){var i=e<0?-1:1;return i*H}return e===e?e:0}function ye(e){var i=ii(e),a=i%1;return i===i?a?i-a:i:0}function Fh(e){return e?Mi(ye(e),0,B):0}function Sr(e){if(typeof e=="number")return e;if(gr(e))return K;if(nt(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=nt(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=hu(e);var a=Go.test(e);return a||Jo.test(e)?de(e.slice(2),a?2:8):Vo.test(e)?K:+e}function Vh(e){return Kr(e,nr(e))}function sm(e){return e?Mi(ye(e),-k,k):e===0?e:0}function $e(e){return e==null?"":dr(e)}var om=ln(function(e,i){if(Hn(i)||ir(i)){Kr(i,jt(i),e);return}for(var a in i)De.call(i,a)&&Ln(e,a,i[a])}),Gh=ln(function(e,i){Kr(i,nr(i),e)}),yo=ln(function(e,i,a,u){Kr(i,nr(i),e,u)}),am=ln(function(e,i,a,u){Kr(i,jt(i),e,u)}),cm=ei(xa);function um(e,i){var a=hn(e);return i==null?a:Pu(a,i)}var hm=_e(function(e,i){e=ke(e);var a=-1,u=i.length,f=u>2?i[2]:r;for(f&&Zt(i[0],i[1],f)&&(u=1);++a<u;)for(var y=i[a],_=nr(y),E=-1,R=_.length;++E<R;){var q=_[E],M=e[q];(M===r||Dr(M,an[q])&&!De.call(e,q))&&(e[q]=y[q])}return e}),lm=_e(function(e){return e.push(r,hh),Lt(Wh,r,e)});function fm(e,i){return ou(e,ie(i,3),kr)}function pm(e,i){return ou(e,ie(i,3),Sa)}function dm(e,i){return e==null?e:Pa(e,ie(i,3),nr)}function gm(e,i){return e==null?e:Tu(e,ie(i,3),nr)}function ym(e,i){return e&&kr(e,ie(i,3))}function vm(e,i){return e&&Sa(e,ie(i,3))}function mm(e){return e==null?[]:Qs(e,jt(e))}function wm(e){return e==null?[]:Qs(e,nr(e))}function nc(e,i,a){var u=e==null?r:zi(e,i);return u===r?a:u}function _m(e,i){return e!=null&&ph(e,i,Kd)}function sc(e,i){return e!=null&&ph(e,i,Bd)}var bm=sh(function(e,i,a){i!=null&&typeof i.toString!="function"&&(i=qs.call(i)),e[i]=a},ac(sr)),Em=sh(function(e,i,a){i!=null&&typeof i.toString!="function"&&(i=qs.call(i)),De.call(e,i)?e[i].push(a):e[i]=[a]},ie),Im=_e(qn);function jt(e){return ir(e)?Iu(e):Ta(e)}function nr(e){return ir(e)?Iu(e,!0):eg(e)}function xm(e,i){var a={};return i=ie(i,3),kr(e,function(u,f,y){Zr(a,i(u,f,y),u)}),a}function Pm(e,i){var a={};return i=ie(i,3),kr(e,function(u,f,y){Zr(a,f,i(u,f,y))}),a}var Sm=ln(function(e,i,a){Ys(e,i,a)}),Wh=ln(function(e,i,a,u){Ys(e,i,a,u)}),Om=ei(function(e,i){var a={};if(e==null)return a;var u=!1;i=Ze(i,function(y){return y=wi(y,e),u||(u=y.length>1),y}),Kr(e,Ba(e),a),u&&(a=Ir(a,x|T|D,bg));for(var f=i.length;f--;)ja(a,i[f]);return a});function Rm(e,i){return Jh(e,fo(ie(i)))}var Am=ei(function(e,i){return e==null?{}:rg(e,i)});function Jh(e,i){if(e==null)return{};var a=Ze(Ba(e),function(u){return[u]});return i=ie(i),Uu(e,a,function(u,f){return i(u,f[0])})}function Tm(e,i,a){i=wi(i,e);var u=-1,f=i.length;for(f||(f=1,e=r);++u<f;){var y=e==null?r:e[Br(i[u])];y===r&&(u=f,y=a),e=ri(y)?y.call(e):y}return e}function Cm(e,i,a){return e==null?e:zn(e,i,a)}function $m(e,i,a,u){return u=typeof u=="function"?u:r,e==null?e:zn(e,i,a,u)}var Qh=ch(jt),Yh=ch(nr);function Nm(e,i,a){var u=ge(e),f=u||bi(e)||dn(e);if(i=ie(i,4),a==null){var y=e&&e.constructor;f?a=u?new y:[]:nt(e)?a=ri(y)?hn(Us(e)):{}:a={}}return(f?_r:kr)(e,function(_,E,R){return i(a,_,E,R)}),a}function Dm(e,i){return e==null?!0:ja(e,i)}function Lm(e,i,a){return e==null?e:Fu(e,i,za(a))}function jm(e,i,a,u){return u=typeof u=="function"?u:r,e==null?e:Fu(e,i,za(a),u)}function gn(e){return e==null?[]:va(e,jt(e))}function qm(e){return e==null?[]:va(e,nr(e))}function Mm(e,i,a){return a===r&&(a=i,i=r),a!==r&&(a=Sr(a),a=a===a?a:0),i!==r&&(i=Sr(i),i=i===i?i:0),Mi(Sr(e),i,a)}function zm(e,i,a){return i=ii(i),a===r?(a=i,i=0):a=ii(a),e=Sr(e),Fd(e,i,a)}function Um(e,i,a){if(a&&typeof a!="boolean"&&Zt(e,i,a)&&(i=a=r),a===r&&(typeof i=="boolean"?(a=i,i=r):typeof e=="boolean"&&(a=e,e=r)),e===r&&i===r?(e=0,i=1):(e=ii(e),i===r?(i=e,e=0):i=ii(i)),e>i){var u=e;e=i,i=u}if(a||e%1||i%1){var f=bu();return Bt(e+f*(i-e+Ue("1e-"+((f+"").length-1))),i)}return Na(e,i)}var Hm=fn(function(e,i,a){return i=i.toLowerCase(),e+(a?Zh(i):i)});function Zh(e){return oc($e(e).toLowerCase())}function Xh(e){return e=$e(e),e&&e.replace(Wr,Cp).replace(ca,"")}function km(e,i,a){e=$e(e),i=dr(i);var u=e.length;a=a===r?u:Mi(ye(a),0,u);var f=a;return a-=i.length,a>=0&&e.slice(a,f)==i}function Km(e){return e=$e(e),e&&Qe.test(e)?e.replace(Ai,$p):e}function Bm(e){return e=$e(e),e&&Pt.test(e)?e.replace(lt,"\\$&"):e}var Fm=fn(function(e,i,a){return e+(a?"-":"")+i.toLowerCase()}),Vm=fn(function(e,i,a){return e+(a?" ":"")+i.toLowerCase()}),Gm=rh("toLowerCase");function Wm(e,i,a){e=$e(e),i=ye(i);var u=i?sn(e):0;if(!i||u>=i)return e;var f=(i-u)/2;return io(Bs(f),a)+e+io(Ks(f),a)}function Jm(e,i,a){e=$e(e),i=ye(i);var u=i?sn(e):0;return i&&u<i?e+io(i-u,a):e}function Qm(e,i,a){e=$e(e),i=ye(i);var u=i?sn(e):0;return i&&u<i?io(i-u,a)+e:e}function Ym(e,i,a){return a||i==null?i=0:i&&(i=+i),nd($e(e).replace(ft,""),i||0)}function Zm(e,i,a){return(a?Zt(e,i,a):i===r)?i=1:i=ye(i),Da($e(e),i)}function Xm(){var e=arguments,i=$e(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var e0=fn(function(e,i,a){return e+(a?"_":"")+i.toLowerCase()});function t0(e,i,a){return a&&typeof a!="number"&&Zt(e,i,a)&&(i=a=r),a=a===r?B:a>>>0,a?(e=$e(e),e&&(typeof i=="string"||i!=null&&!ic(i))&&(i=dr(i),!i&&nn(e))?_i($r(e),0,a):e.split(i,a)):[]}var r0=fn(function(e,i,a){return e+(a?" ":"")+oc(i)});function i0(e,i,a){return e=$e(e),a=a==null?0:Mi(ye(a),0,e.length),i=dr(i),e.slice(a,a+i.length)==i}function n0(e,i,a){var u=d.templateSettings;a&&Zt(e,i,a)&&(i=r),e=$e(e),i=yo({},i,u,uh);var f=yo({},i.imports,u.imports,uh),y=jt(f),_=va(f,y),E,R,q=0,M=i.interpolate||Ji,U="__p += '",F=wa((i.escape||Ji).source+"|"+M.source+"|"+(M===it?Fo:Ji).source+"|"+(i.evaluate||Ji).source+"|$","g"),X="//# sourceURL="+(De.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ua+"]")+`
`;e.replace(F,function(se,be,Se,yr,Xt,vr){return Se||(Se=yr),U+=e.slice(q,vr).replace(Yo,Np),be&&(E=!0,U+=`' +
__e(`+be+`) +
'`),Xt&&(R=!0,U+=`';
`+Xt+`;
__p += '`),Se&&(U+=`' +
((__t = (`+Se+`)) == null ? '' : __t) +
'`),q=vr+se.length,se}),U+=`';
`;var ne=De.call(i,"variable")&&i.variable;if(!ne)U=`with (obj) {
`+U+`
}
`;else if(Ko.test(ne))throw new fe(g);U=(R?U.replace(zr,""):U).replace(Jt,"$1").replace(Gr,"$1;"),U="function("+(ne||"obj")+`) {
`+(ne?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(E?", __e = _.escape":"")+(R?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+U+`return __p
}`;var we=tl(function(){return Te(y,X+"return "+U).apply(r,_)});if(we.source=U,rc(we))throw we;return we}function s0(e){return $e(e).toLowerCase()}function o0(e){return $e(e).toUpperCase()}function a0(e,i,a){if(e=$e(e),e&&(a||i===r))return hu(e);if(!e||!(i=dr(i)))return e;var u=$r(e),f=$r(i),y=lu(u,f),_=fu(u,f)+1;return _i(u,y,_).join("")}function c0(e,i,a){if(e=$e(e),e&&(a||i===r))return e.slice(0,du(e)+1);if(!e||!(i=dr(i)))return e;var u=$r(e),f=fu(u,$r(i))+1;return _i(u,0,f).join("")}function u0(e,i,a){if(e=$e(e),e&&(a||i===r))return e.replace(ft,"");if(!e||!(i=dr(i)))return e;var u=$r(e),f=lu(u,$r(i));return _i(u,f).join("")}function h0(e,i){var a=st,u=Be;if(nt(i)){var f="separator"in i?i.separator:f;a="length"in i?ye(i.length):a,u="omission"in i?dr(i.omission):u}e=$e(e);var y=e.length;if(nn(e)){var _=$r(e);y=_.length}if(a>=y)return e;var E=a-sn(u);if(E<1)return u;var R=_?_i(_,0,E).join(""):e.slice(0,E);if(f===r)return R+u;if(_&&(E+=R.length-E),ic(f)){if(e.slice(E).search(f)){var q,M=R;for(f.global||(f=wa(f.source,$e(mr.exec(f))+"g")),f.lastIndex=0;q=f.exec(M);)var U=q.index;R=R.slice(0,U===r?E:U)}}else if(e.indexOf(dr(f),E)!=E){var F=R.lastIndexOf(f);F>-1&&(R=R.slice(0,F))}return R+u}function l0(e){return e=$e(e),e&&ct.test(e)?e.replace(li,Up):e}var f0=fn(function(e,i,a){return e+(a?" ":"")+i.toUpperCase()}),oc=rh("toUpperCase");function el(e,i,a){return e=$e(e),i=a?r:i,i===r?Lp(e)?Kp(e):Sp(e):e.match(i)||[]}var tl=_e(function(e,i){try{return Lt(e,r,i)}catch(a){return rc(a)?a:new fe(a)}}),p0=ei(function(e,i){return _r(i,function(a){a=Br(a),Zr(e,a,ec(e[a],e))}),e});function d0(e){var i=e==null?0:e.length,a=ie();return e=i?Ze(e,function(u){if(typeof u[1]!="function")throw new br(l);return[a(u[0]),u[1]]}):[],_e(function(u){for(var f=-1;++f<i;){var y=e[f];if(Lt(y[0],this,u))return Lt(y[1],this,u)}})}function g0(e){return Ud(Ir(e,x))}function ac(e){return function(){return e}}function y0(e,i){return e==null||e!==e?i:e}var v0=nh(),m0=nh(!0);function sr(e){return e}function cc(e){return Du(typeof e=="function"?e:Ir(e,x))}function w0(e){return ju(Ir(e,x))}function _0(e,i){return qu(e,Ir(i,x))}var b0=_e(function(e,i){return function(a){return qn(a,e,i)}}),E0=_e(function(e,i){return function(a){return qn(e,a,i)}});function uc(e,i,a){var u=jt(i),f=Qs(i,u);a==null&&!(nt(i)&&(f.length||!u.length))&&(a=i,i=e,e=this,f=Qs(i,jt(i)));var y=!(nt(a)&&"chain"in a)||!!a.chain,_=ri(e);return _r(f,function(E){var R=i[E];e[E]=R,_&&(e.prototype[E]=function(){var q=this.__chain__;if(y||q){var M=e(this.__wrapped__),U=M.__actions__=rr(this.__actions__);return U.push({func:R,args:arguments,thisArg:e}),M.__chain__=q,M}return R.apply(e,di([this.value()],arguments))})}),e}function I0(){return Pe._===this&&(Pe._=Jp),this}function hc(){}function x0(e){return e=ye(e),_e(function(i){return Mu(i,e)})}var P0=Ha(Ze),S0=Ha(su),O0=Ha(fa);function rl(e){return Wa(e)?pa(Br(e)):ig(e)}function R0(e){return function(i){return e==null?r:zi(e,i)}}var A0=oh(),T0=oh(!0);function lc(){return[]}function fc(){return!1}function C0(){return{}}function $0(){return""}function N0(){return!0}function D0(e,i){if(e=ye(e),e<1||e>k)return[];var a=B,u=Bt(e,B);i=ie(i),e-=B;for(var f=ya(u,i);++a<e;)i(a);return f}function L0(e){return ge(e)?Ze(e,Br):gr(e)?[e]:rr(Eh($e(e)))}function j0(e){var i=++Gp;return $e(e)+i}var q0=ro(function(e,i){return e+i},0),M0=ka("ceil"),z0=ro(function(e,i){return e/i},1),U0=ka("floor");function H0(e){return e&&e.length?Js(e,sr,Oa):r}function k0(e,i){return e&&e.length?Js(e,ie(i,2),Oa):r}function K0(e){return cu(e,sr)}function B0(e,i){return cu(e,ie(i,2))}function F0(e){return e&&e.length?Js(e,sr,Ca):r}function V0(e,i){return e&&e.length?Js(e,ie(i,2),Ca):r}var G0=ro(function(e,i){return e*i},1),W0=ka("round"),J0=ro(function(e,i){return e-i},0);function Q0(e){return e&&e.length?ga(e,sr):0}function Y0(e,i){return e&&e.length?ga(e,ie(i,2)):0}return d.after=wv,d.ary=Nh,d.assign=om,d.assignIn=Gh,d.assignInWith=yo,d.assignWith=am,d.at=cm,d.before=Dh,d.bind=ec,d.bindAll=p0,d.bindKey=Lh,d.castArray=Cv,d.chain=Th,d.chunk=Ug,d.compact=Hg,d.concat=kg,d.cond=d0,d.conforms=g0,d.constant=ac,d.countBy=Qy,d.create=um,d.curry=jh,d.curryRight=qh,d.debounce=Mh,d.defaults=hm,d.defaultsDeep=lm,d.defer=_v,d.delay=bv,d.difference=Kg,d.differenceBy=Bg,d.differenceWith=Fg,d.drop=Vg,d.dropRight=Gg,d.dropRightWhile=Wg,d.dropWhile=Jg,d.fill=Qg,d.filter=Zy,d.flatMap=tv,d.flatMapDeep=rv,d.flatMapDepth=iv,d.flatten=Sh,d.flattenDeep=Yg,d.flattenDepth=Zg,d.flip=Ev,d.flow=v0,d.flowRight=m0,d.fromPairs=Xg,d.functions=mm,d.functionsIn=wm,d.groupBy=nv,d.initial=ty,d.intersection=ry,d.intersectionBy=iy,d.intersectionWith=ny,d.invert=bm,d.invertBy=Em,d.invokeMap=ov,d.iteratee=cc,d.keyBy=av,d.keys=jt,d.keysIn=nr,d.map=uo,d.mapKeys=xm,d.mapValues=Pm,d.matches=w0,d.matchesProperty=_0,d.memoize=lo,d.merge=Sm,d.mergeWith=Wh,d.method=b0,d.methodOf=E0,d.mixin=uc,d.negate=fo,d.nthArg=x0,d.omit=Om,d.omitBy=Rm,d.once=Iv,d.orderBy=cv,d.over=P0,d.overArgs=xv,d.overEvery=S0,d.overSome=O0,d.partial=tc,d.partialRight=zh,d.partition=uv,d.pick=Am,d.pickBy=Jh,d.property=rl,d.propertyOf=R0,d.pull=cy,d.pullAll=Rh,d.pullAllBy=uy,d.pullAllWith=hy,d.pullAt=ly,d.range=A0,d.rangeRight=T0,d.rearg=Pv,d.reject=fv,d.remove=fy,d.rest=Sv,d.reverse=Za,d.sampleSize=dv,d.set=Cm,d.setWith=$m,d.shuffle=gv,d.slice=py,d.sortBy=mv,d.sortedUniq=_y,d.sortedUniqBy=by,d.split=t0,d.spread=Ov,d.tail=Ey,d.take=Iy,d.takeRight=xy,d.takeRightWhile=Py,d.takeWhile=Sy,d.tap=Hy,d.throttle=Rv,d.thru=co,d.toArray=Bh,d.toPairs=Qh,d.toPairsIn=Yh,d.toPath=L0,d.toPlainObject=Vh,d.transform=Nm,d.unary=Av,d.union=Oy,d.unionBy=Ry,d.unionWith=Ay,d.uniq=Ty,d.uniqBy=Cy,d.uniqWith=$y,d.unset=Dm,d.unzip=Xa,d.unzipWith=Ah,d.update=Lm,d.updateWith=jm,d.values=gn,d.valuesIn=qm,d.without=Ny,d.words=el,d.wrap=Tv,d.xor=Dy,d.xorBy=Ly,d.xorWith=jy,d.zip=qy,d.zipObject=My,d.zipObjectDeep=zy,d.zipWith=Uy,d.entries=Qh,d.entriesIn=Yh,d.extend=Gh,d.extendWith=yo,uc(d,d),d.add=q0,d.attempt=tl,d.camelCase=Hm,d.capitalize=Zh,d.ceil=M0,d.clamp=Mm,d.clone=$v,d.cloneDeep=Dv,d.cloneDeepWith=Lv,d.cloneWith=Nv,d.conformsTo=jv,d.deburr=Xh,d.defaultTo=y0,d.divide=z0,d.endsWith=km,d.eq=Dr,d.escape=Km,d.escapeRegExp=Bm,d.every=Yy,d.find=Xy,d.findIndex=xh,d.findKey=fm,d.findLast=ev,d.findLastIndex=Ph,d.findLastKey=pm,d.floor=U0,d.forEach=Ch,d.forEachRight=$h,d.forIn=dm,d.forInRight=gm,d.forOwn=ym,d.forOwnRight=vm,d.get=nc,d.gt=qv,d.gte=Mv,d.has=_m,d.hasIn=sc,d.head=Oh,d.identity=sr,d.includes=sv,d.indexOf=ey,d.inRange=zm,d.invoke=Im,d.isArguments=ki,d.isArray=ge,d.isArrayBuffer=zv,d.isArrayLike=ir,d.isArrayLikeObject=mt,d.isBoolean=Uv,d.isBuffer=bi,d.isDate=Hv,d.isElement=kv,d.isEmpty=Kv,d.isEqual=Bv,d.isEqualWith=Fv,d.isError=rc,d.isFinite=Vv,d.isFunction=ri,d.isInteger=Uh,d.isLength=po,d.isMap=Hh,d.isMatch=Gv,d.isMatchWith=Wv,d.isNaN=Jv,d.isNative=Qv,d.isNil=Zv,d.isNull=Yv,d.isNumber=kh,d.isObject=nt,d.isObjectLike=dt,d.isPlainObject=Kn,d.isRegExp=ic,d.isSafeInteger=Xv,d.isSet=Kh,d.isString=go,d.isSymbol=gr,d.isTypedArray=dn,d.isUndefined=em,d.isWeakMap=tm,d.isWeakSet=rm,d.join=sy,d.kebabCase=Fm,d.last=Pr,d.lastIndexOf=oy,d.lowerCase=Vm,d.lowerFirst=Gm,d.lt=im,d.lte=nm,d.max=H0,d.maxBy=k0,d.mean=K0,d.meanBy=B0,d.min=F0,d.minBy=V0,d.stubArray=lc,d.stubFalse=fc,d.stubObject=C0,d.stubString=$0,d.stubTrue=N0,d.multiply=G0,d.nth=ay,d.noConflict=I0,d.noop=hc,d.now=ho,d.pad=Wm,d.padEnd=Jm,d.padStart=Qm,d.parseInt=Ym,d.random=Um,d.reduce=hv,d.reduceRight=lv,d.repeat=Zm,d.replace=Xm,d.result=Tm,d.round=W0,d.runInContext=S,d.sample=pv,d.size=yv,d.snakeCase=e0,d.some=vv,d.sortedIndex=dy,d.sortedIndexBy=gy,d.sortedIndexOf=yy,d.sortedLastIndex=vy,d.sortedLastIndexBy=my,d.sortedLastIndexOf=wy,d.startCase=r0,d.startsWith=i0,d.subtract=J0,d.sum=Q0,d.sumBy=Y0,d.template=n0,d.times=D0,d.toFinite=ii,d.toInteger=ye,d.toLength=Fh,d.toLower=s0,d.toNumber=Sr,d.toSafeInteger=sm,d.toString=$e,d.toUpper=o0,d.trim=a0,d.trimEnd=c0,d.trimStart=u0,d.truncate=h0,d.unescape=l0,d.uniqueId=j0,d.upperCase=f0,d.upperFirst=oc,d.each=Ch,d.eachRight=$h,d.first=Oh,uc(d,function(){var e={};return kr(d,function(i,a){De.call(d.prototype,a)||(e[a]=i)}),e}(),{chain:!1}),d.VERSION=n,_r(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){d[e].placeholder=d}),_r(["drop","take"],function(e,i){xe.prototype[e]=function(a){a=a===r?1:Nt(ye(a),0);var u=this.__filtered__&&!i?new xe(this):this.clone();return u.__filtered__?u.__takeCount__=Bt(a,u.__takeCount__):u.__views__.push({size:Bt(a,B),type:e+(u.__dir__<0?"Right":"")}),u},xe.prototype[e+"Right"]=function(a){return this.reverse()[e](a).reverse()}}),_r(["filter","map","takeWhile"],function(e,i){var a=i+1,u=a==b||a==Q;xe.prototype[e]=function(f){var y=this.clone();return y.__iteratees__.push({iteratee:ie(f,3),type:a}),y.__filtered__=y.__filtered__||u,y}}),_r(["head","last"],function(e,i){var a="take"+(i?"Right":"");xe.prototype[e]=function(){return this[a](1).value()[0]}}),_r(["initial","tail"],function(e,i){var a="drop"+(i?"":"Right");xe.prototype[e]=function(){return this.__filtered__?new xe(this):this[a](1)}}),xe.prototype.compact=function(){return this.filter(sr)},xe.prototype.find=function(e){return this.filter(e).head()},xe.prototype.findLast=function(e){return this.reverse().find(e)},xe.prototype.invokeMap=_e(function(e,i){return typeof e=="function"?new xe(this):this.map(function(a){return qn(a,e,i)})}),xe.prototype.reject=function(e){return this.filter(fo(ie(e)))},xe.prototype.slice=function(e,i){e=ye(e);var a=this;return a.__filtered__&&(e>0||i<0)?new xe(a):(e<0?a=a.takeRight(-e):e&&(a=a.drop(e)),i!==r&&(i=ye(i),a=i<0?a.dropRight(-i):a.take(i-e)),a)},xe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},xe.prototype.toArray=function(){return this.take(B)},kr(xe.prototype,function(e,i){var a=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),f=d[u?"take"+(i=="last"?"Right":""):i],y=u||/^find/.test(i);f&&(d.prototype[i]=function(){var _=this.__wrapped__,E=u?[1]:arguments,R=_ instanceof xe,q=E[0],M=R||ge(_),U=function(be){var Se=f.apply(d,di([be],E));return u&&F?Se[0]:Se};M&&a&&typeof q=="function"&&q.length!=1&&(R=M=!1);var F=this.__chain__,X=!!this.__actions__.length,ne=y&&!F,we=R&&!X;if(!y&&M){_=we?_:new xe(this);var se=e.apply(_,E);return se.__actions__.push({func:co,args:[U],thisArg:r}),new Er(se,F)}return ne&&we?e.apply(this,E):(se=this.thru(U),ne?u?se.value()[0]:se.value():se)})}),_r(["pop","push","shift","sort","splice","unshift"],function(e){var i=Ds[e],a=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);d.prototype[e]=function(){var f=arguments;if(u&&!this.__chain__){var y=this.value();return i.apply(ge(y)?y:[],f)}return this[a](function(_){return i.apply(ge(_)?_:[],f)})}}),kr(xe.prototype,function(e,i){var a=d[i];if(a){var u=a.name+"";De.call(un,u)||(un[u]=[]),un[u].push({name:i,func:a})}}),un[to(r,ce).name]=[{name:"wrapper",func:r}],xe.prototype.clone=ld,xe.prototype.reverse=fd,xe.prototype.value=pd,d.prototype.at=ky,d.prototype.chain=Ky,d.prototype.commit=By,d.prototype.next=Fy,d.prototype.plant=Gy,d.prototype.reverse=Wy,d.prototype.toJSON=d.prototype.valueOf=d.prototype.value=Jy,d.prototype.first=d.prototype.head,Tn&&(d.prototype[Tn]=Vy),d},on=Bp();vt?((vt.exports=on)._=on,He._=on):Pe._=on}).call(Qn)})(Kc,Kc.exports);var Mx=Object.defineProperty,zx=Object.defineProperties,Ux=Object.getOwnPropertyDescriptors,lf=Object.getOwnPropertySymbols,Hx=Object.prototype.hasOwnProperty,kx=Object.prototype.propertyIsEnumerable,ff=(o,t,r)=>t in o?Mx(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,Eo=(o,t)=>{for(var r in t||(t={}))Hx.call(t,r)&&ff(o,r,t[r]);if(lf)for(var r of lf(t))kx.call(t,r)&&ff(o,r,t[r]);return o},Kx=(o,t)=>zx(o,Ux(t));function Pi(o,t,r){var n;const s=qw(o);return((n=t.rpcMap)==null?void 0:n[s.reference])||`${qx}?chainId=${s.namespace}:${s.reference}&projectId=${r}`}function Wi(o){return o.includes(":")?o.split(":")[1]:o}function wp(o){return o.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function Bx(o,t){const r=Object.keys(t.namespaces).filter(s=>s.includes(o));if(!r.length)return[];const n=[];return r.forEach(s=>{const c=t.namespaces[s].accounts;n.push(...c)}),n}function Fx(o={},t={}){const r=pf(o),n=pf(t);return Kc.exports.merge(r,n)}function pf(o){var t,r,n,s;const c={};if(!Po(o))return c;for(const[l,g]of Object.entries(o)){const v=Sf(l)?[l]:g.chains,p=g.methods||[],w=g.events||[],x=g.rpcMap||{},T=Yn(l);c[T]=Kx(Eo(Eo({},c[T]),g),{chains:dc(v,(t=c[T])==null?void 0:t.chains),methods:dc(p,(r=c[T])==null?void 0:r.methods),events:dc(w,(n=c[T])==null?void 0:n.events),rpcMap:Eo(Eo({},x),(s=c[T])==null?void 0:s.rpcMap)})}return c}function Vx(o){return o.includes(":")?o.split(":")[2]:o}function Gx(o){const t={};for(const[r,n]of Object.entries(o)){const s=n.methods||[],c=n.events||[],l=n.accounts||[],g=Sf(r)?[r]:n.chains?n.chains:wp(n.accounts);t[r]={chains:g,methods:s,events:c,accounts:l}}return t}function Pc(o){return typeof o=="number"?o:o.includes("0x")?parseInt(o,16):o.includes(":")?Number(o.split(":")[1]):Number(o)}const _p={},Xe=o=>_p[o],Sc=(o,t)=>{_p[o]=t};class Wx{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Xe("events"),this.client=Xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const s=Wi(r);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Pi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Oi(new Si(n,Xe("disableProviderPing")))}}class Jx{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Xe("events"),this.client=Xe("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const n=r||Pi(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Oi(new Si(n,Xe("disableProviderPing")))}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const s=parseInt(Wi(r));t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,n;let s=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const c=parseInt(s,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:s}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class Qx{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Xe("events"),this.client=Xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const s=Wi(r);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Pi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Oi(new Si(n,Xe("disableProviderPing")))}}class Yx{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Xe("events"),this.client=Xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const s=Wi(r);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Pi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Oi(new Si(n,Xe("disableProviderPing")))}}class Zx{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Xe("events"),this.client=Xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r),s=Wi(r);t[s]=this.createHttpProvider(s,n)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||this.getCardanoRPCUrl(t);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Oi(new Si(n,Xe("disableProviderPing")))}}class Xx{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Xe("events"),this.client=Xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const s=Wi(r);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Pi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Oi(new Si(n,Xe("disableProviderPing")))}}class eP{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Xe("events"),this.client=Xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const s=Wi(r);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Pi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Oi(new Si(n,Xe("disableProviderPing")))}}class tP{constructor(t){this.name="near",this.namespace=t.namespace,this.events=Xe("events"),this.client=Xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const n=r||Pi(`${this.name}:${t}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;t[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Pi(t,this.namespace);return typeof n>"u"?void 0:new Oi(new Si(n,Xe("disableProviderPing")))}}var rP=Object.defineProperty,iP=Object.defineProperties,nP=Object.getOwnPropertyDescriptors,df=Object.getOwnPropertySymbols,sP=Object.prototype.hasOwnProperty,oP=Object.prototype.propertyIsEnumerable,gf=(o,t,r)=>t in o?rP(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,Io=(o,t)=>{for(var r in t||(t={}))sP.call(t,r)&&gf(o,r,t[r]);if(df)for(var r of df(t))oP.call(t,r)&&gf(o,r,t[r]);return o},Oc=(o,t)=>iP(o,nP(t));class iu{constructor(t){this.events=new Wc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:qo(Mo({level:(t==null?void 0:t.logger)||uf})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new iu(t);return await r.initialize(),r}async request(t,r){const[n,s]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:Io({},t),chainId:`${n}:${s}`,topic:this.session.topic})}sendAsync(t,r,n){const s=new Date().getTime();this.request(t,n).then(c=>r(null,zo(s,c))).catch(c=>r(c,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Vt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:s}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await s().then(c=>{this.session=c,this.namespaces||(this.namespaces=Gx(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==vp)throw c;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[n,s]=this.validateChain(t);this.getProvider(n).setDefaultChain(s,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(In(r)){for(const n of r)t.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Px.init({logger:this.providerOpts.logger||uf,relayUrl:this.providerOpts.relayUrl||Dx,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>Yn(r)))];Sc("client",this.client),Sc("events",this.events),Sc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const n=Bx(r,this.session),s=wp(n),c=Fx(this.namespaces,this.optionalNamespaces),l=Oc(Io({},c[r]),{accounts:n,chains:s});switch(r){case"eip155":this.rpcProviders[r]=new Jx({namespace:l});break;case"solana":this.rpcProviders[r]=new Qx({namespace:l});break;case"cosmos":this.rpcProviders[r]=new Yx({namespace:l});break;case"polkadot":this.rpcProviders[r]=new Wx({namespace:l});break;case"cip34":this.rpcProviders[r]=new Zx({namespace:l});break;case"elrond":this.rpcProviders[r]=new Xx({namespace:l});break;case"multiversx":this.rpcProviders[r]=new eP({namespace:l});break;case"near":this.rpcProviders[r]=new tP({namespace:l});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:n}=r;if(n.name==="accountsChanged"){const s=n.data;s&&In(s)&&this.events.emit("accountsChanged",s.map(Vx))}else if(n.name==="chainChanged"){const s=r.chainId,c=r.event.data,l=Yn(s),g=Pc(s)!==Pc(c)?`${l}:${Pc(c)}`:s;this.onChainChanged(g)}else this.events.emit(n.name,n.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var n;const{namespaces:s}=r,c=(n=this.client)==null?void 0:n.session.get(t);this.session=Oc(Io({},c),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Oc(Io({},Vt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(hi.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:n,sessionProperties:s}=t;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=s,this.persist("namespaces",r),this.persist("optionalNamespaces",n)}validateChain(t){const[r,n]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(l=>Yn(l)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const s=Yn(Object.keys(this.namespaces)[0]),c=this.rpcProviders[s].getDefaultChain();return[s,c]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var n;if(!this.namespaces)return;const[s,c]=this.validateChain(t);r||this.getProvider(s).setDefaultChain(c),((n=this.namespaces[s])!=null?n:this.namespaces[`${s}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${hf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${hf}/${t}`)}}const aP=iu,cP="wc",uP="ethereum_provider",hP=`${cP}@2:${uP}:`,lP="https://rpc.walletconnect.com/v1/",Bc=["eth_sendTransaction","personal_sign"],fP=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Fc=["chainChanged","accountsChanged"],pP=["chainChanged","accountsChanged","message","disconnect","connect"];var dP=Object.defineProperty,gP=Object.defineProperties,yP=Object.getOwnPropertyDescriptors,yf=Object.getOwnPropertySymbols,vP=Object.prototype.hasOwnProperty,mP=Object.prototype.propertyIsEnumerable,vf=(o,t,r)=>t in o?dP(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,Xn=(o,t)=>{for(var r in t||(t={}))vP.call(t,r)&&vf(o,r,t[r]);if(yf)for(var r of yf(t))mP.call(t,r)&&vf(o,r,t[r]);return o},mf=(o,t)=>gP(o,yP(t));function Co(o){return Number(o[0].split(":")[1])}function Rc(o){return`0x${o.toString(16)}`}function wP(o){const{chains:t,optionalChains:r,methods:n,optionalMethods:s,events:c,optionalEvents:l,rpcMap:g}=o;if(!In(t))throw new Error("Invalid chains");const v={chains:t,methods:n||Bc,events:c||Fc,rpcMap:Xn({},t.length?{[Co(t)]:g[Co(t)]}:{})},p=c==null?void 0:c.filter(D=>!Fc.includes(D)),w=n==null?void 0:n.filter(D=>!Bc.includes(D));if(!r&&!l&&!s&&!(p!=null&&p.length)&&!(w!=null&&w.length))return{required:t.length?v:void 0};const x=(p==null?void 0:p.length)&&(w==null?void 0:w.length)||!r,T={chains:[...new Set(x?v.chains.concat(r||[]):r)],methods:[...new Set(v.methods.concat(s!=null&&s.length?s:fP))],events:[...new Set(v.events.concat(l!=null&&l.length?l:pP))],rpcMap:g};return{required:t.length?v:void 0,optional:r.length?T:void 0}}class nu{constructor(){this.events=new ur.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=hP,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new nu;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:n}=wP(this.rpc);try{const s=await new Promise(async(l,g)=>{var v;this.rpc.showQrModal&&((v=this.modal)==null||v.subscribeModal(p=>{!p.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),g(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(mf(Xn({namespaces:Xn({},r&&{[this.namespace]:r})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(p=>{l(p)}).catch(p=>{g(new Error(p.message))})});if(!s)return;const c=Mw(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:Rc(this.chainId)})}catch(s){throw this.signer.logger.error(s),s}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:n}=r;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",Rc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",mf(Xn({},Vt("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,n;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(n=this.modal)==null||n.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Rc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,n,s]=t.split(":");return{chainId:`${r}:${n}`,address:s}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,n;const s=(r=t==null?void 0:t.chains)!=null?r:[],c=(n=t==null?void 0:t.optionalChains)!=null?n:[],l=s.concat(c);if(!l.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const g=s.length?(t==null?void 0:t.methods)||Bc:[],v=s.length?(t==null?void 0:t.events)||Fc:[],p=(t==null?void 0:t.optionalMethods)||[],w=(t==null?void 0:t.optionalEvents)||[],x=(t==null?void 0:t.rpcMap)||this.buildRpcMap(l,t.projectId),T=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:s==null?void 0:s.map(D=>this.formatChainId(D)),optionalChains:c.map(D=>this.formatChainId(D)),methods:g,events:v,optionalMethods:p,optionalEvents:w,rpcMap:x,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:T,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const n={};return t.forEach(s=>{n[s]=this.getRpcUrl(s,r)}),n}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Co(this.rpc.chains):Co(this.rpc.optionalChains),this.signer=await aP.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:n}=await zw(()=>import("./index.BHQ8Mwq8.js").then(s=>s.i),__vite__mapDeps([0,1,2]));r=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Xn({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:n,rpcMap:s}=t;r&&In(r)&&(this.rpc.chains=r.map(c=>this.formatChainId(c)),r.forEach(c=>{this.rpc.rpcMap[c]=(s==null?void 0:s[c])||this.getRpcUrl(c)})),n&&In(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(c=>this.formatChainId(c)),n.forEach(c=>{this.rpc.rpcMap[c]=(s==null?void 0:s[c])||this.getRpcUrl(c)}))}getRpcUrl(t,r){var n;return((n=this.rpc.rpcMap)==null?void 0:n[t])||`${lP}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const MP=nu;export{MP as EthereumProvider,pP as OPTIONAL_EVENTS,fP as OPTIONAL_METHODS,Fc as REQUIRED_EVENTS,Bc as REQUIRED_METHODS,nu as default};
//# sourceMappingURL=index.es.BhRM_Kz1.js.map
